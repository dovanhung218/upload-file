{"ast":null,"code":"//\n// officegen: basic Microsoft Office common code\n//\n// Please refer to README.md for this module's documentations.\n//\n// Copyright (c) 2013 Ziv Barber;\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n//\n\n/**\n * Basicgen common utilities used by any document type related to Microsoft Office.\n */\n\nvar baseobj = require('./basicgen.js');\nfunction encodeHTML(inStr) {\n  return inStr.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n}\n\n/**\n * This method extending the given officegen object with the common code needed by any MS-Office based document.\n * Use this module for every type of MS-Office document.\n *\n * @example <caption>Using this module for implementing a new MS-Office based document type:</caption>\n * var baseobj = require ( \"officegen\" )\n * var msdoc = require ( \"./lib/msofficegen.js\" )\n *\n * function makeMyDoc ( officegenObj, typeCodeName, options, officegenObjPlugins, typeInfo ) {\n *   msdoc.makemsdoc ( officegenObj, typeCodeName, options, officegenObjPlugins, typeInfo )\n *   officegenObjPlugins.plugs.type.msoffice.makeOfficeGenerator ( 'word', 'document', {} )\n *\n *   officegenObj.on ( 'clearData', function () {\n *   })\n * }\n * @param {object} genobj The object to extend.\n * @param {object} new_type The type of object to create.\n * @param {object} options The object's options.\n * @param {object} gen_private Access to the internals of this object.\n * @param {object} type_info Additional information about this type.\n * @summary Extend officegen object with MS-Office support.\n * @constructor\n * @name makemsdoc\n */\nfunction makemsdoc(genobj, new_type, options, gen_private, type_info) {\n  /**\n   * Generate string of the current date and time.\n   *\n   * This method generating a string with the current date and time in Office XML format.\n   *\n   * @return String of the current date and time in Office XML format.\n   */\n  function getCurDateTimeForOffice() {\n    var date = new Date();\n    var year = date.getFullYear();\n    var month = date.getMonth() + 1;\n    var day = date.getDate();\n    var hour = date.getHours();\n    var min = date.getMinutes();\n    var sec = date.getSeconds();\n    month = (month < 10 ? '0' : '') + month;\n    day = (day < 10 ? '0' : '') + day;\n    hour = (hour < 10 ? '0' : '') + hour;\n    min = (min < 10 ? '0' : '') + min;\n    sec = (sec < 10 ? '0' : '') + sec;\n    return year + '-' + month + '-' + day + 'T' + hour + ':' + min + ':' + sec + 'Z';\n  }\n\n  /**\n   * Compact the given array.\n   *\n   * This function compacting the given array.\n   *\n   * @param {object} arr The array to compact.\n   */\n  function compactArray(arr) {\n    var len = arr.length;\n    for (var i = 0; i < len; i++) {\n      if (arr[i]) {\n        arr.push(arr[i]);\n      } // Endif.\n    } // End of for loop.\n\n    arr.splice(0, len); // Cut the array and leave only the non-empty values.\n  }\n\n  /**\n   * Create the main files list resource.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakeMainFilesList(data) {\n    var outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data);\n    outString += '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">';\n    for (var i = 0, total_size = gen_private.type.msoffice.files_list.length; i < total_size; i++) {\n      if (typeof gen_private.type.msoffice.files_list[i] !== 'undefined') {\n        if (gen_private.type.msoffice.files_list[i].ext) {\n          // Fixed by @author:vtloc @date:2014Jan09\n          // Reason: if we write out duplicate extension, office will raise error\n          //\n          if (outString.indexOf('<Default Extension=\"' + gen_private.type.msoffice.files_list[i].ext) === -1) {\n            // check to make sure we don't write duplicate extension tag\n            outString += '<Default Extension=\"' + gen_private.type.msoffice.files_list[i].ext + '\" ContentType=\"' + gen_private.type.msoffice.files_list[i].type + '\"/>';\n          }\n        } else {\n          outString += '<Override PartName=\"' + gen_private.type.msoffice.files_list[i].name + '\" ContentType=\"' + gen_private.type.msoffice.files_list[i].type + '\"/>';\n        } // Endif.\n      } // Endif.\n    } // End of for loop.\n\n    outString += '</Types>\\n';\n    return outString;\n  }\n\n  /**\n   * Create the theme to use with this document.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakeTheme(data) {\n    if (genobj.theme) {\n      // console.log ( genobj.theme )\n      return genobj.theme;\n    } // Endif.\n\n    return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"MS P????\"/><a:font script=\"Hang\" typeface=\"?? ??\"/><a:font script=\"Hans\" typeface=\"??\"/><a:font script=\"Hant\" typeface=\"????\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Angsana New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"MS P????\"/><a:font script=\"Hang\" typeface=\"?? ??\"/><a:font script=\"Hans\" typeface=\"??\"/><a:font script=\"Hant\" typeface=\"????\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Cordia New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:shade val=\"51000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"80000\"><a:schemeClr val=\"phClr\"><a:shade val=\"93000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"94000\"/><a:satMod val=\"135000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>';\n  }\n\n  /**\n   * Generate the coreProperties for the document.\n   *\n   * This method creating the docProps/core.xml resource inside any MS based document. Each type of document generator is adding the\n   * supported document properties using calls to gen_private.plugs.type.msoffice.addInfoType().\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakeCore(data) {\n    var curDateTime = getCurDateTimeForOffice();\n    var userName = genobj.options.author || genobj.options.creator || 'officegen';\n    var extraFields = '';\n\n    // Work on all the properties:\n    for (var infoRec in genobj.info) {\n      if (genobj.info[infoRec] && genobj.info[infoRec].element && genobj.info[infoRec].data) {\n        extraFields += '<' + genobj.info[infoRec].element + '>' + encodeHTML(genobj.info[infoRec].data) + '</' + genobj.info[infoRec].element + '>';\n      } // Endif.\n    } // End of for loop.\n\n    return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">' + extraFields + '<dc:creator>' + userName + '</dc:creator><cp:lastModifiedBy>' + userName + '</cp:lastModifiedBy><cp:revision>1</cp:revision><dcterms:created xsi:type=\"dcterms:W3CDTF\">' + curDateTime + '</dcterms:created><dcterms:modified xsi:type=\"dcterms:W3CDTF\">' + curDateTime + '</dcterms:modified></cp:coreProperties>';\n  }\n\n  /**\n   * Remove selected records from the given array.\n   *\n   * This method destroys records inside the given array of the given type.\n   *\n   * @param {object} arr The array to work on it.\n   * @param {object} type_to_clear The type of records to clear.\n   */\n  function clearSmartArrayFromType(arr, type_to_clear) {\n    var is_need_compact = false;\n    for (var i = 0, total_size = arr.length; i < total_size; i++) {\n      if (typeof arr[i] !== 'undefined') {\n        if (arr[i].clear && arr[i].clear === type_to_clear) {\n          delete arr[i];\n          is_need_compact = true;\n        } // Endif.\n      } // Endif.\n    } // End of for loop.\n\n    if (is_need_compact) {\n      compactArray(arr);\n    } // Endif.\n  }\n\n  /**\n   * Clean after finishing to generate the document.\n   *\n   * This method destroying any additional resources added by the 'beforeGen' effect to the generator.\n   *\n   * @param {object} err Generation error message (if there were any).\n   * @param {object} written Number of bytes been created.\n   */\n  function cbOfficeClearAfterGenerate(err, written) {\n    if (err) {\n      // BMK_TODO:\n    } // Endif.\n\n    clearSmartArrayFromType(gen_private.type.msoffice.rels_main, 'generate');\n    clearSmartArrayFromType(gen_private.type.msoffice.rels_app, 'generate');\n    clearSmartArrayFromType(gen_private.type.msoffice.files_list, 'generate');\n    if (genobj.generate_data) {\n      genobj.generate_data = null;\n      delete genobj.generate_data;\n    } // Endif.\n  }\n\n  /**\n   * Clear all the information of the current document.\n   */\n  function cbOfficeClearDocData() {\n    clearSmartArrayFromType(gen_private.type.msoffice.rels_main, 'data');\n    clearSmartArrayFromType(gen_private.type.msoffice.rels_app, 'data');\n    clearSmartArrayFromType(gen_private.type.msoffice.files_list, 'data');\n    for (var infoItem in genobj.info) {\n      genobj.info[infoItem].data = genobj.info[infoItem].def_data;\n    } // Endif.\n\n    gen_private.type.msoffice.src_files_list = [];\n\n    // Ask the document implementation to clear it's data:\n    genobj.emit('clearDocType', gen_private);\n  }\n\n  // Basic API for plugins:\n\n  gen_private.plugs.type.msoffice = {};\n\n  /**\n   * Configure a new Office property type.\n   *\n   * This method register a new type of property that the user can configure. This property must be\n   * a valid MS-Office property as you can configure on the \"files/properties\" menu option on MS-Office.\n   *\n   * @param {object} element_name The name of the XML element of this type.\n   * @param {object} def_data Default value of this type.\n   * @param {object} prop_name The name of the options property to configure this type.\n   * @param {object} user_access_func_name The name of the function to create to configure this type.\n   */\n  gen_private.plugs.type.msoffice.addInfoType = function (element_name, def_data, prop_name, user_access_func_name) {\n    genobj.info[element_name] = {};\n    genobj.info[element_name].element = element_name;\n    genobj.info[element_name].data = def_data;\n    genobj.info[element_name].def_data = def_data;\n\n    // The user of officegen can configure this property using the options object:\n    if (genobj.options[prop_name]) {\n      genobj.info[element_name].data = genobj.options[prop_name];\n    } // Endif.\n\n    genobj[user_access_func_name] = function (new_data) {\n      genobj.info[element_name].data = new_data;\n    };\n  };\n\n  /**\n   * Get the string that opening every Office XML type.\n   *\n   * Every Microsoft Office XML resource will have this header at the begining of the file.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml = function (data) {\n    return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n';\n  };\n\n  /**\n   * Generate rel based XML file.\n   *\n   * @param {object} data Array filled with all the rels links.\n   * @return Text string.\n   */\n  gen_private.plugs.type.msoffice.cbMakeRels = function (data) {\n    var outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data);\n    outString += '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">';\n\n    // Add all the rels records inside the data array:\n    var realRel = 1;\n    for (var i = 0, total_size = data.length; i < total_size; i++) {\n      if (typeof data[i] !== 'undefined') {\n        outString += '<Relationship Id=\"rId' + realRel + '\" Type=\"' + data[i].type + '\" Target=\"' + data[i].target + '\"';\n        if (data[i].targetMode) {\n          outString += ' TargetMode=\"' + data[i].targetMode + '\"';\n        } // Endif.\n\n        outString += '/>';\n        realRel++;\n      } // Endif.\n    } // End of for loop.\n\n    outString += '</Relationships>\\n';\n    return outString;\n  };\n\n  /**\n   * Prepare the officegen object to MS-Office documents.\n   *\n   * Every plugin that implementing gemenrating MS-Office document must call this method to initialize\n   * the common stuff.\n   *\n   * @param {object} main_path The name of the main folder holding the common resources of this type.\n   * @param {object} main_file The main resource file name of this type.\n   * @param {object} ext_opt Optional settings (unused right now).\n   */\n  gen_private.plugs.type.msoffice.makeOfficeGenerator = function (main_path, main_file, ext_opt) {\n    gen_private.features.type.msoffice = {};\n    gen_private.features.type.msoffice.main_path = main_path;\n    gen_private.features.type.msoffice.main_path_file = main_file;\n    gen_private.type.msoffice = {};\n    gen_private.type.msoffice.rels_main = [];\n    gen_private.type.msoffice.rels_app = [];\n    gen_private.type.msoffice.files_list = [];\n    gen_private.type.msoffice.src_files_list = [];\n\n    // Holding all the Office properties:\n    genobj.info = {};\n    genobj.on('afterGen', cbOfficeClearAfterGenerate);\n    genobj.on('clearDoc', cbOfficeClearDocData);\n    gen_private.type.msoffice.rels_main.push({\n      target: 'docProps/app.xml',\n      type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties',\n      clear: 'type'\n    }, {\n      target: 'docProps/core.xml',\n      type: 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties',\n      clear: 'type'\n    }, {\n      target: gen_private.features.type.msoffice.main_path + '/' + gen_private.features.type.msoffice.main_path_file + '.xml',\n      type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument',\n      clear: 'type'\n    });\n    gen_private.type.msoffice.files_list.push({\n      ext: 'rels',\n      type: 'application/vnd.openxmlformats-package.relationships+xml',\n      clear: 'type'\n    }, {\n      ext: 'xml',\n      type: 'application/xml',\n      clear: 'type'\n    }, {\n      ext: 'jpeg',\n      type: 'image/jpeg',\n      clear: 'type'\n    }, {\n      ext: 'png',\n      type: 'image/png',\n      clear: 'type'\n    }, {\n      ext: 'gif',\n      type: 'image/gif',\n      clear: 'type'\n    }, {\n      name: '/docProps/app.xml',\n      type: 'application/vnd.openxmlformats-officedocument.extended-properties+xml',\n      clear: 'type'\n    }, {\n      name: '/' + gen_private.features.type.msoffice.main_path + '/theme/theme1.xml',\n      type: 'application/vnd.openxmlformats-officedocument.theme+xml',\n      clear: 'type'\n    }, {\n      name: '/docProps/core.xml',\n      type: 'application/vnd.openxmlformats-package.core-properties+xml',\n      clear: 'type'\n    });\n    genobj.theme = genobj.options.themeXml || null;\n    genobj.setTheme = function (xmlData) {\n      genobj.theme = xmlData;\n      // BMK_TODO: BMK_TODO: In the future I'll add a parser to the .thmx files.\n    };\n\n    gen_private.plugs.intAddAnyResourceToParse('_rels\\\\.rels', 'buffer', gen_private.type.msoffice.rels_main, gen_private.plugs.type.msoffice.cbMakeRels, true);\n    gen_private.plugs.intAddAnyResourceToParse('[Content_Types].xml', 'buffer', null, cbMakeMainFilesList, true);\n    gen_private.plugs.intAddAnyResourceToParse('docProps\\\\core.xml', 'buffer', null, cbMakeCore, true);\n    gen_private.plugs.intAddAnyResourceToParse(gen_private.features.type.msoffice.main_path + '\\\\theme\\\\theme1.xml', 'buffer', null, cbMakeTheme, true);\n  };\n\n  /**\n   * Generate random unique ID.\n   *\n   * This method generates a random unique ID.\n   *\n   * @param {object} baseGroup Optional first part of the ID.\n   * @return Unique ID string.\n   */\n  gen_private.plugs.type.msoffice.makeUniqueID = function (baseGroup) {\n    var charTable = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];\n    function makeRandomChar() {\n      return charTable[Math.floor(Math.random() * charTable.length)];\n    }\n    var outStr = baseGroup || makeRandomChar() + makeRandomChar() + makeRandomChar() + makeRandomChar() + makeRandomChar() + makeRandomChar() + makeRandomChar() + makeRandomChar();\n    outStr += '-' + makeRandomChar() + makeRandomChar() + makeRandomChar() + makeRandomChar();\n    outStr += '-' + makeRandomChar() + makeRandomChar() + makeRandomChar() + makeRandomChar();\n    outStr += '-' + makeRandomChar() + makeRandomChar() + makeRandomChar() + makeRandomChar();\n    outStr += '-' + makeRandomChar() + makeRandomChar() + makeRandomChar() + makeRandomChar();\n    outStr += makeRandomChar() + makeRandomChar() + makeRandomChar() + makeRandomChar();\n    outStr += makeRandomChar() + makeRandomChar() + makeRandomChar() + makeRandomChar();\n    return outStr;\n  };\n  return this;\n}\nbaseobj.plugins.registerPrototype('msoffice', makemsdoc, 'Microsoft Office Document Prototype');\nexports.makemsdoc = makemsdoc;","map":{"version":3,"names":["baseobj","require","encodeHTML","inStr","replace","makemsdoc","genobj","new_type","options","gen_private","type_info","getCurDateTimeForOffice","date","Date","year","getFullYear","month","getMonth","day","getDate","hour","getHours","min","getMinutes","sec","getSeconds","compactArray","arr","len","length","i","push","splice","cbMakeMainFilesList","data","outString","plugs","type","msoffice","cbMakeMsOfficeBasicXml","total_size","files_list","ext","indexOf","name","cbMakeTheme","theme","cbMakeCore","curDateTime","userName","author","creator","extraFields","infoRec","info","element","clearSmartArrayFromType","type_to_clear","is_need_compact","clear","cbOfficeClearAfterGenerate","err","written","rels_main","rels_app","generate_data","cbOfficeClearDocData","infoItem","def_data","src_files_list","emit","addInfoType","element_name","prop_name","user_access_func_name","new_data","cbMakeRels","realRel","target","targetMode","makeOfficeGenerator","main_path","main_file","ext_opt","features","main_path_file","on","themeXml","setTheme","xmlData","intAddAnyResourceToParse","makeUniqueID","baseGroup","charTable","makeRandomChar","Math","floor","random","outStr","plugins","registerPrototype","exports"],"sources":["/Users/abc/Downloads/Workspace/c2i/image-text/c2i-convert/node_modules/officegen/lib/msofficegen.js"],"sourcesContent":["//\n// officegen: basic Microsoft Office common code\n//\n// Please refer to README.md for this module's documentations.\n//\n// Copyright (c) 2013 Ziv Barber;\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n//\n\n/**\n * Basicgen common utilities used by any document type related to Microsoft Office.\n */\n\nvar baseobj = require('./basicgen.js')\n\nfunction encodeHTML(inStr) {\n  return inStr\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n}\n\n/**\n * This method extending the given officegen object with the common code needed by any MS-Office based document.\n * Use this module for every type of MS-Office document.\n *\n * @example <caption>Using this module for implementing a new MS-Office based document type:</caption>\n * var baseobj = require ( \"officegen\" )\n * var msdoc = require ( \"./lib/msofficegen.js\" )\n *\n * function makeMyDoc ( officegenObj, typeCodeName, options, officegenObjPlugins, typeInfo ) {\n *   msdoc.makemsdoc ( officegenObj, typeCodeName, options, officegenObjPlugins, typeInfo )\n *   officegenObjPlugins.plugs.type.msoffice.makeOfficeGenerator ( 'word', 'document', {} )\n *\n *   officegenObj.on ( 'clearData', function () {\n *   })\n * }\n * @param {object} genobj The object to extend.\n * @param {object} new_type The type of object to create.\n * @param {object} options The object's options.\n * @param {object} gen_private Access to the internals of this object.\n * @param {object} type_info Additional information about this type.\n * @summary Extend officegen object with MS-Office support.\n * @constructor\n * @name makemsdoc\n */\nfunction makemsdoc(genobj, new_type, options, gen_private, type_info) {\n  /**\n   * Generate string of the current date and time.\n   *\n   * This method generating a string with the current date and time in Office XML format.\n   *\n   * @return String of the current date and time in Office XML format.\n   */\n  function getCurDateTimeForOffice() {\n    var date = new Date()\n\n    var year = date.getFullYear()\n    var month = date.getMonth() + 1\n    var day = date.getDate()\n    var hour = date.getHours()\n    var min = date.getMinutes()\n    var sec = date.getSeconds()\n\n    month = (month < 10 ? '0' : '') + month\n    day = (day < 10 ? '0' : '') + day\n    hour = (hour < 10 ? '0' : '') + hour\n    min = (min < 10 ? '0' : '') + min\n    sec = (sec < 10 ? '0' : '') + sec\n\n    return (\n      year + '-' + month + '-' + day + 'T' + hour + ':' + min + ':' + sec + 'Z'\n    )\n  }\n\n  /**\n   * Compact the given array.\n   *\n   * This function compacting the given array.\n   *\n   * @param {object} arr The array to compact.\n   */\n  function compactArray(arr) {\n    var len = arr.length\n\n    for (var i = 0; i < len; i++) {\n      if (arr[i]) {\n        arr.push(arr[i])\n      } // Endif.\n    } // End of for loop.\n\n    arr.splice(0, len) // Cut the array and leave only the non-empty values.\n  }\n\n  /**\n   * Create the main files list resource.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakeMainFilesList(data) {\n    var outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data)\n    outString +=\n      '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">'\n\n    for (\n      var i = 0, total_size = gen_private.type.msoffice.files_list.length;\n      i < total_size;\n      i++\n    ) {\n      if (typeof gen_private.type.msoffice.files_list[i] !== 'undefined') {\n        if (gen_private.type.msoffice.files_list[i].ext) {\n          // Fixed by @author:vtloc @date:2014Jan09\n          // Reason: if we write out duplicate extension, office will raise error\n          //\n          if (\n            outString.indexOf(\n              '<Default Extension=\"' +\n                gen_private.type.msoffice.files_list[i].ext\n            ) === -1\n          ) {\n            // check to make sure we don't write duplicate extension tag\n            outString +=\n              '<Default Extension=\"' +\n              gen_private.type.msoffice.files_list[i].ext +\n              '\" ContentType=\"' +\n              gen_private.type.msoffice.files_list[i].type +\n              '\"/>'\n          }\n        } else {\n          outString +=\n            '<Override PartName=\"' +\n            gen_private.type.msoffice.files_list[i].name +\n            '\" ContentType=\"' +\n            gen_private.type.msoffice.files_list[i].type +\n            '\"/>'\n        } // Endif.\n      } // Endif.\n    } // End of for loop.\n\n    outString += '</Types>\\n'\n    return outString\n  }\n\n  /**\n   * Create the theme to use with this document.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakeTheme(data) {\n    if (genobj.theme) {\n      // console.log ( genobj.theme )\n      return genobj.theme\n    } // Endif.\n\n    return (\n      gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) +\n      '<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"MS P????\"/><a:font script=\"Hang\" typeface=\"?? ??\"/><a:font script=\"Hans\" typeface=\"??\"/><a:font script=\"Hant\" typeface=\"????\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Angsana New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"MS P????\"/><a:font script=\"Hang\" typeface=\"?? ??\"/><a:font script=\"Hans\" typeface=\"??\"/><a:font script=\"Hant\" typeface=\"????\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Cordia New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:shade val=\"51000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"80000\"><a:schemeClr val=\"phClr\"><a:shade val=\"93000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"94000\"/><a:satMod val=\"135000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>'\n    )\n  }\n\n  /**\n   * Generate the coreProperties for the document.\n   *\n   * This method creating the docProps/core.xml resource inside any MS based document. Each type of document generator is adding the\n   * supported document properties using calls to gen_private.plugs.type.msoffice.addInfoType().\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakeCore(data) {\n    var curDateTime = getCurDateTimeForOffice()\n    var userName =\n      genobj.options.author || genobj.options.creator || 'officegen'\n    var extraFields = ''\n\n    // Work on all the properties:\n    for (var infoRec in genobj.info) {\n      if (\n        genobj.info[infoRec] &&\n        genobj.info[infoRec].element &&\n        genobj.info[infoRec].data\n      ) {\n        extraFields +=\n          '<' +\n          genobj.info[infoRec].element +\n          '>' +\n          encodeHTML(genobj.info[infoRec].data) +\n          '</' +\n          genobj.info[infoRec].element +\n          '>'\n      } // Endif.\n    } // End of for loop.\n\n    return (\n      gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) +\n      '<cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">' +\n      extraFields +\n      '<dc:creator>' +\n      userName +\n      '</dc:creator><cp:lastModifiedBy>' +\n      userName +\n      '</cp:lastModifiedBy><cp:revision>1</cp:revision><dcterms:created xsi:type=\"dcterms:W3CDTF\">' +\n      curDateTime +\n      '</dcterms:created><dcterms:modified xsi:type=\"dcterms:W3CDTF\">' +\n      curDateTime +\n      '</dcterms:modified></cp:coreProperties>'\n    )\n  }\n\n  /**\n   * Remove selected records from the given array.\n   *\n   * This method destroys records inside the given array of the given type.\n   *\n   * @param {object} arr The array to work on it.\n   * @param {object} type_to_clear The type of records to clear.\n   */\n  function clearSmartArrayFromType(arr, type_to_clear) {\n    var is_need_compact = false\n\n    for (var i = 0, total_size = arr.length; i < total_size; i++) {\n      if (typeof arr[i] !== 'undefined') {\n        if (arr[i].clear && arr[i].clear === type_to_clear) {\n          delete arr[i]\n          is_need_compact = true\n        } // Endif.\n      } // Endif.\n    } // End of for loop.\n\n    if (is_need_compact) {\n      compactArray(arr)\n    } // Endif.\n  }\n\n  /**\n   * Clean after finishing to generate the document.\n   *\n   * This method destroying any additional resources added by the 'beforeGen' effect to the generator.\n   *\n   * @param {object} err Generation error message (if there were any).\n   * @param {object} written Number of bytes been created.\n   */\n  function cbOfficeClearAfterGenerate(err, written) {\n    if (err) {\n      // BMK_TODO:\n    } // Endif.\n\n    clearSmartArrayFromType(gen_private.type.msoffice.rels_main, 'generate')\n    clearSmartArrayFromType(gen_private.type.msoffice.rels_app, 'generate')\n    clearSmartArrayFromType(gen_private.type.msoffice.files_list, 'generate')\n\n    if (genobj.generate_data) {\n      genobj.generate_data = null\n      delete genobj.generate_data\n    } // Endif.\n  }\n\n  /**\n   * Clear all the information of the current document.\n   */\n  function cbOfficeClearDocData() {\n    clearSmartArrayFromType(gen_private.type.msoffice.rels_main, 'data')\n    clearSmartArrayFromType(gen_private.type.msoffice.rels_app, 'data')\n    clearSmartArrayFromType(gen_private.type.msoffice.files_list, 'data')\n\n    for (var infoItem in genobj.info) {\n      genobj.info[infoItem].data = genobj.info[infoItem].def_data\n    } // Endif.\n\n    gen_private.type.msoffice.src_files_list = []\n\n    // Ask the document implementation to clear it's data:\n    genobj.emit('clearDocType', gen_private)\n  }\n\n  // Basic API for plugins:\n\n  gen_private.plugs.type.msoffice = {}\n\n  /**\n   * Configure a new Office property type.\n   *\n   * This method register a new type of property that the user can configure. This property must be\n   * a valid MS-Office property as you can configure on the \"files/properties\" menu option on MS-Office.\n   *\n   * @param {object} element_name The name of the XML element of this type.\n   * @param {object} def_data Default value of this type.\n   * @param {object} prop_name The name of the options property to configure this type.\n   * @param {object} user_access_func_name The name of the function to create to configure this type.\n   */\n  gen_private.plugs.type.msoffice.addInfoType = function(\n    element_name,\n    def_data,\n    prop_name,\n    user_access_func_name\n  ) {\n    genobj.info[element_name] = {}\n    genobj.info[element_name].element = element_name\n    genobj.info[element_name].data = def_data\n    genobj.info[element_name].def_data = def_data\n\n    // The user of officegen can configure this property using the options object:\n    if (genobj.options[prop_name]) {\n      genobj.info[element_name].data = genobj.options[prop_name]\n    } // Endif.\n\n    genobj[user_access_func_name] = function(new_data) {\n      genobj.info[element_name].data = new_data\n    }\n  }\n\n  /**\n   * Get the string that opening every Office XML type.\n   *\n   * Every Microsoft Office XML resource will have this header at the begining of the file.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml = function(data) {\n    return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n'\n  }\n\n  /**\n   * Generate rel based XML file.\n   *\n   * @param {object} data Array filled with all the rels links.\n   * @return Text string.\n   */\n  gen_private.plugs.type.msoffice.cbMakeRels = function(data) {\n    var outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data)\n    outString +=\n      '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'\n\n    // Add all the rels records inside the data array:\n    var realRel = 1\n    for (var i = 0, total_size = data.length; i < total_size; i++) {\n      if (typeof data[i] !== 'undefined') {\n        outString +=\n          '<Relationship Id=\"rId' +\n          realRel +\n          '\" Type=\"' +\n          data[i].type +\n          '\" Target=\"' +\n          data[i].target +\n          '\"'\n\n        if (data[i].targetMode) {\n          outString += ' TargetMode=\"' + data[i].targetMode + '\"'\n        } // Endif.\n\n        outString += '/>'\n        realRel++\n      } // Endif.\n    } // End of for loop.\n\n    outString += '</Relationships>\\n'\n    return outString\n  }\n\n  /**\n   * Prepare the officegen object to MS-Office documents.\n   *\n   * Every plugin that implementing gemenrating MS-Office document must call this method to initialize\n   * the common stuff.\n   *\n   * @param {object} main_path The name of the main folder holding the common resources of this type.\n   * @param {object} main_file The main resource file name of this type.\n   * @param {object} ext_opt Optional settings (unused right now).\n   */\n  gen_private.plugs.type.msoffice.makeOfficeGenerator = function(\n    main_path,\n    main_file,\n    ext_opt\n  ) {\n    gen_private.features.type.msoffice = {}\n    gen_private.features.type.msoffice.main_path = main_path\n    gen_private.features.type.msoffice.main_path_file = main_file\n    gen_private.type.msoffice = {}\n    gen_private.type.msoffice.rels_main = []\n    gen_private.type.msoffice.rels_app = []\n    gen_private.type.msoffice.files_list = []\n    gen_private.type.msoffice.src_files_list = []\n\n    // Holding all the Office properties:\n    genobj.info = {}\n\n    genobj.on('afterGen', cbOfficeClearAfterGenerate)\n    genobj.on('clearDoc', cbOfficeClearDocData)\n\n    gen_private.type.msoffice.rels_main.push(\n      {\n        target: 'docProps/app.xml',\n        type:\n          'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties',\n        clear: 'type'\n      },\n      {\n        target: 'docProps/core.xml',\n        type:\n          'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties',\n        clear: 'type'\n      },\n      {\n        target:\n          gen_private.features.type.msoffice.main_path +\n          '/' +\n          gen_private.features.type.msoffice.main_path_file +\n          '.xml',\n        type:\n          'http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument',\n        clear: 'type'\n      }\n    )\n\n    gen_private.type.msoffice.files_list.push(\n      {\n        ext: 'rels',\n        type: 'application/vnd.openxmlformats-package.relationships+xml',\n        clear: 'type'\n      },\n      {\n        ext: 'xml',\n        type: 'application/xml',\n        clear: 'type'\n      },\n      {\n        ext: 'jpeg',\n        type: 'image/jpeg',\n        clear: 'type'\n      },\n      {\n        ext: 'png',\n        type: 'image/png',\n        clear: 'type'\n      },\n      {\n        ext: 'gif',\n        type: 'image/gif',\n        clear: 'type'\n      },\n      {\n        name: '/docProps/app.xml',\n        type:\n          'application/vnd.openxmlformats-officedocument.extended-properties+xml',\n        clear: 'type'\n      },\n      {\n        name:\n          '/' +\n          gen_private.features.type.msoffice.main_path +\n          '/theme/theme1.xml',\n        type: 'application/vnd.openxmlformats-officedocument.theme+xml',\n        clear: 'type'\n      },\n      {\n        name: '/docProps/core.xml',\n        type: 'application/vnd.openxmlformats-package.core-properties+xml',\n        clear: 'type'\n      }\n    )\n\n    genobj.theme = genobj.options.themeXml || null\n\n    genobj.setTheme = function(xmlData) {\n      genobj.theme = xmlData\n      // BMK_TODO: BMK_TODO: In the future I'll add a parser to the .thmx files.\n    }\n\n    gen_private.plugs.intAddAnyResourceToParse(\n      '_rels\\\\.rels',\n      'buffer',\n      gen_private.type.msoffice.rels_main,\n      gen_private.plugs.type.msoffice.cbMakeRels,\n      true\n    )\n    gen_private.plugs.intAddAnyResourceToParse(\n      '[Content_Types].xml',\n      'buffer',\n      null,\n      cbMakeMainFilesList,\n      true\n    )\n    gen_private.plugs.intAddAnyResourceToParse(\n      'docProps\\\\core.xml',\n      'buffer',\n      null,\n      cbMakeCore,\n      true\n    )\n\n    gen_private.plugs.intAddAnyResourceToParse(\n      gen_private.features.type.msoffice.main_path + '\\\\theme\\\\theme1.xml',\n      'buffer',\n      null,\n      cbMakeTheme,\n      true\n    )\n  }\n\n  /**\n   * Generate random unique ID.\n   *\n   * This method generates a random unique ID.\n   *\n   * @param {object} baseGroup Optional first part of the ID.\n   * @return Unique ID string.\n   */\n  gen_private.plugs.type.msoffice.makeUniqueID = function(baseGroup) {\n    var charTable = [\n      '0',\n      '1',\n      '2',\n      '3',\n      '4',\n      '5',\n      '6',\n      '7',\n      '8',\n      '9',\n      'A',\n      'B',\n      'C',\n      'D',\n      'E',\n      'F',\n      'G',\n      'H',\n      'I',\n      'J',\n      'K',\n      'L',\n      'M',\n      'N',\n      'O',\n      'P',\n      'Q',\n      'R',\n      'S',\n      'T',\n      'U',\n      'V',\n      'W',\n      'X',\n      'Y',\n      'Z'\n    ]\n\n    function makeRandomChar() {\n      return charTable[Math.floor(Math.random() * charTable.length)]\n    }\n\n    var outStr =\n      baseGroup ||\n      makeRandomChar() +\n        makeRandomChar() +\n        makeRandomChar() +\n        makeRandomChar() +\n        makeRandomChar() +\n        makeRandomChar() +\n        makeRandomChar() +\n        makeRandomChar()\n\n    outStr +=\n      '-' +\n      makeRandomChar() +\n      makeRandomChar() +\n      makeRandomChar() +\n      makeRandomChar()\n    outStr +=\n      '-' +\n      makeRandomChar() +\n      makeRandomChar() +\n      makeRandomChar() +\n      makeRandomChar()\n    outStr +=\n      '-' +\n      makeRandomChar() +\n      makeRandomChar() +\n      makeRandomChar() +\n      makeRandomChar()\n    outStr +=\n      '-' +\n      makeRandomChar() +\n      makeRandomChar() +\n      makeRandomChar() +\n      makeRandomChar()\n    outStr +=\n      makeRandomChar() + makeRandomChar() + makeRandomChar() + makeRandomChar()\n    outStr +=\n      makeRandomChar() + makeRandomChar() + makeRandomChar() + makeRandomChar()\n    return outStr\n  }\n\n  return this\n}\n\nbaseobj.plugins.registerPrototype(\n  'msoffice',\n  makemsdoc,\n  'Microsoft Office Document Prototype'\n)\n\nexports.makemsdoc = makemsdoc\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}