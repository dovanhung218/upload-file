{"ast":null,"code":"//\n// officegen: All the code to generate PPTX/PPTS files.\n//\n// Please refer to README.md for this module's documentations.\n//\n// Copyright (c) 2013 Ziv Barber;\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n//\n\n/**\n * Basicgen plugin to create pptx files (Microsoft PowerPoint).\n */\n\nvar baseobj = require('./basicgen.js');\nvar OfficeChart = require('./officechart.js');\nvar msdoc = require('./msofficegen.js');\nvar pptxShapes = require('./pptxshapes.js');\nvar pptxFields = require('./pptxfields.js');\nvar officeTable = require('./genofficetable');\nvar path = require('path');\nvar fast_image_size = require('fast-image-size');\nvar excelbuilder = require('./msexcel-builder.js');\nvar xmlBuilder = require('xmlbuilder');\nvar docplugman = require('./docplug');\n\n// Officegen pptx plugins:\nvar plugWidescreen = require('./pptxplg-widescreen');\nvar plugSpeakernotes = require('./pptxplg-speakernotes');\nvar plugLayouts = require('./pptxplg-layouts');\n// BMK_PPTX_PLUG:\n\nfunction encodeHTML(inStr) {\n  return inStr.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n}\nvar GLOBAL_CHART_COUNT = 0;\n\n/**\n * Extend officegen object with PPTX/PPSX support.\n *\n * This method extending the given officegen object to create PPTX/PPSX document.\n *\n * @param {object} genobj The object to extend.\n * @param {string} new_type The type of object to create.\n * @param {object} options The object's options.\n * @param {object} gen_private Access to the internals of this object.\n * @param {object} type_info Additional information about this type.\n * @constructor\n * @name makePptx\n */\nfunction makePptx(genobj, new_type, options, gen_private, type_info) {\n  /**\n   * Prepare the default data.\n   * @param {object} docpluginman Access to the document plugins manager.\n   */\n  function setDefaultDocValues(docpluginman) {\n    var pptxData = docpluginman.getDataStorage();\n\n    // Please put any setting that API can override here:\n    pptxData.EMUS_PER_PT = 12700;\n    pptxData.pptWidth = 720 * pptxData.EMUS_PER_PT;\n    pptxData.pptHeight = 540 * pptxData.EMUS_PER_PT;\n    pptxData.pptType = 'screen4x3';\n\n    // Rels im the main rels file that depended on the data and must be added after the slides:\n    pptxData.extraMainRelList = [];\n  }\n\n  /**\n   * Convert shape name to shape information.\n   *\n   * This method convert the shape information reseived from the user to the real shape information object.\n   *\n   * @param {object} shapeName Either the name of the shape or the shape information.\n   * @return Information about this shape.\n   */\n  function getShapeInfo(shapeName) {\n    if (!shapeName) {\n      return pptxShapes.RECTANGLE;\n    } // Endif.\n\n    if (typeof shapeName === 'object' && shapeName.name && shapeName.displayName && shapeName.avLst) {\n      return shapeName;\n    } // Endif.\n\n    if (pptxShapes[shapeName]) {\n      return pptxShapes[shapeName];\n    } // Endif.\n\n    for (var shapeIntName in pptxShapes) {\n      if (pptxShapes[shapeIntName].name === shapeName) {\n        return pptxShapes[shapeIntName];\n      } // Endif.\n\n      if (pptxShapes[shapeIntName].displayName === shapeName) {\n        return pptxShapes[shapeIntName];\n      } // Endif.\n    } // End of for loop.\n\n    return pptxShapes.RECTANGLE;\n  }\n  genobj.shapes = pptxShapes;\n  genobj.fields = pptxFields;\n  genobj.options = options && typeof options === 'object' ? options : {};\n\n  // Temporary, I'll create a new code without the need to create a temp file (Ziv Barber, 2016-06-23):\n  if (!genobj.options.tempDir) {\n    genobj.options.tempDir = './';\n  } // Endif.\n\n  /**\n   * Prepare everything to generate PPTX files.\n   *\n   * This method checking for extra resources needed to add by the generator engine.\n   */\n  function cbPreparePptxToGenerate() {\n    genobj.generate_data = {};\n\n    // Tell all the features (plugins) that we are about to generate a new document zip:\n    gen_private.features.type.pptx.emitEvent('beforeGen', genobj);\n\n    // Allow some plugins to do more stuff after all the plugins added their data:\n    gen_private.features.type.pptx.emitEvent('beforeGenFinal', genobj);\n\n    // Apple Keynote requires these added *after* all slides:\n    gen_private.type.msoffice.rels_app.push({\n      type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/presProps',\n      target: 'presProps.xml',\n      clear: 'type'\n    }, {\n      type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/viewProps',\n      target: 'viewProps.xml',\n      clear: 'type'\n    }, {\n      type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\n      target: 'theme/theme1.xml',\n      clear: 'type'\n    });\n\n    // This event allow the plugins to add permanent rels that must be at the end:\n    var extraMainRelList = [];\n    gen_private.features.type.pptx.emitEvent('addMainRels', {\n      genobj: genobj,\n      relsList: extraMainRelList\n    });\n    extraMainRelList.forEach(function (value) {\n      gen_private.type.msoffice.rels_app.push(value);\n    });\n\n    // Add any extra rels needed by the plugins and depended on the data:\n    if (gen_private.type.pptx.extraMainRelList && typeof gen_private.type.pptx.extraMainRelList === 'object' && gen_private.type.pptx.extraMainRelList.forEach) {\n      gen_private.type.pptx.extraMainRelList.forEach(function (value) {\n        gen_private.type.msoffice.rels_app.push(value);\n      });\n    }\n    gen_private.type.msoffice.rels_app.push({\n      type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles',\n      target: 'tableStyles.xml',\n      clear: 'type'\n    });\n  }\n\n  /**\n   * Create the 'presProps.xml' resource.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxPresProps(data) {\n    return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<p:presentationPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"><p:extLst><p:ext uri=\"{E76CE94A-603C-4142-B9EB-6D1370010A27}\"><p14:discardImageEditData xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"0\"/></p:ext><p:ext uri=\"{D31A062A-798A-4329-ABDD-BBA856620510}\"><p14:defaultImageDpi xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"220\"/></p:ext><p:ext uri=\"{FD5EFAAD-0ECE-453E-9831-46B23BE46B34}\"><p15:chartTrackingRefBased xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\" val=\"1\"/></p:ext></p:extLst></p:presentationPr>';\n  }\n\n  /**\n   * Create the 'tableStyles.xml' resource.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxStyles(data) {\n    return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<a:tblStyleLst xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" def=\"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}\"/>';\n  }\n\n  /**\n   * Create the 'viewProps.xml' resource.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxViewProps(data) {\n    return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<p:viewPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"><p:normalViewPr><p:restoredLeft sz=\"15620\"/><p:restoredTop sz=\"94660\"/></p:normalViewPr><p:slideViewPr><p:cSldViewPr><p:cViewPr varScale=\"1\"><p:scale><a:sx n=\"64\" d=\"100\"/><a:sy n=\"64\" d=\"100\"/></p:scale><p:origin x=\"-1392\" y=\"-96\"/></p:cViewPr><p:guideLst><p:guide orient=\"horz\" pos=\"2160\"/><p:guide pos=\"2880\"/></p:guideLst></p:cSldViewPr></p:slideViewPr><p:notesTextViewPr><p:cViewPr><p:scale><a:sx n=\"100\" d=\"100\"/><a:sy n=\"100\" d=\"100\"/></p:scale><p:origin x=\"0\" y=\"0\"/></p:cViewPr></p:notesTextViewPr><p:gridSpacing cx=\"78028800\" cy=\"78028800\"/></p:viewPr>';\n  }\n\n  /**\n   * Create the 'slideLayout1.xml' resource.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxLayout1(data) {\n    if (!data || typeof data !== 'object') {\n      data = {};\n    } // Endif.\n\n    // You can place here the title:\n    var ph1 = '<a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p>';\n    if (data.ph1 && data.slide && data.ph1.length) {\n      ph1 = cMakePptxOutTextP('', data.ph1, {}, data.slide);\n    } // Endif.\n\n    // The sub-title:\n    var ph2 = '<a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master subtitle style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p>';\n    if (data.ph2 && data.slide && data.ph2.length) {\n      ph2 = cMakePptxOutTextP('', data.ph2, {}, data.slide);\n    } // Endif.\n\n    var ph3 = createFieldText('DATE_TIME', 1, data.useDate);\n    var footFull = '';\n    var ft = '';\n    var curElNum = 4;\n    if (data.isDate || !data.isRealSlide) {\n      footFull += '<p:sp><p:nvSpPr><p:cNvPr id=\"' + curElNum + '\" name=\"Date Placeholder 3\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"dt\" sz=\"half\" idx=\"10\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:fld id=\"{F8166F1F-CE9B-4651-A6AA-CD717754106B}\" type=\"datetimeFigureOut\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>' + ph3 + '</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp>';\n      curElNum++;\n    } // Endif.\n\n    if (data.isFooter && data.ft && data.slide && data.ft.length) {\n      ft = cMakePptxOutTextP('', data.ft, {}, data.slide);\n      footFull += '<p:sp><p:nvSpPr><p:cNvPr id=\"' + curElNum + '\" name=\"Footer Placeholder 4\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ftr\" sz=\"quarter\" idx=\"11\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/>' + ft + '</p:txBody></p:sp>';\n      curElNum++;\n    } else if (!data.isRealSlide) {\n      footFull += '<p:sp><p:nvSpPr><p:cNvPr id=\"' + curElNum + '\" name=\"Footer Placeholder 4\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ftr\" sz=\"quarter\" idx=\"11\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp>';\n      curElNum++;\n    } // Endif.\n\n    if (data.isSlideNum || !data.isRealSlide) {\n      footFull += '<p:sp><p:nvSpPr><p:cNvPr id=\"' + curElNum + '\" name=\"Slide Number Placeholder 5\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"12\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:fld id=\"{B1393E5F-521B-4CAD-9D3A-AE923D912DCE}\" type=\"slidenum\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>‹#›</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp>';\n      curElNum++;\n    } // Endif.\n\n    return gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<p:sld' + (data.isRealSlide ? '' : 'Layout') + ' xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"' + (data.isRealSlide ? '' : ' type=\"title\" preserve=\"1\"') + '><p:cSld name=\"Title Slide\"><p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id=\"2\" name=\"Title 1\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ctrTitle\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"685800\" y=\"2130425\"/><a:ext cx=\"7772400\" cy=\"1470025\"/></a:xfrm></p:spPr><p:txBody><a:bodyPr/><a:lstStyle/>' + ph1 + '</p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"3\" name=\"Subtitle 2\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"subTitle\" idx=\"1\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"1371600\" y=\"3886200\"/><a:ext cx=\"6400800\" cy=\"1752600\"/></a:xfrm></p:spPr><p:txBody><a:bodyPr/><a:lstStyle><a:lvl1pPr marL=\"0\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"457200\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"914400\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"1371600\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"1828800\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"2286000\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"2743200\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"3200400\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"3657600\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle>' + ph2 + '</p:txBody></p:sp>' + footFull + '</p:spTree></p:cSld><p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr></p:sld' + (data.isRealSlide ? '' : 'Layout') + '>';\n  }\n\n  /**\n   * Create the main presentation resource.\n   *\n   * This resource is the main resource of any PowerPoint document.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxPresentation(data) {\n    var outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<p:presentation xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" saveSubsetFonts=\"1\"><p:sldMasterIdLst><p:sldMasterId id=\"2147483648\" r:id=\"rId1\"/></p:sldMasterIdLst>';\n\n    // Signal to the plugins to add any extra xml needed for this file:\n    var dataToPlugs = {\n      data: outString\n    };\n    gen_private.features.type.pptx.emitEvent('presentationGen', dataToPlugs);\n    outString = dataToPlugs.data + '<p:sldIdLst>';\n    for (var i = 0, total_size = gen_private.pages.length; i < total_size; i++) {\n      outString += '<p:sldId id=\"' + (i + 256) + '\" r:id=\"rId' + (i + 2) + '\"/>';\n    } // End of for loop.\n\n    outString += '</p:sldIdLst><p:sldSz cx=\"' + gen_private.type.pptx.pptWidth + '\" cy=\"' + gen_private.type.pptx.pptHeight + '\" type=\"' + gen_private.type.pptx.pptType + '\"/><p:notesSz cx=\"' + gen_private.type.pptx.pptHeight + '\" cy=\"' + gen_private.type.pptx.pptWidth + '\"/><p:defaultTextStyle><a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr>';\n    var curPos = 0;\n    for (i = 1; i < 10; i++) {\n      outString += '<a:lvl' + i + 'pPr marL=\"' + curPos + '\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl' + i + 'pPr>';\n      curPos += 457200;\n    } // End of for loop.\n\n    outString += '</p:defaultTextStyle>';\n    outString += '<p:extLst><p:ext uri=\"{EFAFB233-063F-42B5-8137-9DF3F51BA10A}\"><p15:sldGuideLst xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\"/></p:ext></p:extLst></p:presentation>';\n    return outString;\n  }\n\n  /**\n   * Create the slides masters resource.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxSlideMasters(data) {\n    var outData = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<p:sldMaster xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"><p:cSld><p:bg><p:bgRef idx=\"1001\"><a:schemeClr val=\"bg1\"/></p:bgRef></p:bg><p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id=\"2\" name=\"Title Placeholder 1\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"title\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"274638\"/><a:ext cx=\"8229600\" cy=\"1143000\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"><a:normAutofit/></a:bodyPr><a:lstStyle/><a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"3\" name=\"Text Placeholder 2\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"body\" idx=\"1\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"1600200\"/><a:ext cx=\"8229600\" cy=\"4525963\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\"><a:normAutofit/></a:bodyPr><a:lstStyle/><a:p><a:pPr lvl=\"0\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl=\"1\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl=\"2\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl=\"3\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl=\"4\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Fifth level</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"4\" name=\"Date Placeholder 3\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"dt\" sz=\"half\" idx=\"2\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"6356350\"/><a:ext cx=\"2133600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"l\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\"{F8166F1F-CE9B-4651-A6AA-CD717754106B}\" type=\"datetimeFigureOut\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>6/13/2013</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"5\" name=\"Footer Placeholder 4\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ftr\" sz=\"quarter\" idx=\"3\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"3124200\" y=\"6356350\"/><a:ext cx=\"2895600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"ctr\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"6\" name=\"Slide Number Placeholder 5\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"4\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"6553200\" y=\"6356350\"/><a:ext cx=\"2133600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"r\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\"{F7021451-1387-4CA6-816F-3879F97B5CBC}\" type=\"slidenum\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>�#�</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp></p:spTree></p:cSld><p:clrMap bg1=\"lt1\" tx1=\"dk1\" bg2=\"lt2\" tx2=\"dk2\" accent1=\"accent1\" accent2=\"accent2\" accent3=\"accent3\" accent4=\"accent4\" accent5=\"accent5\" accent6=\"accent6\" hlink=\"hlink\" folHlink=\"folHlink\"/><p:sldLayoutIdLst>';\n    var curRelId = 1;\n    var curId = 2147483649;\n    var getDocData = plugsmanObj.getDataStorage();\n\n    // Add all the slide layouts needed:\n    outData += '<p:sldLayoutId id=\"' + curId + '\" r:id=\"rId' + curRelId + '\"/>';\n    curRelId++;\n    curId++;\n    if (getDocData.slideLayouts && typeof getDocData.slideLayouts === 'object') {\n      for (var item in getDocData.slideLayouts) {\n        if (getDocData.slideLayouts[item]) {\n          outData += '<p:sldLayoutId id=\"' + curId + '\" r:id=\"rId' + getDocData.slideLayouts[item].relIdMaster + '\"/>';\n          curRelId++;\n          curId++;\n        } // Endif.\n      } // End of for loop.\n    } // Endif.\n\n    outData += '</p:sldLayoutIdLst><p:txStyles><p:titleStyle><a:lvl1pPr algn=\"ctr\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"0\"/></a:spcBef><a:buNone/><a:defRPr sz=\"4400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mj-lt\"/><a:ea typeface=\"+mj-ea\"/><a:cs typeface=\"+mj-cs\"/></a:defRPr></a:lvl1pPr></p:titleStyle><p:bodyStyle><a:lvl1pPr marL=\"342900\" indent=\"-342900\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"3200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"742950\" indent=\"-285750\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"1143000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"1600200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"2057400\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"2514600\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"2971800\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"3429000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"3886200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr></p:bodyStyle><p:otherStyle><a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr><a:lvl1pPr marL=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"457200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"914400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"1371600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"1828800\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"2286000\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"2743200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"3200400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"3657600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr></p:otherStyle></p:txStyles></p:sldMaster>';\n    return outData;\n  }\n\n  /**\n   * Generate the XML code to describe colors.\n   *\n   * @param {object} color_info Foreground color information.\n   * @param {object} back_info Background color information.\n   */\n  function cMakePptxColorSelection(color_info, back_info) {\n    var outText = '';\n    var colorVal;\n    var fillType = 'solid';\n    var internalElements = '';\n    if (back_info) {\n      outText += '<p:bg><p:bgPr>';\n      outText += cMakePptxColorSelection(back_info, false);\n      outText += '<a:effectLst/>';\n      // BMK_TODO: (add support for effects)\n\n      outText += '</p:bgPr></p:bg>';\n    } // Endif.\n\n    if (color_info) {\n      if (typeof color_info === 'string') {\n        colorVal = color_info;\n      } else {\n        if (color_info.type) {\n          fillType = color_info.type;\n        } // Endif.\n\n        if (color_info.color) {\n          colorVal = color_info.color;\n        } // Endif.\n\n        if (color_info.alpha) {\n          internalElements += '<a:alpha val=\"' + (100 - color_info.alpha) + '000\"/>';\n        } // Endif.\n      } // Endif.\n\n      switch (fillType) {\n        case 'solid':\n          outText += '<a:solidFill><a:srgbClr val=\"' + colorVal + '\">' + internalElements + '</a:srgbClr></a:solidFill>';\n          break;\n        case 'gradient':\n          outText += '<a:gradFill flip=\"none\" rotWithShape=\"1\"><a:gsLst>';\n          for (var item in colorVal) {\n            if (typeof colorVal[item] === 'string') {\n              // Positions are inverted because they start with 100000:\n              outText += '<a:gs pos=\"' + (100000 - Math.round(100000 / (colorVal.length - 1) * item)) + '\"><a:srgbClr val=\"' + colorVal[item] + '\">' + internalElements + '</a:srgbClr></a:gs>';\n            } else {\n              outText += '<a:gs pos=\"' + colorVal[item].position * 1000 + '\"><a:srgbClr val=\"' + colorVal[item].color + '\">' + internalElements + '</a:srgbClr></a:gs>';\n            } // Endif.\n          } // End of for loop.\n\n          if (typeof color_info.angle !== 'undefined') {\n            outText += '</a:gsLst><a:lin ang=\"' + color_info.angle * 100000 + '\" scaled=\"1\"/><a:tileRect/></a:gradFill>';\n          } else {\n            outText += '</a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"100000\" t=\"100000\"/></a:path><a:tileRect r=\"-100000\" b=\"-100000\"/></a:gradFill>';\n          } // Endif.\n          break;\n      } // End of switch.\n    } // Endif.\n\n    return outText;\n  }\n\n  /**\n   * Translate field_name into the text real value.\n   *\n   * This method creating the text to display for the given field.\n   *\n   * @param {string} field_name the name of the field.\n   * @param {number} slide_num current slide number.\n   * @param {Date} useDate Optional date to use instead of the current date.\n   * @return The text string data.\n   */\n  function createFieldText(field_name, slide_num, useDate) {\n    var curDateTime = useDate ? new Date(useDate) : new Date();\n    var dayInWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n    var monthsList = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\n    var monthsShortList = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    var outValue = '';\n\n    // curDateTime.getDate ()   Returns the day of the month (from 1-31)\n    // curDateTime.getDay ()   Returns the day of the week (from 0-6)\n    // curDateTime.getFullYear ()   Returns the year (four digits)\n    // curDateTime.getHours ()   Returns the hour (from 0-23)\n    // curDateTime.getMinutes ()   Returns the minutes (from 0-59)\n    // curDateTime.getMonth ()   Returns the month (from 0-11)\n    // curDateTime.getSeconds ()   Returns the seconds (from 0-59)\n\n    switch (field_name) {\n      // presentation slide number:\n      case 'SLIDE_NUM':\n      case 'slidenum':\n        outValue += slide_num;\n        break;\n\n      // default date time format for the rendering application:\n      case 'DATE_TIME':\n      case 'datetime':\n        outValue += curDateTime.getMonth() + 1 + '/' + curDateTime.getDate() + '/' + curDateTime.getFullYear();\n        break;\n\n      // MM/DD/YYYY date time format (Example: 10/12/2007):\n      case 'DATE_MM_DD_YYYY':\n      case 'datetime1':\n        outValue += curDateTime.getMonth() + 1 + '/' + curDateTime.getDate() + '/' + curDateTime.getFullYear();\n        break;\n\n      // Day, Month DD, YYYY date time format (Example: Friday, October 12, 2007):\n      case 'DATE_WD_MN_DD_YYYY':\n      case 'datetime2':\n        outValue += dayInWeek[curDateTime.getDay()] + ', ' + monthsList[curDateTime.getMonth()] + ' ' + curDateTime.getDate() + ', ' + curDateTime.getFullYear();\n        break;\n\n      // DD Month YYYY date time format (Example: 12 October 2007):\n      case 'DATE_DD_MN_YYYY':\n      case 'datetime3':\n        outValue += curDateTime.getDate() + ' ' + monthsList[curDateTime.getMonth()] + ' ' + curDateTime.getFullYear();\n        break;\n\n      // Month DD, YYYY date time format (Example: October 12, 2007):\n      case 'DATE_MN_DD_YYYY':\n      case 'datetime4':\n        outValue += monthsList[curDateTime.getMonth()] + ' ' + curDateTime.getDate() + ', ' + curDateTime.getFullYear();\n        break;\n\n      // DD-Mon-YY date time format (Example: 12-Oct-07):\n      case 'DATE_DD_SMN_YY':\n      case 'datetime5':\n        outValue += curDateTime.getDate() + '-' + monthsShortList[curDateTime.getMonth()] + '-' + curDateTime.getFullYear() % 100;\n        break;\n\n      // Month YY date time format (Example: October 07):\n      case 'DATE_MM_YY':\n      case 'datetime6':\n        outValue += monthsList[curDateTime.getMonth()] + ' ' + curDateTime.getFullYear() % 100;\n        break;\n\n      // Mon-YY date time format (Example: Oct-07):\n      case 'DATE_SMN_YY':\n      case 'datetime7':\n        outValue += monthsShortList[curDateTime.getMonth()] + '-' + curDateTime.getFullYear() % 100;\n        break;\n\n      // MM/DD/YYYY hh:mm AM/PM date time format (Example: 10/12/2007 4:28 PM):\n      case 'DATE_TIME_DD_MM_YYYY_HH_MM_PM':\n      case 'datetime8':\n        outValue += curDateTime.getMonth() + '/' + curDateTime.getDate() + '/' + curDateTime.getFullYear();\n        outValue += curDateTime.getHours() % 12 + ':' + curDateTime.getMinutes();\n        outValue += curDateTime.getHours() > 11 ? ' PM' : ' AM';\n        break;\n\n      // MM/DD/YYYY hh:mm:ss AM/PM date time format (Example: 10/12/2007 4:28:34 PM):\n      case 'DATE_TIME_DD_MM_YYYY_HH_MM_SC_PM':\n      case 'datetime9':\n        outValue += curDateTime.getMonth() + '/' + curDateTime.getDate() + '/' + curDateTime.getFullYear();\n        outValue += curDateTime.getHours() % 12 + ':' + curDateTime.getMinutes() + ':' + curDateTime.getSeconds();\n        outValue += curDateTime.getHours() > 11 ? ' PM' : ' AM';\n        break;\n\n      // hh:mm date time format (Example: 16:28):\n      case 'TIME_HH_MM':\n      case 'datetime10':\n        outValue += curDateTime.getHours() + ':' + curDateTime.getMinutes();\n        break;\n\n      // hh:mm:ss date time format (Example: 16:28:34):\n      case 'TIME_HH_MM_SC':\n      case 'datetime11':\n        outValue += curDateTime.getHours() + ':' + curDateTime.getMinutes() + ':' + curDateTime.getSeconds();\n        break;\n\n      // hh:mm AM/PM date time format (Example: 4:28 PM):\n      case 'TIME_HH_MM_PM':\n      case 'datetime12':\n        outValue += curDateTime.getHours() % 12 + ':' + curDateTime.getMinutes();\n        outValue += curDateTime.getHours() > 11 ? ' PM' : ' AM';\n        break;\n\n      // hh:mm:ss: AM/PM date time format (Example: 4:28:34 PM):\n      case 'TIME_HH_MM_SC_PM':\n      case 'datetime13':\n        outValue += curDateTime.getHours() % 12 + ':' + curDateTime.getMinutes() + ':' + curDateTime.getSeconds();\n        outValue += curDateTime.getHours() > 11 ? ' PM' : ' AM';\n        break;\n      default:\n        return null;\n    } // End of switch.\n\n    return outValue;\n  }\n\n  /**\n   * ???.\n   *\n   * @param {object} text_info Information how to display the text.\n   * @param {object} slide_obj The object of this slider.\n   * @return Text string.\n   */\n  function cMakePptxOutTextData(text_info, slide_obj) {\n    var out_obj = {};\n    out_obj.font_size = '';\n    out_obj.bold = '';\n    out_obj.italic = '';\n    out_obj.strike = '';\n    out_obj.underline = '';\n    out_obj.rpr_info = '';\n    out_obj.char_spacing = '';\n    out_obj.baseline = '';\n    if (typeof text_info === 'object') {\n      if (text_info.bold) {\n        out_obj.bold = ' b=\"1\"';\n      } // Endif.\n\n      if (text_info.italic) {\n        out_obj.italic = ' i=\"1\"';\n      } // Endif.\n\n      if (text_info.strike) {\n        out_obj.strike = ' strike=\"sngStrike\"';\n      } // Endif.\n\n      if (text_info.underline) {\n        out_obj.underline = ' u=\"sng\"';\n      } // Endif.\n\n      if (text_info.font_size) {\n        out_obj.font_size = ' sz=\"' + text_info.font_size + '00\"';\n      } // Endif.\n\n      // psv 2015-01-21 Manually copied in from https://github.com/Ziv-Barber/officegen/pull/41/files\n      if (text_info.char_spacing) {\n        out_obj.char_spacing = ' spc=\"' + text_info.char_spacing * 100 + '\"';\n\n        // Must also disable kerning otherwise text won't actually expand:\n        out_obj.char_spacing += ' kern=\"0\"';\n      } // Endif.\n\n      if (text_info.baseline) {\n        out_obj.baseline = ' baseline=\"' + text_info.baseline * 1000 + '\"';\n      } // Endif.\n\n      if (text_info.color) {\n        out_obj.rpr_info += cMakePptxColorSelection(text_info.color);\n      } else if (slide_obj && slide_obj.color) {\n        out_obj.rpr_info += cMakePptxColorSelection(slide_obj.color);\n      } // Endif.\n\n      if (text_info.font_face) {\n        out_obj.rpr_info += '<a:latin typeface=\"' + text_info.font_face + '\" pitchFamily=\"34\" charset=\"0\"/><a:cs typeface=\"' + text_info.font_face + '\" pitchFamily=\"34\" charset=\"0\"/>';\n      } // Endif.\n    } else {\n      if (slide_obj && slide_obj.color) {\n        out_obj.rpr_info += cMakePptxColorSelection(slide_obj.color);\n      } // Endif.\n    } // Endif.\n\n    if (out_obj.rpr_info !== '') {\n      out_obj.rpr_info += '</a:rPr>';\n    } // Endif.\n\n    return out_obj;\n  }\n\n  /**\n   * Create a text object for adding into a slide.\n   *\n   * @param {object} text_info Information how to display the text.\n   * @param {object} text_string The text string or requested field.\n   * @param {object} slide_obj The object of this slider.\n   * @param {object} slide_num Current slide number.\n   * @param {string} out_styles Paragraph style used to style paragraphs generated by newlines\n   * @return The PPTX code.\n   */\n  function cMakePptxOutTextCommand(text_info, text_string, slide_obj, slide_num, out_styles) {\n    text_info = text_info || {};\n    var area_opt_data = cMakePptxOutTextData(text_info, slide_obj);\n    var textStyles = ['font_size', 'strike', 'italic', 'bold', 'underline', 'char_spacing', 'baseline'].reduce(function (acc, attr) {\n      return acc + area_opt_data[attr];\n    }, '');\n    var parsedText;\n    var startInfo = '<a:rPr lang=\"en-US\"' + textStyles + ' dirty=\"0\" smtClean=\"0\"' + (area_opt_data.rpr_info !== '' ? '>' + area_opt_data.rpr_info : '/>') + '<a:t>';\n    var endTag = '</a:r>';\n    var outData = '<a:r>' + startInfo;\n    if (text_string.field) {\n      endTag = '</a:fld>';\n      var outTextField = pptxFields[text_string.field];\n      if (outTextField === null) {\n        for (var fieldIntName in pptxFields) {\n          if (pptxFields[fieldIntName] === text_string.field) {\n            outTextField = text_string.field;\n            break;\n          } // Endif.\n        } // End of for loop.\n\n        if (outTextField === null) {\n          outTextField = 'datetime';\n        } // Endif.\n      } // Endif.\n\n      outData = '<a:fld id=\"{' + gen_private.plugs.type.msoffice.makeUniqueID('5C7A2A3D') + '}\" type=\"' + outTextField + '\">' + startInfo;\n      outData += createFieldText(outTextField, slide_num);\n    } else {\n      // Automatic support for newline - split it into multi-p:\n      parsedText = text_string.split('\\n');\n      if (parsedText.length > 1) {\n        var outTextData = '';\n        for (var i = 0, total_size_i = parsedText.length; i < total_size_i; i++) {\n          outTextData += outData + encodeHTML(parsedText[i]);\n          if (i + 1 < total_size_i) {\n            outTextData += '</a:t></a:r></a:p><a:p>';\n            if (out_styles) outTextData += out_styles;\n          } // Endif.\n        } // End of for loop.\n\n        outData = outTextData;\n      } else {\n        outData += encodeHTML(text_string);\n      } // Endif.\n    } // Endif.\n\n    var outBreakP = '';\n    if (text_info.breakLine) {\n      outBreakP += '</a:p><a:p>';\n    } // Endif.\n\n    return outData + '</a:t>' + endTag + outBreakP;\n  }\n\n  /**\n   * Create all the objects inside a single paragraph.\n   * @param {string} outString The string to add the output xml to it.\n   * @param {Array} pData Array with all the parts of this paragraph.\n   * @param {object} pOptions Paragraph options.\n   * @param {object} slideObj The object of this slider.\n   */\n  function cMakePptxOutTextP(outString, pData, pOptions, slideObj) {\n    var outStyles = '';\n    var moreStylesAttr;\n    var moreStyles;\n\n    // Work on all the parts of this paragraph:\n    for (var j = 0, total_size_j = pData.length; j < total_size_j; j++) {\n      if (pData[j]) {\n        moreStylesAttr = '';\n        moreStyles = '';\n        if (pData[j].options) {\n          if (pData[j].options.align) {\n            switch (pData[j].options.align) {\n              case 'right':\n                moreStylesAttr += ' algn=\"r\"';\n                break;\n              case 'center':\n                moreStylesAttr += ' algn=\"ctr\"';\n                break;\n              case 'justify':\n                moreStylesAttr += ' algn=\"just\"';\n                break;\n            } // End of switch.\n          } // Endif.\n\n          if (pData[j].options.indentLevel > 0) {\n            moreStylesAttr += ' lvl=\"' + pData[j].options.indentLevel + '\"';\n          } // Endif.\n\n          if (pData[j].options.listType === 'number') {\n            moreStyles += '<a:buFont typeface=\"+mj-lt\"/><a:buAutoNum type=\"arabicPeriod\"/>';\n          } else if (pData[j].options.listType === 'dot') {\n            moreStyles += '<a:buChar char=\"•\"/>';\n          } // Endif.\n        } // Endif.\n\n        if (moreStyles !== '') {\n          outStyles = '<a:pPr' + moreStylesAttr + '>' + moreStyles + '</a:pPr>';\n        } else if (moreStylesAttr !== '') {\n          outStyles = '<a:pPr' + moreStylesAttr + '/>';\n        } // Endif.\n\n        if (outStyles || !j) {\n          if (j) {\n            outString += '</a:p>';\n          } // Endif.\n\n          outString += '<a:p>' + outStyles;\n        } // Endif.\n\n        outString += cMakePptxOutTextCommand(pData[j].options, pData[j].text, slideObj, slideObj.getPageNumber(), outStyles);\n      } // Endif.\n    } // End of for loop - adding all the objects inside the paragraph.\n\n    var font_size = '';\n    if (pOptions && pOptions.font_size) {\n      font_size = ' sz=\"' + pOptions.font_size + '00\"';\n    } // Endif.\n\n    outString += '<a:endParaRPr lang=\"en-US\"' + font_size + ' dirty=\"0\"/></a:p>';\n    return outString;\n  }\n\n  /**\n   * ???.\n   *\n   * @param {object} in_data_val Input value as passed by the user.\n   * @param {number} max_value Maximum value allowed.\n   * @param {number} def_value Default value.\n   * @param {number} auto_val ???.\n   * @param {number} mul_val ???.\n   * @return ???.\n   */\n  function parseSmartNumber(in_data_val, max_value, def_value, auto_val, mul_val) {\n    if (typeof in_data_val === 'undefined') {\n      return typeof def_value === 'number' ? def_value : 0;\n    } // Endif.\n\n    if (in_data_val === '') {\n      in_data_val = 0;\n    } // Endif.\n\n    if (typeof in_data_val === 'string' && !isNaN(in_data_val)) {\n      in_data_val = parseInt(in_data_val, 10);\n    } // Endif.\n\n    var realNum = Math.round(mul_val ? in_data_val * mul_val : in_data_val);\n    var realVal;\n    var realMax;\n    if (typeof in_data_val === 'string') {\n      if (in_data_val.indexOf('%') !== -1) {\n        realMax = typeof max_value === 'number' ? max_value : 0;\n        if (realMax <= 0) {\n          return 0;\n        } // Endif.\n\n        realVal = parseInt(in_data_val, 10);\n        return Math.round(realMax / 100 * realVal);\n      } // Endif.\n\n      if (in_data_val.indexOf('#') !== -1) {\n        realVal = parseInt(in_data_val, 10);\n        return realMax;\n      } // Endif.\n\n      var realAuto = typeof auto_val === 'number' ? auto_val : 0;\n      if (in_data_val === '*') {\n        return realAuto;\n      } // Endif.\n\n      if (in_data_val === 'c') {\n        return Math.round(realAuto / 2);\n      } // Endif.\n    } // Endif.\n\n    if (typeof in_data_val === 'number') {\n      return realNum;\n    } // Endif.\n\n    return typeof def_value === 'number' ? def_value : 0;\n  }\n\n  /**\n   * Create the XML code of a single effect.\n   *\n   * This method creating the effect XML code for a single object.\n   *\n   * @param {object} effectData Effect data.\n   * @param {string} effectName The name of the effect.\n   */\n  function cbGenerateEffects(effectData, effectName) {\n    var outData = '<a:' + effectName + ' ';\n    var color = effectData.color || 'black';\n    var alphaPer = 60;\n    var algnData = '';\n    var blurRad = 50800;\n    var dist = 38100;\n    var dir = 13500000;\n    if (typeof effectData.transparency === 'number') {\n      alphaPer = effectData.transparency;\n    } // Endif.\n\n    if (alphaPer > 100 || alphaPer < 0) {\n      alphaPer = 60;\n    }\n    alphaPer = (100 - alphaPer) * 1000;\n    if (effectData.align) {\n      if (effectData.align.top) {\n        algnData += 't';\n      }\n      if (effectData.align.bottom) {\n        algnData += 'b';\n      }\n      if (effectData.align.left) {\n        algnData += 'l';\n      }\n      if (effectData.align.right) {\n        algnData += 'r';\n      }\n    } // Endif.\n\n    if (algnData === '') {\n      algnData = 'br';\n    } // Endif.\n\n    // Size\n    // Blur\n    // Angle\n    // Distance\n    // BMK_TODO:\n\n    outData += ' blurRad=\"' + blurRad + '\" dist=\"' + dist + '\" dir=\"' + dir + '\" algn=\"' + algnData + '\" rotWithShape=\"0\"';\n\n    // sx=\"24000\" sy=\"24000\"\n    // BMK_TODO:\n\n    outData += '><a:prstClr val=\"' + color + '\"><a:alpha val=\"' + alphaPer + '\"/></a:prstClr>';\n    return outData + '</a:' + effectName + '>';\n  }\n\n  /**\n   * Create the body properties code for text.\n   *\n   * This method creating the XML code of the body properties of a text.\n   *\n   * @return The body properties XML code.\n   */\n  function createBodyProperties(objOptions) {\n    var bodyProperties = '<a:bodyPr';\n    if (objOptions && objOptions.bodyProp) {\n      // Set anchorPoints bottom, center or top:\n      if (objOptions.bodyProp.anchor) {\n        bodyProperties += ' anchor=\"' + objOptions.bodyProp.anchor + '\"';\n      } // Endif.\n\n      if (objOptions.bodyProp.anchorCtr) {\n        bodyProperties += ' anchorCtr=\"' + objOptions.bodyProp.anchorCtr + '\"';\n      } // Endif.\n\n      // Enable or disable textwrapping none or square:\n      if (objOptions.bodyProp.wrap) {\n        bodyProperties += ' wrap=\"' + objOptions.bodyProp.wrap + '\"';\n      } else {\n        bodyProperties += ' wrap=\"square\"';\n      } // Endif.\n\n      // Box margins(padding):\n      // BMK_TODO: I should pass a better value as the auto_val parameter of parseSmartNumber().\n      if (objOptions.bodyProp.bIns) {\n        bodyProperties += ' bIns=\"' + parseSmartNumber(objOptions.bodyProp.bIns, gen_private.type.pptx.pptHeight, 369332, gen_private.type.pptx.pptHeight, 10000) + '\"';\n      } // Endif.\n\n      if (objOptions.bodyProp.lIns) {\n        bodyProperties += ' lIns=\"' + parseSmartNumber(objOptions.bodyProp.lIns, gen_private.type.pptx.pptWidth, 2819400, gen_private.type.pptx.pptWidth, 10000) + '\"';\n      } // Endif.\n\n      if (objOptions.bodyProp.rIns) {\n        bodyProperties += ' rIns=\"' + parseSmartNumber(objOptions.bodyProp.rIns, gen_private.type.pptx.pptWidth, 2819400, gen_private.type.pptx.pptWidth, 10000) + '\"';\n      } // Endif.\n\n      if (objOptions.bodyProp.tIns) {\n        bodyProperties += ' tIns=\"' + parseSmartNumber(objOptions.bodyProp.tIns, gen_private.type.pptx.pptHeight, 369332, gen_private.type.pptx.pptHeight, 10000) + '\"';\n      } // Endif.\n\n      bodyProperties += ' rtlCol=\"0\">';\n      if (objOptions.bodyProp.autoFit !== false) {\n        bodyProperties += '<a:spAutoFit/>';\n      } // Endif.\n\n      bodyProperties += '</a:bodyPr>';\n\n      // Default:\n    } else {\n      bodyProperties += ' wrap=\"square\" rtlCol=\"0\"></a:bodyPr>';\n    } // Endif.\n\n    return bodyProperties;\n  }\n\n  /**\n   * Generate a slider resource.\n   *\n   * This function generating a slider XML resource.\n   *\n   * @param {object} data The main slide object.\n   * @param {boolean} makeOnlyObjects is true to turn this method to make only the objects in data.data.\n   * @return Text string.\n   */\n  function cbMakePptxSlide(data, makeOnlyObjects) {\n    var outString = '';\n    var objs_list = data.data;\n    var timingData = '';\n\n    // Slide with layout support:\n    if (data.slide.useLayout && typeof data.slide.useLayout === 'object' && data.slide.useLayout.mkResCb) {\n      data.slide.useLayout.slide = data.slide;\n      return data.slide.useLayout.mkResCb(data.slide.useLayout);\n    } // Endif.\n\n    // Allow you to turn this method into layout generator:\n    var slideElement = data.slide.layoutName ? 'Layout' : '';\n    var slideElementA = data.slide.layoutName ? ' type=\"' + data.slide.layoutName + '\" preserve=\"1\"' : '';\n\n    // Create the header of the slide (only if we need that):\n    if (!makeOnlyObjects) {\n      outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<p:sld' + slideElement + ' xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"';\n      if (!data.slide.show && !data.slide.layoutName) {\n        outString += ' show=\"0\"';\n      } // Endif.\n\n      outString += slideElementA + '><p:cSld' + (data.slide.name ? ' name=\"' + data.slide.name + '\"' : '') + '>';\n      if (data.slide.back) {\n        outString += cMakePptxColorSelection(false, data.slide.back);\n      } // Endif.\n\n      outString += '<p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr>';\n    } // Endif.\n\n    // Loop on all the objects inside the slide to add it into the slide:\n    for (var i = 0, total_size = objs_list.length; i < total_size; i++) {\n      var x = 0;\n      var y = 0;\n      var cx = 2819400;\n      var cy = 369332;\n      var moreStyles = '';\n      var moreStylesAttr = '';\n      var outStyles = '';\n      var styleData = '';\n      var shapeType = null;\n      var locationAttr = '';\n      if (objs_list[i].options) {\n        if (typeof objs_list[i].options.cx !== 'undefined') {\n          if (objs_list[i].options.cx) {\n            cx = parseSmartNumber(objs_list[i].options.cx, gen_private.type.pptx.pptWidth, cx, gen_private.type.pptx.pptWidth, 10000);\n          } else {\n            cx = 1;\n          } // Endif.\n        } // Endif.\n\n        if (typeof objs_list[i].options.cy !== 'undefined') {\n          if (objs_list[i].options.cy) {\n            cy = parseSmartNumber(objs_list[i].options.cy, gen_private.type.pptx.pptHeight, cy, gen_private.type.pptx.pptHeight, 10000);\n          } else {\n            cy = 1;\n          } // Endif.\n        } // Endif.\n\n        if (objs_list[i].options.x) {\n          x = parseSmartNumber(objs_list[i].options.x, gen_private.type.pptx.pptWidth, 0, gen_private.type.pptx.pptWidth - cx, 10000);\n        } // Endif.\n\n        if (objs_list[i].options.y) {\n          y = parseSmartNumber(objs_list[i].options.y, gen_private.type.pptx.pptHeight, 0, gen_private.type.pptx.pptHeight - cy, 10000);\n        } // Endif.\n\n        if (objs_list[i].options.shape) {\n          shapeType = getShapeInfo(objs_list[i].options.shape);\n        } // Endif.\n\n        if (objs_list[i].options.flip_vertical) {\n          locationAttr += ' flipV=\"1\"';\n        } // Endif.\n\n        if (objs_list[i].options.flip_horizontal) {\n          locationAttr += ' flipH=\"1\"';\n        } // Endif.\n\n        if (objs_list[i].options.rotate) {\n          var rotateVal = objs_list[i].options.rotate > 360 ? objs_list[i].options.rotate - 360 : objs_list[i].options.rotate;\n          rotateVal *= 60000;\n          locationAttr += ' rot=\"' + rotateVal + '\"';\n        } // Endif.\n      } // Endif.\n\n      switch (objs_list[i].type) {\n        // TODO: remove hard code here:\n        case 'table':\n          var table_obj = officeTable.getTable(objs_list[i].data, objs_list[i].options);\n          // console.log(JSON.stringify(table_obj, null, 2))\n          var table_xml = xmlBuilder.create(table_obj, {\n            version: '1.0',\n            encoding: 'UTF-8',\n            standalone: true\n          }).toString({\n            pretty: true,\n            indent: '  ',\n            newline: '\\n'\n          });\n          outString += table_xml;\n          break;\n        case 'chart':\n          // loop through the charts\n          //\n\n          if (objs_list[i].renderType === 'pie') {\n            outString += '<p:graphicFrame><p:nvGraphicFramePr><p:cNvPr id=\"20\" name=\"OfficeChart 19\"/><p:cNvGraphicFramePr/><p:nvPr><p:extLst><p:ext uri=\"{D42A27DB-BD31-4B8C-83A1-F6EECF244321}\"><p14:modId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"4198609065\"/></p:ext></p:extLst></p:nvPr></p:nvGraphicFramePr><p:xfrm><a:off x=\"' + (objs_list[i].options.x || 1524000) + '\" y=\"' + (objs_list[i].options.y || 1397000) + '\"/><a:ext cx=\"' + (objs_list[i].options.cx || 6096000) + '\" cy=\"' + (objs_list[i].options.cy || 4064000) + '\"/></p:xfrm><a:graphic><a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/chart\"><c:chart xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" r:id=\"rId2\"/></a:graphicData></a:graphic></p:graphicFrame>';\n          } else if (objs_list[i].renderType === 'column') {\n            outString += '<p:graphicFrame><p:nvGraphicFramePr><p:cNvPr id=\"4\" name=\"OfficeChart 3\"/><p:cNvGraphicFramePr/><p:nvPr><p:extLst><p:ext uri=\"{D42A27DB-BD31-4B8C-83A1-F6EECF244321}\"><p14:modId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1256887135\"/></p:ext></p:extLst></p:nvPr></p:nvGraphicFramePr><p:xfrm><a:off x=\"' + (objs_list[i].options.x || 1524000) + '\" y=\"' + (objs_list[i].options.y || 1397000) + '\"/><a:ext cx=\"' + (objs_list[i].options.cx || 6096000) + '\" cy=\"' + (objs_list[i].options.cy || 4064000) + '\"/></p:xfrm><a:graphic><a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/chart\"><c:chart xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" r:id=\"rId2\"/></a:graphicData></a:graphic></p:graphicFrame>';\n          } // Endif.\n          break;\n        case 'text':\n        case 'cxn':\n          var effectsList = '';\n          if (shapeType == null) shapeType = getShapeInfo(null);\n\n          // if ( objs_list[i].type == 'text' ) {\n          //   if ( !objs_list[i].options || (!objs_list[i].options.cx && !objs_list[i].options.cx) ) {\n          //     objs_list[i].options = objs_list[i].options ? objs_list[i].options : {}\n          //     objs_list[i].options.bodyProp = objs_list[i].options.bodyProp ? objs_list[i].options.bodyProp : {}\n          //     objs_list[i].options.bodyProp.autoFit = true\n          //     cx = gen_private.type.pptx.pptWidth - x\n          //     cy = gen_private.type.pptx.pptHeight - y\n          //   } // Endif.\n          // } // Endif.\n\n          if (objs_list[i].type === 'cxn') {\n            outString += '<p:cxnSp><p:nvCxnSpPr>';\n            outString += '<p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:nvPr/></p:nvCxnSpPr>';\n          } else {\n            outString += '<p:sp><p:nvSpPr>';\n            outString += '<p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvSpPr txBox=\"1\"/><p:nvPr/></p:nvSpPr>';\n          } // Endif.\n\n          outString += '<p:spPr>';\n          outString += '<a:xfrm' + locationAttr + '>';\n          outString += '<a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm><a:prstGeom prst=\"' + shapeType.name + '\">';\n\n          // string changed to take into account change of shape that you do by moving the little yellow dot\n\n          if (shapeType.avLst !== {}) {\n            outString += '<a:avLst>';\n            for (var adj in shapeType.avLst) {\n              outString += '<a:gd name=\"' + adj + '\" fmla=\"val ' + shapeType.avLst[adj] + '\"/>';\n            }\n          }\n          outString += '</a:avLst></a:prstGeom>';\n          if (objs_list[i].options) {\n            if (objs_list[i].options.fill) {\n              outString += cMakePptxColorSelection(objs_list[i].options.fill);\n            } else {\n              outString += '<a:noFill/>';\n            } // Endif.\n\n            if (objs_list[i].options.line) {\n              var lineAttr = '';\n              if (objs_list[i].options.line_size) {\n                lineAttr += ' w=\"' + objs_list[i].options.line_size * 12700 + '\"';\n              } // Endif.\n\n              // cmpd=\"dbl\"\n\n              outString += '<a:ln' + lineAttr + '>';\n              outString += cMakePptxColorSelection(objs_list[i].options.line);\n              if (objs_list[i].options.line_head) {\n                outString += '<a:headEnd type=\"' + objs_list[i].options.line_head + '\"/>';\n              } // Endif.\n\n              if (objs_list[i].options.line_tail) {\n                outString += '<a:tailEnd type=\"' + objs_list[i].options.line_tail + '\"/>';\n              } // Endif.\n\n              outString += '</a:ln>';\n            } // Endif.\n          } else {\n            outString += '<a:noFill/>';\n          } // Endif.\n\n          if (objs_list[i].options.effects) {\n            for (var ii = 0, total_size_ii = objs_list[i].options.effects.length; ii < total_size_ii; ii++) {\n              switch (objs_list[i].options.effects[ii].type) {\n                case 'outerShadow':\n                  effectsList += cbGenerateEffects(objs_list[i].options.effects[ii], 'outerShdw');\n                  break;\n                case 'innerShadow':\n                  effectsList += cbGenerateEffects(objs_list[i].options.effects[ii], 'innerShdw');\n                  break;\n              } // End of switch.\n            } // End of for loop.\n          } // Endif.\n\n          if (effectsList !== '') {\n            outString += '<a:effectLst>' + effectsList + '</a:effectLst>';\n          } // Endif.\n\n          outString += '</p:spPr>';\n          if (objs_list[i].options) {\n            if (objs_list[i].options.align) {\n              switch (objs_list[i].options.align) {\n                case 'right':\n                  moreStylesAttr += ' algn=\"r\"';\n                  break;\n                case 'center':\n                  moreStylesAttr += ' algn=\"ctr\"';\n                  break;\n                case 'justify':\n                  moreStylesAttr += ' algn=\"just\"';\n                  break;\n              } // End of switch.\n            } // Endif.\n\n            if (objs_list[i].options.indentLevel > 0) {\n              moreStylesAttr += ' lvl=\"' + objs_list[i].options.indentLevel + '\"';\n            } // Endif.\n          } // Endif.\n\n          if (moreStyles !== '') {\n            outStyles = '<a:pPr' + moreStylesAttr + '>' + moreStyles + '</a:pPr>';\n          } else if (moreStylesAttr !== '') {\n            outStyles = '<a:pPr' + moreStylesAttr + '/>';\n          } // Endif.\n\n          if (styleData !== '') {\n            outString += '<p:style>' + styleData + '</p:style>';\n          } // Endif.\n\n          if (typeof objs_list[i].text === 'string') {\n            outString += '<p:txBody>' + createBodyProperties(objs_list[i].options) + '<a:lstStyle/><a:p>' + outStyles;\n            outString += cMakePptxOutTextCommand(objs_list[i].options, objs_list[i].text, data.slide, data.slide.getPageNumber(), outStyles);\n          } else if (typeof objs_list[i].text === 'number') {\n            outString += '<p:txBody>' + createBodyProperties(objs_list[i].options) + '<a:lstStyle/><a:p>' + outStyles;\n            outString += cMakePptxOutTextCommand(objs_list[i].options, objs_list[i].text + '', data.slide, data.slide.getPageNumber(), outStyles);\n          } else if (objs_list[i].text && objs_list[i].text.length) {\n            var outBodyOpt = createBodyProperties(objs_list[i].options);\n            outString += '<p:txBody>' + outBodyOpt + '<a:lstStyle/><a:p>' + outStyles;\n            for (var j = 0, total_size_j = objs_list[i].text.length; j < total_size_j; j++) {\n              if (typeof objs_list[i].text[j] === 'object' && objs_list[i].text[j].text) {\n                outString += cMakePptxOutTextCommand(objs_list[i].text[j].options || objs_list[i].options, objs_list[i].text[j].text, data.slide, outBodyOpt, outStyles, data.slide.getPageNumber());\n              } else if (typeof objs_list[i].text[j] === 'string') {\n                outString += cMakePptxOutTextCommand(objs_list[i].options, objs_list[i].text[j], data.slide, outBodyOpt, outStyles, data.slide.getPageNumber());\n              } else if (typeof objs_list[i].text[j] === 'number') {\n                outString += cMakePptxOutTextCommand(objs_list[i].options, objs_list[i].text[j] + '', data.slide, outBodyOpt, outStyles, data.slide.getPageNumber());\n              } else if (typeof objs_list[i].text[j] === 'object' && objs_list[i].text[j].field) {\n                outString += cMakePptxOutTextCommand(objs_list[i].options, objs_list[i].text[j], data.slide, outBodyOpt, outStyles, data.slide.getPageNumber());\n              } // Endif.\n            } // Endif.\n          } else if (typeof objs_list[i].text === 'object') {\n            if (!objs_list[i].text) {\n              objs_list[i].text = {};\n            } // Endif.\n\n            if (!objs_list[i].text.field) {\n              objs_list[i].text.field = '';\n            } // Endif.\n\n            outString += '<p:txBody>' + createBodyProperties(objs_list[i].options) + '<a:lstStyle/><a:p>' + outStyles;\n            outString += cMakePptxOutTextCommand(objs_list[i].options, objs_list[i].text, data.slide, data.slide.getPageNumber(), outStyles);\n          } // Endif.\n\n          // We must add that at the end of every paragraph with text:\n          if (typeof objs_list[i].text !== 'undefined') {\n            var font_size = '';\n            if (objs_list[i].options && objs_list[i].options.font_size) {\n              font_size = ' sz=\"' + objs_list[i].options.font_size + '00\"';\n            } // Endif.\n\n            outString += '<a:endParaRPr lang=\"en-US\"' + font_size + ' dirty=\"0\"/></a:p></p:txBody>';\n          } // Endif.\n\n          outString += objs_list[i].type === 'cxn' ? '</p:cxnSp>' : '</p:sp>';\n          /* eslint-disable indent */\n          break;\n\n        // Table:\n        /*\n        case 'table':\n          outString += '<p:graphicFrame><p:nvGraphicFramePr><p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvGraphicFramePr><a:graphicFrameLocks noGrp=\"1\"/></p:cNvGraphicFramePr><p:nvPr/></p:nvGraphicFramePr>'\n          outString += '<p:xfrm><a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></p:xfrm>'\n          outString += '<a:graphic><a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/table\"><a:tbl><a:tblPr firstRow=\"1\" bandRow=\"1\"><a:tableStyleId>'\n           if ( objs_list[i].options && objs_list[i].options.tableStyleId ) {\n            outString += objs_list[i].options.tableStyleId\n           } else {\n            outString += '{073A0DAA-6AF3-43AB-8588-CEC1D06C72B9}'\n          } // Endif.\n           outString += '</a:tableStyleId></a:tblPr><a:tblGrid>'\n          // <a:gridCol w=\"3276600\"/>\n          outString += '</a:tblGrid>'\n          // objs_list[i].options\n          // objs_list[i].rows[][].text\n          // BMK_TODO:\n          break\n        */\n        /* eslint-enable indent */\n\n        // Image:\n        case 'image':\n          // psv 2015-01-21 Manually copied this section from https://github.com/Ziv-Barber/officegen/pull/39/files?w=1\n          // outString += '<p:pic><p:nvPicPr><p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr><p:nvPr/></p:nvPicPr><p:blipFill><a:blip r:embed=\"rId' + objs_list[i].rel_id + '\" cstate=\"print\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill><p:spPr><a:xfrm' + locationAttr + '><a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr></p:pic>'\n          var parts = [];\n          parts.push('<p:pic><p:nvPicPr><p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"');\n          if (objs_list[i].link_rel_id) {\n            parts.push('><a:hlinkClick r:id=\"rId' + objs_list[i].link_rel_id + '\"/></p:cNvPr>');\n          } else {\n            parts.push('/>');\n          } // Endif.\n\n          parts.push('<p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr><p:nvPr/></p:nvPicPr><p:blipFill><a:blip r:embed=\"rId' + objs_list[i].rel_id + '\" cstate=\"print\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill><p:spPr><a:xfrm' + locationAttr + '><a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr></p:pic>');\n          outString += parts.join('');\n          // -- psv 2015-01-21 end merge\n          break;\n\n        // Paragraph:\n        case 'p':\n          if (shapeType == null) {\n            shapeType = getShapeInfo(null);\n          } // Endif.\n\n          outString += '<p:sp><p:nvSpPr>';\n          outString += '<p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvSpPr txBox=\"1\"/><p:nvPr/></p:nvSpPr>';\n          outString += '<p:spPr>';\n          outString += '<a:xfrm' + locationAttr + '>';\n          outString += '<a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm><a:prstGeom prst=\"' + shapeType.name + '\"><a:avLst/></a:prstGeom>';\n          if (objs_list[i].options) {\n            if (objs_list[i].options.fill) {\n              outString += cMakePptxColorSelection(objs_list[i].options.fill);\n            } else {\n              outString += '<a:noFill/>';\n            } // Endif.\n\n            if (objs_list[i].options.line) {\n              outString += '<a:ln>';\n              outString += cMakePptxColorSelection(objs_list[i].options.line);\n              if (objs_list[i].options.line_head) {\n                outString += '<a:headEnd type=\"' + objs_list[i].options.line_head + '\"/>';\n              } // Endif.\n\n              if (objs_list[i].options.line_tail) {\n                outString += '<a:tailEnd type=\"' + objs_list[i].options.line_tail + '\"/>';\n              } // Endif.\n\n              outString += '</a:ln>';\n            } // Endif.\n          } else {\n            outString += '<a:noFill/>';\n          } // Endif.\n\n          outString += '</p:spPr>';\n          if (styleData !== '') {\n            outString += '<p:style>' + styleData + '</p:style>';\n          } // Endif.\n\n          outString += '<p:txBody><a:bodyPr wrap=\"square\" rtlCol=\"0\"><a:spAutoFit/></a:bodyPr><a:lstStyle/>';\n\n          // Add all the paragraph objects:\n          outString = cMakePptxOutTextP(outString, objs_list[i].data, objs_list[i].options, data.slide);\n          outString += '</p:txBody>';\n          outString += '</p:sp>';\n          break;\n      } // End of switch.\n    } // End of for loop.\n\n    if (!makeOnlyObjects) {\n      outString += '</p:spTree></p:cSld><p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr>';\n      if (timingData !== '') {\n        outString += '<p:timing>' + timingData + '</p:timing>';\n      } // Endif.\n\n      outString += '</p:sld' + slideElement + '>';\n    } // Endif.\n\n    return outString;\n  }\n\n  /**\n   * Generate the extended attributes file (app) for PPTX/PPSX documents.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxApp(data) {\n    var slidesCount = gen_private.pages.length;\n    var userName = genobj.options.author || genobj.options.creator || 'officegen';\n    var outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) + '<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\"><TotalTime>0</TotalTime><Words>0</Words><Application>Microsoft Office PowerPoint</Application><PresentationFormat>On-screen Show (4:3)</PresentationFormat><Paragraphs>0</Paragraphs><Slides>' + slidesCount + '</Slides><Notes>0</Notes><HiddenSlides>0</HiddenSlides><MMClips>0</MMClips><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size=\"4\" baseType=\"variant\"><vt:variant><vt:lpstr>Theme</vt:lpstr></vt:variant><vt:variant><vt:i4>1</vt:i4></vt:variant><vt:variant><vt:lpstr>Slide Titles</vt:lpstr></vt:variant><vt:variant><vt:i4>' + slidesCount + '</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size=\"' + (slidesCount + 1) + '\" baseType=\"lpstr\"><vt:lpstr>Office Theme</vt:lpstr>';\n    for (var i = 0, total_size = gen_private.pages.length; i < total_size; i++) {\n      outString += '<vt:lpstr>' + encodeHTML(gen_private.pages[i].slide.name) + '</vt:lpstr>';\n    } // End of for loop.\n\n    outString += '</vt:vector></TitlesOfParts><Company>' + userName + '</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>12.0000</AppVersion></Properties>';\n    return outString;\n  }\n\n  /**\n   * Create XML string for a chart description\n   *\n   * @param {object} chartInfo\n   * @return Text Xml string.\n   */\n  function cbMakeCharts(chartInfo) {\n    var chart = new OfficeChart(chartInfo);\n    return chart.toXML();\n  }\n  function cbMakeChartDataExcel(data) {\n    // PSV not sure why this method is here.  Presumably vestigial from earlier code.\n  }\n\n  // Prepare genobj for MS-Office:\n  msdoc.makemsdoc(genobj, new_type, options, gen_private, type_info);\n  gen_private.plugs.type.msoffice.makeOfficeGenerator('ppt', 'presentation', {});\n  gen_private.features.page_name = 'slides'; // This document type must have pages.\n\n  gen_private.plugs.type.msoffice.addInfoType('dc:title', '', 'title', 'setDocTitle');\n  genobj.on('beforeGen', cbPreparePptxToGenerate);\n  var type_of_main_doc = 'slideshow';\n  if (new_type !== 'ppsx') {\n    type_of_main_doc = 'presentation';\n  } // Endif.\n\n  // Create the plugins manager:\n  var plugsmanObj = new docplugman(genobj, gen_private, 'pptx', setDefaultDocValues);\n\n  // We'll register now any specific PowerPoint based plugin that we want to use:\n  plugsmanObj.plugsList.push(new plugWidescreen(plugsmanObj));\n  plugsmanObj.plugsList.push(new plugSpeakernotes(plugsmanObj));\n  plugsmanObj.plugsList.push(new plugLayouts(plugsmanObj));\n  // BMK_PPTX_PLUG:\n\n  // Dynamic loading of additional plugins requested by the user:\n  if (options.extraPlugs && typeof options.extraPlugs === 'object' && options.extraPlugs.forEach) {\n    options.extraPlugs.forEach(function (value) {\n      var newPlug;\n      if (value) {\n        if (typeof value === 'function') {\n          // You already loaded the plugin:\n          newPlug = value;\n        } else if (typeof value === 'string') {\n          // We need to load the plugin:\n          newPlug = require('./' + value);\n        } // Endif.\n      } // Endif.\n\n      plugsmanObj.plugsList.push(new newPlug(plugsmanObj));\n    });\n  } // Endif.\n\n  // Save some methods for the plugins:\n  genobj.cbMakePptxLayout1 = cbMakePptxLayout1;\n  genobj.cbMakePptxSlide = cbMakePptxSlide;\n  genobj.createFieldText = createFieldText;\n  genobj.cMakePptxOutTextP = cMakePptxOutTextP;\n  gen_private.type.msoffice.files_list.push({\n    name: '/ppt/slideMasters/slideMaster1.xml',\n    type: 'application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml',\n    clear: 'type'\n  }, {\n    name: '/ppt/presProps.xml',\n    type: 'application/vnd.openxmlformats-officedocument.presentationml.presProps+xml',\n    clear: 'type'\n  }, {\n    name: '/ppt/presentation.xml',\n    type: 'application/vnd.openxmlformats-officedocument.presentationml.' + type_of_main_doc + '.main+xml',\n    clear: 'type'\n  }, {\n    name: '/ppt/slideLayouts/slideLayout1.xml',\n    type: 'application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml',\n    clear: 'type'\n  }, {\n    name: '/ppt/tableStyles.xml',\n    type: 'application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml',\n    clear: 'type'\n  }, {\n    name: '/ppt/viewProps.xml',\n    type: 'application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml',\n    clear: 'type'\n  });\n  genobj.slideMasterRels = [{\n    type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout',\n    target: '../slideLayouts/slideLayout1.xml'\n  }, {\n    type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\n    target: '../theme/theme1.xml'\n  }];\n  gen_private.plugs.intAddAnyResourceToParse('ppt\\\\presProps.xml', 'buffer', null, cbMakePptxPresProps, true);\n  gen_private.plugs.intAddAnyResourceToParse('ppt\\\\tableStyles.xml', 'buffer', null, cbMakePptxStyles, true);\n  gen_private.plugs.intAddAnyResourceToParse('ppt\\\\viewProps.xml', 'buffer', null, cbMakePptxViewProps, true);\n  gen_private.plugs.intAddAnyResourceToParse('ppt\\\\presentation.xml', 'buffer', null, cbMakePptxPresentation, true);\n  gen_private.plugs.intAddAnyResourceToParse('ppt\\\\slideLayouts\\\\slideLayout1.xml', 'buffer', null, cbMakePptxLayout1, true);\n  gen_private.plugs.intAddAnyResourceToParse('ppt\\\\slideLayouts\\\\_rels\\\\slideLayout1.xml.rels', 'buffer', [{\n    type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster',\n    target: '../slideMasters/slideMaster1.xml'\n  }], gen_private.plugs.type.msoffice.cbMakeRels, true);\n\n  // Slides master:\n  gen_private.plugs.intAddAnyResourceToParse('ppt\\\\slideMasters\\\\slideMaster1.xml', 'buffer', null, cbMakePptxSlideMasters, true);\n  gen_private.plugs.intAddAnyResourceToParse('ppt\\\\slideMasters\\\\_rels\\\\slideMaster1.xml.rels', 'buffer', genobj.slideMasterRels, gen_private.plugs.type.msoffice.cbMakeRels, true);\n  gen_private.plugs.intAddAnyResourceToParse('docProps\\\\app.xml', 'buffer', null, cbMakePptxApp, true);\n  gen_private.type.msoffice.rels_app.push({\n    type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster',\n    target: 'slideMasters/slideMaster1.xml',\n    clear: 'type'\n  });\n  gen_private.plugs.intAddAnyResourceToParse('ppt\\\\_rels\\\\presentation.xml.rels', 'buffer', gen_private.type.msoffice.rels_app, gen_private.plugs.type.msoffice.cbMakeRels, true);\n\n  // ----- API for PowerPoint documents: -----\n\n  /**\n   * Create a new slide.\n   *\n   * This method creating a new slide inside the presentation.\n   *\n   * @param {object} slideOptions Extra options how to create the new slide.\n   * @return The new slide object.\n   */\n  genobj.makeNewSlide = function (slideOptions) {\n    var pageNumber = gen_private.pages.length;\n    var slideObj = {\n      show: true\n    }; // The slide object that the user will use.\n\n    if (!slideOptions || typeof slideOptions !== 'object') {\n      slideOptions = {};\n    } // Endif.\n\n    if (!slideOptions.basedLayout) {\n      slideOptions.basedLayout = 1;\n    } // Endif.\n\n    gen_private.pages[pageNumber] = {};\n    gen_private.pages[pageNumber].slide = slideObj;\n    gen_private.pages[pageNumber].data = [];\n    gen_private.pages[pageNumber].rels = [{\n      type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout',\n      target: '../slideLayouts/slideLayout' + slideOptions.basedLayout + '.xml',\n      clear: 'data'\n    }];\n    gen_private.type.msoffice.files_list.push({\n      name: '/ppt/slides/slide' + (pageNumber + 1) + '.xml',\n      type: 'application/vnd.openxmlformats-officedocument.presentationml.slide+xml',\n      clear: 'data'\n    });\n    gen_private.type.msoffice.rels_app.push({\n      type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide',\n      target: 'slides/slide' + (pageNumber + 1) + '.xml',\n      clear: 'data'\n    });\n    slideObj.getPageNumber = function () {\n      return pageNumber;\n    };\n    slideObj.getRelFile = function () {\n      return gen_private.pages[pageNumber].rels;\n    };\n    slideObj.name = 'Slide ' + (pageNumber + 1);\n\n    /**\n     * ???.\n     *\n     * @param {object} prgObj Paragraph object.\n     */\n    function addParagraphApiForBasicOpt(prgObj) {\n      if (!prgObj.api) {\n        prgObj.api = {};\n      } // Endif.\n\n      prgObj.api.options = prgObj.options;\n    }\n\n    /**\n     * ???.\n     *\n     * @param {object} prgObj Paragraph object.\n     */\n    function addParagraphApiForEffects(prgObj) {\n      if (!prgObj.api) {\n        prgObj.api = {};\n      } // Endif.\n\n      /**\n       * ???.\n       *\n       * @param {object} inType ???.\n       * @param {object} inAlign ???.\n       * @param {object} inColor ???.\n       * @param {object} inTransparency ???.\n       * @param {object} inSize ???.\n       * @param {object} inBlur ???.\n       * @param {object} inAngle ???.\n       * @param {object} inDistance ???.\n       */\n      prgObj.api.setShadowEffect = function (inType, inAlign, inColor, inTransparency, inSize, inBlur, inAngle, inDistance) {\n        if (!prgObj.options.effects) {\n          prgObj.options.effects = [];\n        }\n        var newEffect = {\n          type: inType,\n          align: inAlign,\n          color: inColor,\n          transparency: inTransparency,\n          size: inSize,\n          blur: inBlur,\n          angle: inAngle,\n          distance: inDistance\n        };\n        prgObj.options.effects.push(newEffect);\n      };\n    }\n\n    // Added 2015-01-02 PSV as a way for user to modify chart properties before generating the XML string:\n    slideObj.createChart = function (chartInfo) {\n      return new OfficeChart(chartInfo);\n    };\n\n    // Added 2015-01-08 PSV following model of addChart:\n    slideObj.addTable = function (data, options) {\n      var objNumber = gen_private.pages[pageNumber].data.length;\n      gen_private.pages[pageNumber].data[objNumber] = {\n        type: 'table',\n        data: data,\n        options: options || {} // right now this isn't yet used\n      };\n\n      addParagraphApiForBasicOpt(gen_private.pages[pageNumber].data[objNumber]);\n      addParagraphApiForEffects(gen_private.pages[pageNumber].data[objNumber]);\n      return gen_private.pages[pageNumber].data[objNumber].api;\n    };\n\n    /**\n     * Generate the chart based on input data.\n     *\n     * @param {object} renderType should belong to: 'column', 'pie'\n     * @param {object} data a JSON object with follow the following format\n     *     {\n     *      title: 'eSurvey chart',\n     *      data:  [\n     *        {\n     *          name: 'Income',\n     *          labels: ['2005', '2006', '2007', '2008', '2009'],\n     *          values: [23.5, 26.2, 30.1, 29.5, 24.6]\n     *        },\n     *        {\n     *          name: 'Expense',\n     *          labels: ['2005', '2006', '2007', '2008', '2009'],\n     *          values: [18.1, 22.8, 23.9, 25.1, 25]\n     *        }\n     *      ]\n     *   }\n     * @author vtloc\n     * @date 2014Jan09\n     */\n    slideObj.addChart = function (data, callback, errorCallback) {\n      var objNumber = gen_private.pages[pageNumber].data.length;\n      GLOBAL_CHART_COUNT += 1;\n      gen_private.pages[pageNumber].data[objNumber] = {};\n      gen_private.pages[pageNumber].data[objNumber].type = 'chart';\n      gen_private.pages[pageNumber].data[objNumber].renderType = 'column';\n      gen_private.pages[pageNumber].data[objNumber].title = data['title'];\n      gen_private.pages[pageNumber].data[objNumber].data = data['data'];\n      gen_private.pages[pageNumber].data[objNumber].options = data; // include generic options like x,y,cx,cy, etc.\n      // data['renderType'] = renderType\n\n      // First, generate a temporatory excel file for storing the chart's data\n      var workbook = excelbuilder.createWorkbook(genobj.options.tempDir, 'sample' + GLOBAL_CHART_COUNT + '.xlsx');\n\n      // Create a new worksheet with 10 columns and 12 rows\n      // number of columns: data['data'].length+1 -> equaly number of series\n      // number of rows: data['data'][0].values.length+1\n      var sheet1 = workbook.createSheet('Sheet1', data['data'].length + 1, data['data'][0].values.length + 1);\n      var headerrow = 1;\n\n      // Write header using serie name:\n      for (var j = 0; j < data['data'].length; j++) {\n        sheet1.set(j + 2, headerrow, data['data'][j].name);\n      } // End of for loop.\n\n      // Write category column in the first column:\n      for (j = 0; j < data['data'][0].labels.length; j++) {\n        sheet1.set(1, j + 2, data['data'][0].labels[j]);\n      } // End of for loop.\n\n      // For each serie, write out values in its row:\n      for (var i = 0; i < data['data'].length; i++) {\n        for (j = 0; j < data['data'][i].values.length; j++) {\n          // col i+2\n          // row j+1\n          sheet1.set(i + 2, j + 2, data['data'][i].values[j]);\n        } // End of for loop.\n      } // End of for loop.\n\n      // Fill some data\n      // Save it\n      var localEmbeddingExcelFile = 'ppt\\\\embeddings\\\\Microsoft_Excel_Worksheet' + GLOBAL_CHART_COUNT + '.xlsx';\n      var tmpExcelFile = genobj.options.tempDir + 'sample' + GLOBAL_CHART_COUNT + '.xlsx';\n      // will copy the tmpExcelFile into localEmbeddingExcelFile\n      gen_private.plugs.intAddAnyResourceToParse(localEmbeddingExcelFile, 'file', tmpExcelFile, cbMakeChartDataExcel, false, true);\n      gen_private.plugs.intAddAnyResourceToParse('ppt\\\\charts\\\\chart' + GLOBAL_CHART_COUNT + '.xml', 'buffer', data, cbMakeCharts, true);\n      gen_private.plugs.intAddAnyResourceToParse('ppt\\\\charts\\\\_rels\\\\chart' + GLOBAL_CHART_COUNT + '.xml.rels', 'buffer', [{\n        type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package',\n        target: '../embeddings/Microsoft_Excel_Worksheet' + GLOBAL_CHART_COUNT + '.xlsx'\n      }], gen_private.plugs.type.msoffice.cbMakeRels, true);\n      gen_private.type.msoffice.files_list.push({\n        name: '/ppt/charts/chart' + GLOBAL_CHART_COUNT + '.xml',\n        type: 'application/vnd.openxmlformats-officedocument.drawingml.chart+xml',\n        clear: 'type'\n      }, {\n        name: '/ppt/embeddings/Microsoft_Excel_Worksheet' + GLOBAL_CHART_COUNT + '.xlsx',\n        type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n        ext: 'xlsx',\n        clear: 'type'\n      });\n      gen_private.pages[pageNumber].rels.push({\n        type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart',\n        target: '../charts/chart' + GLOBAL_CHART_COUNT + '.xml',\n        clear: 'data'\n      });\n      workbook.save(function (err) {\n        if (err) {\n          workbook.cancel();\n        } else {\n          callback();\n        }\n      });\n    };\n\n    /**\n     * ???.\n     *\n     * @param {object} text ???.\n     * @param {object} opt ???.\n     * @param {object} y_pos ???.\n     * @param {object} x_size ???.\n     * @param {object} y_size ???.\n     * @param {object} opt_b ???.\n     */\n    slideObj.addText = function (text, opt, y_pos, x_size, y_size, opt_b) {\n      var objNumber = gen_private.pages[pageNumber].data.length;\n      gen_private.pages[pageNumber].data[objNumber] = {};\n      gen_private.pages[pageNumber].data[objNumber].type = 'text';\n      gen_private.pages[pageNumber].data[objNumber].text = text || '';\n      gen_private.pages[pageNumber].data[objNumber].options = typeof opt === 'object' ? opt : {};\n      if (typeof opt === 'string') {\n        gen_private.pages[pageNumber].data[objNumber].options.color = opt;\n      } else if (typeof opt !== 'object' && typeof y_pos !== 'undefined') {\n        gen_private.pages[pageNumber].data[objNumber].options.x = opt;\n        gen_private.pages[pageNumber].data[objNumber].options.y = y_pos;\n        if (typeof x_size !== 'undefined' && typeof y_size !== 'undefined') {\n          gen_private.pages[pageNumber].data[objNumber].options.cx = x_size;\n          gen_private.pages[pageNumber].data[objNumber].options.cy = y_size;\n        } // Endif.\n      } // Endif.\n\n      var attrname;\n      if (typeof opt_b === 'object') {\n        for (attrname in opt_b) {\n          gen_private.pages[pageNumber].data[objNumber].options[attrname] = opt_b[attrname];\n        }\n      } else if (typeof x_size === 'object' && typeof y_size === 'undefined') {\n        for (attrname in x_size) {\n          gen_private.pages[pageNumber].data[objNumber].options[attrname] = x_size[attrname];\n        }\n      } // Endif.\n\n      addParagraphApiForBasicOpt(gen_private.pages[pageNumber].data[objNumber]);\n      addParagraphApiForEffects(gen_private.pages[pageNumber].data[objNumber]);\n      return gen_private.pages[pageNumber].data[objNumber].api;\n    };\n\n    /**\n     * ???\n     *\n     * @param {string} shape ???.\n     * @param {object} opt ???.\n     * @param {number} y_pos ???.\n     * @param {number} x_size ???.\n     * @param {number} y_size ???.\n     * @param {object} opt_b ???.\n     */\n    slideObj.addShape = function (shape, opt, y_pos, x_size, y_size, opt_b) {\n      var objNumber = gen_private.pages[pageNumber].data.length;\n      gen_private.pages[pageNumber].data[objNumber] = {};\n      gen_private.pages[pageNumber].data[objNumber].type = 'text';\n      gen_private.pages[pageNumber].data[objNumber].options = typeof opt === 'object' ? opt : {};\n      gen_private.pages[pageNumber].data[objNumber].options.shape = shape;\n      if (typeof opt === 'string') {\n        gen_private.pages[pageNumber].data[objNumber].options.color = opt;\n      } else if (typeof opt !== 'object' && typeof y_pos !== 'undefined') {\n        gen_private.pages[pageNumber].data[objNumber].options.x = opt;\n        gen_private.pages[pageNumber].data[objNumber].options.y = y_pos;\n        if (typeof x_size !== 'undefined' && typeof y_size !== 'undefined') {\n          gen_private.pages[pageNumber].data[objNumber].options.cx = x_size;\n          gen_private.pages[pageNumber].data[objNumber].options.cy = y_size;\n        } // Endif.\n      } // Endif.\n\n      var attrname;\n      if (typeof opt_b === 'object') {\n        for (attrname in opt_b) {\n          gen_private.pages[pageNumber].data[objNumber].options[attrname] = opt_b[attrname];\n        }\n      } else if (typeof x_size === 'object' && typeof y_size === 'undefined') {\n        for (attrname in x_size) {\n          gen_private.pages[pageNumber].data[objNumber].options[attrname] = x_size[attrname];\n        }\n      } // Endif.\n\n      addParagraphApiForBasicOpt(gen_private.pages[pageNumber].data[objNumber]);\n      addParagraphApiForEffects(gen_private.pages[pageNumber].data[objNumber]);\n      return gen_private.pages[pageNumber].data[objNumber].api;\n    };\n\n    /**\n     * ???.\n     *\n     * @param {object} image_path ???.\n     * @param {object} opt ???.\n     * @param {object} y_pos ???.\n     * @param {object} x_size ???.\n     * @param {object} y_size ???.\n     * @param {object} image_format_type ???.\n     */\n    slideObj.addImage = function (image_path, opt, y_pos, x_size, y_size, image_format_type) {\n      var objNumber = gen_private.pages[pageNumber].data.length;\n      var image_type = typeof image_format_type === 'string' ? image_format_type : 'png';\n      var defWidth;\n      var defHeight = 0;\n      if (typeof image_path === 'string') {\n        var ret_data = fast_image_size(image_path);\n        if (ret_data.type === 'unknown') {\n          var image_ext = path.extname(image_path);\n          switch (image_ext) {\n            case '.bmp':\n              image_type = 'bmp';\n              break;\n            case '.gif':\n              image_type = 'gif';\n              break;\n            case '.jpg':\n            case '.jpeg':\n              image_type = 'jpeg';\n              break;\n            case '.emf':\n              image_type = 'emf';\n              break;\n            case '.tiff':\n              image_type = 'tiff';\n              break;\n          } // End of switch.\n        } else {\n          if (ret_data.width) {\n            defWidth = ret_data.width;\n          } // Endif.\n\n          if (ret_data.height) {\n            defHeight = ret_data.height;\n          } // Endif.\n\n          image_type = ret_data.type;\n          if (image_type === 'jpg') {\n            image_type = 'jpeg';\n          } // Endif.\n        } // Endif.\n      } // Endif.\n\n      gen_private.pages[pageNumber].data[objNumber] = {};\n      gen_private.pages[pageNumber].data[objNumber].type = 'image';\n      gen_private.pages[pageNumber].data[objNumber].image = image_path;\n      gen_private.pages[pageNumber].data[objNumber].options = typeof opt === 'object' ? opt : {};\n      if (!gen_private.pages[pageNumber].data[objNumber].options.cx && defWidth) {\n        gen_private.pages[pageNumber].data[objNumber].options.cx = defWidth;\n      } // Endif.\n\n      if (!gen_private.pages[pageNumber].data[objNumber].options.cy && defHeight) {\n        gen_private.pages[pageNumber].data[objNumber].options.cy = defHeight;\n      } // Endif.\n\n      var image_id = gen_private.type.msoffice.src_files_list.indexOf(image_path);\n      var image_rel_id = -1;\n      if (image_id >= 0) {\n        for (var j = 0, total_size_j = gen_private.pages[pageNumber].rels.length; j < total_size_j; j++) {\n          if (gen_private.pages[pageNumber].rels[j].target === '../media/image' + (image_id + 1) + '.' + image_type) {\n            image_rel_id = j + 1;\n          } // Endif.\n        } // Endif.\n      } else {\n        image_id = gen_private.type.msoffice.src_files_list.length;\n        gen_private.type.msoffice.src_files_list[image_id] = image_path;\n        gen_private.plugs.intAddAnyResourceToParse('ppt\\\\media\\\\image' + (image_id + 1) + '.' + image_type, typeof image_path === 'string' ? 'file' : 'stream', image_path, null, false);\n      } // Endif.\n\n      if (image_rel_id === -1) {\n        image_rel_id = gen_private.pages[pageNumber].rels.length + 1;\n        gen_private.pages[pageNumber].rels.push({\n          type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image',\n          target: '../media/image' + (image_id + 1) + '.' + image_type,\n          clear: 'data'\n        });\n      } // Endif.\n\n      // -- psv 2015-01-21 Manually copied change below from https://github.com/Ziv-Barber/officegen/pull/39/files?w=1\n      if ((opt || {}).link) {\n        var link_rel_id = gen_private.pages[pageNumber].rels.length + 1;\n        gen_private.pages[pageNumber].rels.push({\n          type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink',\n          target: opt.link,\n          targetMode: 'External'\n        });\n        gen_private.pages[pageNumber].data[objNumber].link_rel_id = link_rel_id;\n      } // Endif.\n      // -- psv 2015-01-21 end edits\n\n      gen_private.pages[pageNumber].data[objNumber].image_id = image_id;\n      gen_private.pages[pageNumber].data[objNumber].rel_id = image_rel_id;\n      if (typeof opt === 'string') {\n        gen_private.pages[pageNumber].data[objNumber].options.color = opt;\n      } else if (typeof opt !== 'object' && typeof y_pos !== 'undefined') {\n        gen_private.pages[pageNumber].data[objNumber].options.x = opt;\n        gen_private.pages[pageNumber].data[objNumber].options.y = y_pos;\n        if (typeof x_size !== 'undefined' && typeof y_size !== 'undefined') {\n          gen_private.pages[pageNumber].data[objNumber].options.cx = x_size;\n          gen_private.pages[pageNumber].data[objNumber].options.cy = y_size;\n        } // Endif.\n      } // Endif.\n\n      addParagraphApiForBasicOpt(gen_private.pages[pageNumber].data[objNumber]);\n      addParagraphApiForEffects(gen_private.pages[pageNumber].data[objNumber]);\n      return gen_private.pages[pageNumber].data[objNumber].api;\n    };\n\n    /**\n     * ???.\n     *\n     * @param {object} text ???.\n     * @param {object} opt ???.\n     * @param {object} y_pos ???.\n     * @param {object} x_size ???.\n     * @param {object} y_size ???.\n     * @param {object} opt_b ???.\n     */\n    slideObj.addP = function (text, opt, y_pos, x_size, y_size, opt_b) {\n      var objNumber = gen_private.pages[pageNumber].data.length;\n      gen_private.pages[pageNumber].data[objNumber] = {};\n      gen_private.pages[pageNumber].data[objNumber].type = 'p';\n      gen_private.pages[pageNumber].data[objNumber].data = [];\n      gen_private.pages[pageNumber].data[objNumber].options = typeof opt === 'object' ? opt : {};\n      if (typeof opt === 'string') {\n        gen_private.pages[pageNumber].data[objNumber].options.color = opt;\n      } else if (typeof opt !== 'object' && typeof y_pos !== 'undefined') {\n        gen_private.pages[pageNumber].data[objNumber].options.x = opt;\n        gen_private.pages[pageNumber].data[objNumber].options.y = y_pos;\n        if (typeof x_size !== 'undefined' && typeof y_size !== 'undefined') {\n          gen_private.pages[pageNumber].data[objNumber].options.cx = x_size;\n          gen_private.pages[pageNumber].data[objNumber].options.cy = y_size;\n        } // Endif.\n      } // Endif.\n\n      var attrname;\n      if (typeof opt_b === 'object') {\n        for (attrname in opt_b) {\n          gen_private.pages[pageNumber].data[objNumber].options[attrname] = opt_b[attrname];\n        }\n      } else if (typeof x_size === 'object' && typeof y_size === 'undefined') {\n        for (attrname in x_size) {\n          gen_private.pages[pageNumber].data[objNumber].options[attrname] = x_size[attrname];\n        }\n      } // Endif.\n\n      // BMK_TODO:\n\n      return gen_private.pages[pageNumber].data[objNumber].data;\n    };\n    slideObj.addDateToHeader = function () {\n      if (!gen_private.pages[pageNumber].header) {\n        gen_private.pages[pageNumber].header = {};\n      } // Endif.\n\n      // gen_private.pages[pageNumber]\n      // <a:fld id=\"{5C7A2A3D-B97F-4EB0-B937-FE8C3AFCAC1A}\" type=\"datetime1\">\n      // BMK_TODO:\n    };\n\n    gen_private.plugs.intAddAnyResourceToParse('ppt\\\\slides\\\\slide' + (pageNumber + 1) + '.xml', 'buffer', gen_private.pages[pageNumber], cbMakePptxSlide, false);\n    gen_private.plugs.intAddAnyResourceToParse('ppt\\\\slides\\\\_rels\\\\slide' + (pageNumber + 1) + '.xml.rels', 'buffer', gen_private.pages[pageNumber].rels, gen_private.plugs.type.msoffice.cbMakeRels, false);\n\n    // Signal to the plugins about a new slide:\n    gen_private.features.type.pptx.emitEvent('newPage', {\n      genobj: genobj,\n      page: slideObj,\n      pageData: gen_private.pages[pageNumber],\n      pageNumber: pageNumber,\n      slideOptions: slideOptions\n    });\n    return slideObj;\n  };\n\n  // Tell all the features (plugins) to add extra API:\n  gen_private.features.type.pptx.emitEvent('makeDocApi', genobj);\n  return this;\n}\nbaseobj.plugins.registerDocType('pptx', makePptx, {}, baseobj.docType.PRESENTATION, 'Microsoft PowerPoint Document');\nbaseobj.plugins.registerDocType('ppsx', makePptx, {}, baseobj.docType.PRESENTATION, 'Microsoft PowerPoint Slideshow Document');","map":{"version":3,"names":["baseobj","require","OfficeChart","msdoc","pptxShapes","pptxFields","officeTable","path","fast_image_size","excelbuilder","xmlBuilder","docplugman","plugWidescreen","plugSpeakernotes","plugLayouts","encodeHTML","inStr","replace","GLOBAL_CHART_COUNT","makePptx","genobj","new_type","options","gen_private","type_info","setDefaultDocValues","docpluginman","pptxData","getDataStorage","EMUS_PER_PT","pptWidth","pptHeight","pptType","extraMainRelList","getShapeInfo","shapeName","RECTANGLE","name","displayName","avLst","shapeIntName","shapes","fields","tempDir","cbPreparePptxToGenerate","generate_data","features","type","pptx","emitEvent","msoffice","rels_app","push","target","clear","relsList","forEach","value","cbMakePptxPresProps","data","plugs","cbMakeMsOfficeBasicXml","cbMakePptxStyles","cbMakePptxViewProps","cbMakePptxLayout1","ph1","slide","length","cMakePptxOutTextP","ph2","ph3","createFieldText","useDate","footFull","ft","curElNum","isDate","isRealSlide","isFooter","isSlideNum","cbMakePptxPresentation","outString","dataToPlugs","i","total_size","pages","curPos","cbMakePptxSlideMasters","outData","curRelId","curId","getDocData","plugsmanObj","slideLayouts","item","relIdMaster","cMakePptxColorSelection","color_info","back_info","outText","colorVal","fillType","internalElements","color","alpha","Math","round","position","angle","field_name","slide_num","curDateTime","Date","dayInWeek","monthsList","monthsShortList","outValue","getMonth","getDate","getFullYear","getDay","getHours","getMinutes","getSeconds","cMakePptxOutTextData","text_info","slide_obj","out_obj","font_size","bold","italic","strike","underline","rpr_info","char_spacing","baseline","font_face","cMakePptxOutTextCommand","text_string","out_styles","area_opt_data","textStyles","reduce","acc","attr","parsedText","startInfo","endTag","field","outTextField","fieldIntName","makeUniqueID","split","outTextData","total_size_i","outBreakP","breakLine","pData","pOptions","slideObj","outStyles","moreStylesAttr","moreStyles","j","total_size_j","align","indentLevel","listType","text","getPageNumber","parseSmartNumber","in_data_val","max_value","def_value","auto_val","mul_val","isNaN","parseInt","realNum","realVal","realMax","indexOf","realAuto","cbGenerateEffects","effectData","effectName","alphaPer","algnData","blurRad","dist","dir","transparency","top","bottom","left","right","createBodyProperties","objOptions","bodyProperties","bodyProp","anchor","anchorCtr","wrap","bIns","lIns","rIns","tIns","autoFit","cbMakePptxSlide","makeOnlyObjects","objs_list","timingData","useLayout","mkResCb","slideElement","layoutName","slideElementA","show","back","x","y","cx","cy","styleData","shapeType","locationAttr","shape","flip_vertical","flip_horizontal","rotate","rotateVal","table_obj","getTable","table_xml","create","version","encoding","standalone","toString","pretty","indent","newline","renderType","effectsList","adj","fill","line","lineAttr","line_size","line_head","line_tail","effects","ii","total_size_ii","outBodyOpt","parts","link_rel_id","rel_id","join","cbMakePptxApp","slidesCount","userName","author","creator","cbMakeCharts","chartInfo","chart","toXML","cbMakeChartDataExcel","makemsdoc","makeOfficeGenerator","page_name","addInfoType","on","type_of_main_doc","plugsList","extraPlugs","newPlug","files_list","slideMasterRels","intAddAnyResourceToParse","cbMakeRels","makeNewSlide","slideOptions","pageNumber","basedLayout","rels","getRelFile","addParagraphApiForBasicOpt","prgObj","api","addParagraphApiForEffects","setShadowEffect","inType","inAlign","inColor","inTransparency","inSize","inBlur","inAngle","inDistance","newEffect","size","blur","distance","createChart","addTable","objNumber","addChart","callback","errorCallback","title","workbook","createWorkbook","sheet1","createSheet","values","headerrow","set","labels","localEmbeddingExcelFile","tmpExcelFile","ext","save","err","cancel","addText","opt","y_pos","x_size","y_size","opt_b","attrname","addShape","addImage","image_path","image_format_type","image_type","defWidth","defHeight","ret_data","image_ext","extname","width","height","image","image_id","src_files_list","image_rel_id","link","targetMode","addP","addDateToHeader","header","page","pageData","plugins","registerDocType","docType","PRESENTATION"],"sources":["/Users/abc/Downloads/Workspace/c2i/image-text/c2i-convert/node_modules/officegen/lib/genpptx.js"],"sourcesContent":["//\n// officegen: All the code to generate PPTX/PPTS files.\n//\n// Please refer to README.md for this module's documentations.\n//\n// Copyright (c) 2013 Ziv Barber;\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n//\n\n/**\n * Basicgen plugin to create pptx files (Microsoft PowerPoint).\n */\n\nvar baseobj = require('./basicgen.js')\nvar OfficeChart = require('./officechart.js')\nvar msdoc = require('./msofficegen.js')\nvar pptxShapes = require('./pptxshapes.js')\nvar pptxFields = require('./pptxfields.js')\nvar officeTable = require('./genofficetable')\nvar path = require('path')\nvar fast_image_size = require('fast-image-size')\nvar excelbuilder = require('./msexcel-builder.js')\nvar xmlBuilder = require('xmlbuilder')\nvar docplugman = require('./docplug')\n\n// Officegen pptx plugins:\nvar plugWidescreen = require('./pptxplg-widescreen')\nvar plugSpeakernotes = require('./pptxplg-speakernotes')\nvar plugLayouts = require('./pptxplg-layouts')\n// BMK_PPTX_PLUG:\n\nfunction encodeHTML(inStr) {\n  return inStr\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n}\n\nvar GLOBAL_CHART_COUNT = 0\n\n/**\n * Extend officegen object with PPTX/PPSX support.\n *\n * This method extending the given officegen object to create PPTX/PPSX document.\n *\n * @param {object} genobj The object to extend.\n * @param {string} new_type The type of object to create.\n * @param {object} options The object's options.\n * @param {object} gen_private Access to the internals of this object.\n * @param {object} type_info Additional information about this type.\n * @constructor\n * @name makePptx\n */\nfunction makePptx(genobj, new_type, options, gen_private, type_info) {\n  /**\n   * Prepare the default data.\n   * @param {object} docpluginman Access to the document plugins manager.\n   */\n  function setDefaultDocValues(docpluginman) {\n    var pptxData = docpluginman.getDataStorage()\n\n    // Please put any setting that API can override here:\n    pptxData.EMUS_PER_PT = 12700\n    pptxData.pptWidth = 720 * pptxData.EMUS_PER_PT\n    pptxData.pptHeight = 540 * pptxData.EMUS_PER_PT\n    pptxData.pptType = 'screen4x3'\n\n    // Rels im the main rels file that depended on the data and must be added after the slides:\n    pptxData.extraMainRelList = []\n  }\n\n  /**\n   * Convert shape name to shape information.\n   *\n   * This method convert the shape information reseived from the user to the real shape information object.\n   *\n   * @param {object} shapeName Either the name of the shape or the shape information.\n   * @return Information about this shape.\n   */\n  function getShapeInfo(shapeName) {\n    if (!shapeName) {\n      return pptxShapes.RECTANGLE\n    } // Endif.\n\n    if (\n      typeof shapeName === 'object' &&\n      shapeName.name &&\n      shapeName.displayName &&\n      shapeName.avLst\n    ) {\n      return shapeName\n    } // Endif.\n\n    if (pptxShapes[shapeName]) {\n      return pptxShapes[shapeName]\n    } // Endif.\n\n    for (var shapeIntName in pptxShapes) {\n      if (pptxShapes[shapeIntName].name === shapeName) {\n        return pptxShapes[shapeIntName]\n      } // Endif.\n\n      if (pptxShapes[shapeIntName].displayName === shapeName) {\n        return pptxShapes[shapeIntName]\n      } // Endif.\n    } // End of for loop.\n\n    return pptxShapes.RECTANGLE\n  }\n\n  genobj.shapes = pptxShapes\n  genobj.fields = pptxFields\n  genobj.options = options && typeof options === 'object' ? options : {}\n\n  // Temporary, I'll create a new code without the need to create a temp file (Ziv Barber, 2016-06-23):\n  if (!genobj.options.tempDir) {\n    genobj.options.tempDir = './'\n  } // Endif.\n\n  /**\n   * Prepare everything to generate PPTX files.\n   *\n   * This method checking for extra resources needed to add by the generator engine.\n   */\n  function cbPreparePptxToGenerate() {\n    genobj.generate_data = {}\n\n    // Tell all the features (plugins) that we are about to generate a new document zip:\n    gen_private.features.type.pptx.emitEvent('beforeGen', genobj)\n\n    // Allow some plugins to do more stuff after all the plugins added their data:\n    gen_private.features.type.pptx.emitEvent('beforeGenFinal', genobj)\n\n    // Apple Keynote requires these added *after* all slides:\n    gen_private.type.msoffice.rels_app.push(\n      {\n        type:\n          'http://schemas.openxmlformats.org/officeDocument/2006/relationships/presProps',\n        target: 'presProps.xml',\n        clear: 'type'\n      },\n      {\n        type:\n          'http://schemas.openxmlformats.org/officeDocument/2006/relationships/viewProps',\n        target: 'viewProps.xml',\n        clear: 'type'\n      },\n      {\n        type:\n          'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\n        target: 'theme/theme1.xml',\n        clear: 'type'\n      }\n    )\n\n    // This event allow the plugins to add permanent rels that must be at the end:\n    var extraMainRelList = []\n    gen_private.features.type.pptx.emitEvent('addMainRels', {\n      genobj: genobj,\n      relsList: extraMainRelList\n    })\n    extraMainRelList.forEach(function(value) {\n      gen_private.type.msoffice.rels_app.push(value)\n    })\n\n    // Add any extra rels needed by the plugins and depended on the data:\n    if (\n      gen_private.type.pptx.extraMainRelList &&\n      typeof gen_private.type.pptx.extraMainRelList === 'object' &&\n      gen_private.type.pptx.extraMainRelList.forEach\n    ) {\n      gen_private.type.pptx.extraMainRelList.forEach(function(value) {\n        gen_private.type.msoffice.rels_app.push(value)\n      })\n    }\n\n    gen_private.type.msoffice.rels_app.push({\n      type:\n        'http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles',\n      target: 'tableStyles.xml',\n      clear: 'type'\n    })\n  }\n\n  /**\n   * Create the 'presProps.xml' resource.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxPresProps(data) {\n    return (\n      gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) +\n      '<p:presentationPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"><p:extLst><p:ext uri=\"{E76CE94A-603C-4142-B9EB-6D1370010A27}\"><p14:discardImageEditData xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"0\"/></p:ext><p:ext uri=\"{D31A062A-798A-4329-ABDD-BBA856620510}\"><p14:defaultImageDpi xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"220\"/></p:ext><p:ext uri=\"{FD5EFAAD-0ECE-453E-9831-46B23BE46B34}\"><p15:chartTrackingRefBased xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\" val=\"1\"/></p:ext></p:extLst></p:presentationPr>'\n    )\n  }\n\n  /**\n   * Create the 'tableStyles.xml' resource.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxStyles(data) {\n    return (\n      gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) +\n      '<a:tblStyleLst xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" def=\"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}\"/>'\n    )\n  }\n\n  /**\n   * Create the 'viewProps.xml' resource.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxViewProps(data) {\n    return (\n      gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) +\n      '<p:viewPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"><p:normalViewPr><p:restoredLeft sz=\"15620\"/><p:restoredTop sz=\"94660\"/></p:normalViewPr><p:slideViewPr><p:cSldViewPr><p:cViewPr varScale=\"1\"><p:scale><a:sx n=\"64\" d=\"100\"/><a:sy n=\"64\" d=\"100\"/></p:scale><p:origin x=\"-1392\" y=\"-96\"/></p:cViewPr><p:guideLst><p:guide orient=\"horz\" pos=\"2160\"/><p:guide pos=\"2880\"/></p:guideLst></p:cSldViewPr></p:slideViewPr><p:notesTextViewPr><p:cViewPr><p:scale><a:sx n=\"100\" d=\"100\"/><a:sy n=\"100\" d=\"100\"/></p:scale><p:origin x=\"0\" y=\"0\"/></p:cViewPr></p:notesTextViewPr><p:gridSpacing cx=\"78028800\" cy=\"78028800\"/></p:viewPr>'\n    )\n  }\n\n  /**\n   * Create the 'slideLayout1.xml' resource.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxLayout1(data) {\n    if (!data || typeof data !== 'object') {\n      data = {}\n    } // Endif.\n\n    // You can place here the title:\n    var ph1 =\n      '<a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p>'\n    if (data.ph1 && data.slide && data.ph1.length) {\n      ph1 = cMakePptxOutTextP('', data.ph1, {}, data.slide)\n    } // Endif.\n\n    // The sub-title:\n    var ph2 =\n      '<a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master subtitle style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p>'\n    if (data.ph2 && data.slide && data.ph2.length) {\n      ph2 = cMakePptxOutTextP('', data.ph2, {}, data.slide)\n    } // Endif.\n\n    var ph3 = createFieldText('DATE_TIME', 1, data.useDate)\n\n    var footFull = ''\n    var ft = ''\n    var curElNum = 4\n\n    if (data.isDate || !data.isRealSlide) {\n      footFull +=\n        '<p:sp><p:nvSpPr><p:cNvPr id=\"' +\n        curElNum +\n        '\" name=\"Date Placeholder 3\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"dt\" sz=\"half\" idx=\"10\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:fld id=\"{F8166F1F-CE9B-4651-A6AA-CD717754106B}\" type=\"datetimeFigureOut\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>' +\n        ph3 +\n        '</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp>'\n      curElNum++\n    } // Endif.\n\n    if (data.isFooter && data.ft && data.slide && data.ft.length) {\n      ft = cMakePptxOutTextP('', data.ft, {}, data.slide)\n      footFull +=\n        '<p:sp><p:nvSpPr><p:cNvPr id=\"' +\n        curElNum +\n        '\" name=\"Footer Placeholder 4\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ftr\" sz=\"quarter\" idx=\"11\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/>' +\n        ft +\n        '</p:txBody></p:sp>'\n      curElNum++\n    } else if (!data.isRealSlide) {\n      footFull +=\n        '<p:sp><p:nvSpPr><p:cNvPr id=\"' +\n        curElNum +\n        '\" name=\"Footer Placeholder 4\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ftr\" sz=\"quarter\" idx=\"11\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp>'\n      curElNum++\n    } // Endif.\n\n    if (data.isSlideNum || !data.isRealSlide) {\n      footFull +=\n        '<p:sp><p:nvSpPr><p:cNvPr id=\"' +\n        curElNum +\n        '\" name=\"Slide Number Placeholder 5\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"12\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:fld id=\"{B1393E5F-521B-4CAD-9D3A-AE923D912DCE}\" type=\"slidenum\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>‹#›</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp>'\n      curElNum++\n    } // Endif.\n\n    return (\n      gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) +\n      '<p:sld' +\n      (data.isRealSlide ? '' : 'Layout') +\n      ' xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"' +\n      (data.isRealSlide ? '' : ' type=\"title\" preserve=\"1\"') +\n      '><p:cSld name=\"Title Slide\"><p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id=\"2\" name=\"Title 1\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ctrTitle\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"685800\" y=\"2130425\"/><a:ext cx=\"7772400\" cy=\"1470025\"/></a:xfrm></p:spPr><p:txBody><a:bodyPr/><a:lstStyle/>' +\n      ph1 +\n      '</p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"3\" name=\"Subtitle 2\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"subTitle\" idx=\"1\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"1371600\" y=\"3886200\"/><a:ext cx=\"6400800\" cy=\"1752600\"/></a:xfrm></p:spPr><p:txBody><a:bodyPr/><a:lstStyle><a:lvl1pPr marL=\"0\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"457200\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"914400\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"1371600\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"1828800\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"2286000\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"2743200\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"3200400\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"3657600\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle>' +\n      ph2 +\n      '</p:txBody></p:sp>' +\n      footFull +\n      '</p:spTree></p:cSld><p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr></p:sld' +\n      (data.isRealSlide ? '' : 'Layout') +\n      '>'\n    )\n  }\n\n  /**\n   * Create the main presentation resource.\n   *\n   * This resource is the main resource of any PowerPoint document.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxPresentation(data) {\n    var outString =\n      gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) +\n      '<p:presentation xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" saveSubsetFonts=\"1\"><p:sldMasterIdLst><p:sldMasterId id=\"2147483648\" r:id=\"rId1\"/></p:sldMasterIdLst>'\n\n    // Signal to the plugins to add any extra xml needed for this file:\n    var dataToPlugs = {\n      data: outString\n    }\n    gen_private.features.type.pptx.emitEvent('presentationGen', dataToPlugs)\n\n    outString = dataToPlugs.data + '<p:sldIdLst>'\n\n    for (\n      var i = 0, total_size = gen_private.pages.length;\n      i < total_size;\n      i++\n    ) {\n      outString += '<p:sldId id=\"' + (i + 256) + '\" r:id=\"rId' + (i + 2) + '\"/>'\n    } // End of for loop.\n\n    outString +=\n      '</p:sldIdLst><p:sldSz cx=\"' +\n      gen_private.type.pptx.pptWidth +\n      '\" cy=\"' +\n      gen_private.type.pptx.pptHeight +\n      '\" type=\"' +\n      gen_private.type.pptx.pptType +\n      '\"/><p:notesSz cx=\"' +\n      gen_private.type.pptx.pptHeight +\n      '\" cy=\"' +\n      gen_private.type.pptx.pptWidth +\n      '\"/><p:defaultTextStyle><a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr>'\n\n    var curPos = 0\n    for (i = 1; i < 10; i++) {\n      outString +=\n        '<a:lvl' +\n        i +\n        'pPr marL=\"' +\n        curPos +\n        '\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl' +\n        i +\n        'pPr>'\n      curPos += 457200\n    } // End of for loop.\n\n    outString += '</p:defaultTextStyle>'\n\n    outString +=\n      '<p:extLst><p:ext uri=\"{EFAFB233-063F-42B5-8137-9DF3F51BA10A}\"><p15:sldGuideLst xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\"/></p:ext></p:extLst></p:presentation>'\n\n    return outString\n  }\n\n  /**\n   * Create the slides masters resource.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxSlideMasters(data) {\n    var outData =\n      gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) +\n      '<p:sldMaster xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"><p:cSld><p:bg><p:bgRef idx=\"1001\"><a:schemeClr val=\"bg1\"/></p:bgRef></p:bg><p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id=\"2\" name=\"Title Placeholder 1\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"title\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"274638\"/><a:ext cx=\"8229600\" cy=\"1143000\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"><a:normAutofit/></a:bodyPr><a:lstStyle/><a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"3\" name=\"Text Placeholder 2\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"body\" idx=\"1\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"1600200\"/><a:ext cx=\"8229600\" cy=\"4525963\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\"><a:normAutofit/></a:bodyPr><a:lstStyle/><a:p><a:pPr lvl=\"0\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl=\"1\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl=\"2\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl=\"3\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl=\"4\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Fifth level</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"4\" name=\"Date Placeholder 3\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"dt\" sz=\"half\" idx=\"2\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"6356350\"/><a:ext cx=\"2133600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"l\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\"{F8166F1F-CE9B-4651-A6AA-CD717754106B}\" type=\"datetimeFigureOut\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>6/13/2013</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"5\" name=\"Footer Placeholder 4\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ftr\" sz=\"quarter\" idx=\"3\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"3124200\" y=\"6356350\"/><a:ext cx=\"2895600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"ctr\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"6\" name=\"Slide Number Placeholder 5\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"4\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"6553200\" y=\"6356350\"/><a:ext cx=\"2133600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"r\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\"{F7021451-1387-4CA6-816F-3879F97B5CBC}\" type=\"slidenum\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>�#�</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp></p:spTree></p:cSld><p:clrMap bg1=\"lt1\" tx1=\"dk1\" bg2=\"lt2\" tx2=\"dk2\" accent1=\"accent1\" accent2=\"accent2\" accent3=\"accent3\" accent4=\"accent4\" accent5=\"accent5\" accent6=\"accent6\" hlink=\"hlink\" folHlink=\"folHlink\"/><p:sldLayoutIdLst>'\n    var curRelId = 1\n    var curId = 2147483649\n    var getDocData = plugsmanObj.getDataStorage()\n\n    // Add all the slide layouts needed:\n    outData += '<p:sldLayoutId id=\"' + curId + '\" r:id=\"rId' + curRelId + '\"/>'\n    curRelId++\n    curId++\n    if (\n      getDocData.slideLayouts &&\n      typeof getDocData.slideLayouts === 'object'\n    ) {\n      for (var item in getDocData.slideLayouts) {\n        if (getDocData.slideLayouts[item]) {\n          outData +=\n            '<p:sldLayoutId id=\"' +\n            curId +\n            '\" r:id=\"rId' +\n            getDocData.slideLayouts[item].relIdMaster +\n            '\"/>'\n          curRelId++\n          curId++\n        } // Endif.\n      } // End of for loop.\n    } // Endif.\n\n    outData +=\n      '</p:sldLayoutIdLst><p:txStyles><p:titleStyle><a:lvl1pPr algn=\"ctr\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"0\"/></a:spcBef><a:buNone/><a:defRPr sz=\"4400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mj-lt\"/><a:ea typeface=\"+mj-ea\"/><a:cs typeface=\"+mj-cs\"/></a:defRPr></a:lvl1pPr></p:titleStyle><p:bodyStyle><a:lvl1pPr marL=\"342900\" indent=\"-342900\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"3200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"742950\" indent=\"-285750\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"1143000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"1600200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"2057400\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"2514600\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"2971800\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"3429000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"3886200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr></p:bodyStyle><p:otherStyle><a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr><a:lvl1pPr marL=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"457200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"914400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"1371600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"1828800\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"2286000\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"2743200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"3200400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"3657600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr></p:otherStyle></p:txStyles></p:sldMaster>'\n    return outData\n  }\n\n  /**\n   * Generate the XML code to describe colors.\n   *\n   * @param {object} color_info Foreground color information.\n   * @param {object} back_info Background color information.\n   */\n  function cMakePptxColorSelection(color_info, back_info) {\n    var outText = ''\n    var colorVal\n    var fillType = 'solid'\n    var internalElements = ''\n\n    if (back_info) {\n      outText += '<p:bg><p:bgPr>'\n\n      outText += cMakePptxColorSelection(back_info, false)\n\n      outText += '<a:effectLst/>'\n      // BMK_TODO: (add support for effects)\n\n      outText += '</p:bgPr></p:bg>'\n    } // Endif.\n\n    if (color_info) {\n      if (typeof color_info === 'string') {\n        colorVal = color_info\n      } else {\n        if (color_info.type) {\n          fillType = color_info.type\n        } // Endif.\n\n        if (color_info.color) {\n          colorVal = color_info.color\n        } // Endif.\n\n        if (color_info.alpha) {\n          internalElements +=\n            '<a:alpha val=\"' + (100 - color_info.alpha) + '000\"/>'\n        } // Endif.\n      } // Endif.\n\n      switch (fillType) {\n        case 'solid':\n          outText +=\n            '<a:solidFill><a:srgbClr val=\"' +\n            colorVal +\n            '\">' +\n            internalElements +\n            '</a:srgbClr></a:solidFill>'\n          break\n\n        case 'gradient':\n          outText += '<a:gradFill flip=\"none\" rotWithShape=\"1\"><a:gsLst>'\n\n          for (var item in colorVal) {\n            if (typeof colorVal[item] === 'string') {\n              // Positions are inverted because they start with 100000:\n              outText +=\n                '<a:gs pos=\"' +\n                (100000 - Math.round((100000 / (colorVal.length - 1)) * item)) +\n                '\"><a:srgbClr val=\"' +\n                colorVal[item] +\n                '\">' +\n                internalElements +\n                '</a:srgbClr></a:gs>'\n            } else {\n              outText +=\n                '<a:gs pos=\"' +\n                colorVal[item].position * 1000 +\n                '\"><a:srgbClr val=\"' +\n                colorVal[item].color +\n                '\">' +\n                internalElements +\n                '</a:srgbClr></a:gs>'\n            } // Endif.\n          } // End of for loop.\n\n          if (typeof color_info.angle !== 'undefined') {\n            outText +=\n              '</a:gsLst><a:lin ang=\"' +\n              color_info.angle * 100000 +\n              '\" scaled=\"1\"/><a:tileRect/></a:gradFill>'\n          } else {\n            outText +=\n              '</a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"100000\" t=\"100000\"/></a:path><a:tileRect r=\"-100000\" b=\"-100000\"/></a:gradFill>'\n          } // Endif.\n          break\n      } // End of switch.\n    } // Endif.\n\n    return outText\n  }\n\n  /**\n   * Translate field_name into the text real value.\n   *\n   * This method creating the text to display for the given field.\n   *\n   * @param {string} field_name the name of the field.\n   * @param {number} slide_num current slide number.\n   * @param {Date} useDate Optional date to use instead of the current date.\n   * @return The text string data.\n   */\n  function createFieldText(field_name, slide_num, useDate) {\n    var curDateTime = useDate ? new Date(useDate) : new Date()\n    var dayInWeek = [\n      'Sunday',\n      'Monday',\n      'Tuesday',\n      'Wednesday',\n      'Thursday',\n      'Friday',\n      'Saturday'\n    ]\n    var monthsList = [\n      'January',\n      'February',\n      'March',\n      'April',\n      'May',\n      'June',\n      'July',\n      'August',\n      'September',\n      'October',\n      'November',\n      'December'\n    ]\n    var monthsShortList = [\n      'Jan',\n      'Feb',\n      'Mar',\n      'Apr',\n      'May',\n      'Jun',\n      'Jul',\n      'Aug',\n      'Sep',\n      'Oct',\n      'Nov',\n      'Dec'\n    ]\n    var outValue = ''\n\n    // curDateTime.getDate ()   Returns the day of the month (from 1-31)\n    // curDateTime.getDay ()   Returns the day of the week (from 0-6)\n    // curDateTime.getFullYear ()   Returns the year (four digits)\n    // curDateTime.getHours ()   Returns the hour (from 0-23)\n    // curDateTime.getMinutes ()   Returns the minutes (from 0-59)\n    // curDateTime.getMonth ()   Returns the month (from 0-11)\n    // curDateTime.getSeconds ()   Returns the seconds (from 0-59)\n\n    switch (field_name) {\n      // presentation slide number:\n      case 'SLIDE_NUM':\n      case 'slidenum':\n        outValue += slide_num\n        break\n\n      // default date time format for the rendering application:\n      case 'DATE_TIME':\n      case 'datetime':\n        outValue +=\n          curDateTime.getMonth() +\n          1 +\n          '/' +\n          curDateTime.getDate() +\n          '/' +\n          curDateTime.getFullYear()\n        break\n\n      // MM/DD/YYYY date time format (Example: 10/12/2007):\n      case 'DATE_MM_DD_YYYY':\n      case 'datetime1':\n        outValue +=\n          curDateTime.getMonth() +\n          1 +\n          '/' +\n          curDateTime.getDate() +\n          '/' +\n          curDateTime.getFullYear()\n        break\n\n      // Day, Month DD, YYYY date time format (Example: Friday, October 12, 2007):\n      case 'DATE_WD_MN_DD_YYYY':\n      case 'datetime2':\n        outValue +=\n          dayInWeek[curDateTime.getDay()] +\n          ', ' +\n          monthsList[curDateTime.getMonth()] +\n          ' ' +\n          curDateTime.getDate() +\n          ', ' +\n          curDateTime.getFullYear()\n        break\n\n      // DD Month YYYY date time format (Example: 12 October 2007):\n      case 'DATE_DD_MN_YYYY':\n      case 'datetime3':\n        outValue +=\n          curDateTime.getDate() +\n          ' ' +\n          monthsList[curDateTime.getMonth()] +\n          ' ' +\n          curDateTime.getFullYear()\n        break\n\n      // Month DD, YYYY date time format (Example: October 12, 2007):\n      case 'DATE_MN_DD_YYYY':\n      case 'datetime4':\n        outValue +=\n          monthsList[curDateTime.getMonth()] +\n          ' ' +\n          curDateTime.getDate() +\n          ', ' +\n          curDateTime.getFullYear()\n        break\n\n      // DD-Mon-YY date time format (Example: 12-Oct-07):\n      case 'DATE_DD_SMN_YY':\n      case 'datetime5':\n        outValue +=\n          curDateTime.getDate() +\n          '-' +\n          monthsShortList[curDateTime.getMonth()] +\n          '-' +\n          (curDateTime.getFullYear() % 100)\n        break\n\n      // Month YY date time format (Example: October 07):\n      case 'DATE_MM_YY':\n      case 'datetime6':\n        outValue +=\n          monthsList[curDateTime.getMonth()] +\n          ' ' +\n          (curDateTime.getFullYear() % 100)\n        break\n\n      // Mon-YY date time format (Example: Oct-07):\n      case 'DATE_SMN_YY':\n      case 'datetime7':\n        outValue +=\n          monthsShortList[curDateTime.getMonth()] +\n          '-' +\n          (curDateTime.getFullYear() % 100)\n        break\n\n      // MM/DD/YYYY hh:mm AM/PM date time format (Example: 10/12/2007 4:28 PM):\n      case 'DATE_TIME_DD_MM_YYYY_HH_MM_PM':\n      case 'datetime8':\n        outValue +=\n          curDateTime.getMonth() +\n          '/' +\n          curDateTime.getDate() +\n          '/' +\n          curDateTime.getFullYear()\n        outValue +=\n          (curDateTime.getHours() % 12) + ':' + curDateTime.getMinutes()\n        outValue += curDateTime.getHours() > 11 ? ' PM' : ' AM'\n        break\n\n      // MM/DD/YYYY hh:mm:ss AM/PM date time format (Example: 10/12/2007 4:28:34 PM):\n      case 'DATE_TIME_DD_MM_YYYY_HH_MM_SC_PM':\n      case 'datetime9':\n        outValue +=\n          curDateTime.getMonth() +\n          '/' +\n          curDateTime.getDate() +\n          '/' +\n          curDateTime.getFullYear()\n        outValue +=\n          (curDateTime.getHours() % 12) +\n          ':' +\n          curDateTime.getMinutes() +\n          ':' +\n          curDateTime.getSeconds()\n        outValue += curDateTime.getHours() > 11 ? ' PM' : ' AM'\n        break\n\n      // hh:mm date time format (Example: 16:28):\n      case 'TIME_HH_MM':\n      case 'datetime10':\n        outValue += curDateTime.getHours() + ':' + curDateTime.getMinutes()\n        break\n\n      // hh:mm:ss date time format (Example: 16:28:34):\n      case 'TIME_HH_MM_SC':\n      case 'datetime11':\n        outValue +=\n          curDateTime.getHours() +\n          ':' +\n          curDateTime.getMinutes() +\n          ':' +\n          curDateTime.getSeconds()\n        break\n\n      // hh:mm AM/PM date time format (Example: 4:28 PM):\n      case 'TIME_HH_MM_PM':\n      case 'datetime12':\n        outValue +=\n          (curDateTime.getHours() % 12) + ':' + curDateTime.getMinutes()\n        outValue += curDateTime.getHours() > 11 ? ' PM' : ' AM'\n        break\n\n      // hh:mm:ss: AM/PM date time format (Example: 4:28:34 PM):\n      case 'TIME_HH_MM_SC_PM':\n      case 'datetime13':\n        outValue +=\n          (curDateTime.getHours() % 12) +\n          ':' +\n          curDateTime.getMinutes() +\n          ':' +\n          curDateTime.getSeconds()\n        outValue += curDateTime.getHours() > 11 ? ' PM' : ' AM'\n        break\n\n      default:\n        return null\n    } // End of switch.\n\n    return outValue\n  }\n\n  /**\n   * ???.\n   *\n   * @param {object} text_info Information how to display the text.\n   * @param {object} slide_obj The object of this slider.\n   * @return Text string.\n   */\n  function cMakePptxOutTextData(text_info, slide_obj) {\n    var out_obj = {}\n\n    out_obj.font_size = ''\n    out_obj.bold = ''\n    out_obj.italic = ''\n    out_obj.strike = ''\n    out_obj.underline = ''\n    out_obj.rpr_info = ''\n    out_obj.char_spacing = ''\n    out_obj.baseline = ''\n\n    if (typeof text_info === 'object') {\n      if (text_info.bold) {\n        out_obj.bold = ' b=\"1\"'\n      } // Endif.\n\n      if (text_info.italic) {\n        out_obj.italic = ' i=\"1\"'\n      } // Endif.\n\n      if (text_info.strike) {\n        out_obj.strike = ' strike=\"sngStrike\"'\n      } // Endif.\n\n      if (text_info.underline) {\n        out_obj.underline = ' u=\"sng\"'\n      } // Endif.\n\n      if (text_info.font_size) {\n        out_obj.font_size = ' sz=\"' + text_info.font_size + '00\"'\n      } // Endif.\n\n      // psv 2015-01-21 Manually copied in from https://github.com/Ziv-Barber/officegen/pull/41/files\n      if (text_info.char_spacing) {\n        out_obj.char_spacing = ' spc=\"' + text_info.char_spacing * 100 + '\"'\n\n        // Must also disable kerning otherwise text won't actually expand:\n        out_obj.char_spacing += ' kern=\"0\"'\n      } // Endif.\n\n      if (text_info.baseline) {\n        out_obj.baseline = ' baseline=\"' + text_info.baseline * 1000 + '\"'\n      } // Endif.\n\n      if (text_info.color) {\n        out_obj.rpr_info += cMakePptxColorSelection(text_info.color)\n      } else if (slide_obj && slide_obj.color) {\n        out_obj.rpr_info += cMakePptxColorSelection(slide_obj.color)\n      } // Endif.\n\n      if (text_info.font_face) {\n        out_obj.rpr_info +=\n          '<a:latin typeface=\"' +\n          text_info.font_face +\n          '\" pitchFamily=\"34\" charset=\"0\"/><a:cs typeface=\"' +\n          text_info.font_face +\n          '\" pitchFamily=\"34\" charset=\"0\"/>'\n      } // Endif.\n    } else {\n      if (slide_obj && slide_obj.color) {\n        out_obj.rpr_info += cMakePptxColorSelection(slide_obj.color)\n      } // Endif.\n    } // Endif.\n\n    if (out_obj.rpr_info !== '') {\n      out_obj.rpr_info += '</a:rPr>'\n    } // Endif.\n\n    return out_obj\n  }\n\n  /**\n   * Create a text object for adding into a slide.\n   *\n   * @param {object} text_info Information how to display the text.\n   * @param {object} text_string The text string or requested field.\n   * @param {object} slide_obj The object of this slider.\n   * @param {object} slide_num Current slide number.\n   * @param {string} out_styles Paragraph style used to style paragraphs generated by newlines\n   * @return The PPTX code.\n   */\n  function cMakePptxOutTextCommand(\n    text_info,\n    text_string,\n    slide_obj,\n    slide_num,\n    out_styles\n  ) {\n    text_info = text_info || {}\n\n    var area_opt_data = cMakePptxOutTextData(text_info, slide_obj)\n    var textStyles = [\n      'font_size',\n      'strike',\n      'italic',\n      'bold',\n      'underline',\n      'char_spacing',\n      'baseline'\n    ].reduce(function(acc, attr) {\n      return acc + area_opt_data[attr]\n    }, '')\n    var parsedText\n    var startInfo =\n      '<a:rPr lang=\"en-US\"' +\n      textStyles +\n      ' dirty=\"0\" smtClean=\"0\"' +\n      (area_opt_data.rpr_info !== '' ? '>' + area_opt_data.rpr_info : '/>') +\n      '<a:t>'\n    var endTag = '</a:r>'\n    var outData = '<a:r>' + startInfo\n\n    if (text_string.field) {\n      endTag = '</a:fld>'\n      var outTextField = pptxFields[text_string.field]\n      if (outTextField === null) {\n        for (var fieldIntName in pptxFields) {\n          if (pptxFields[fieldIntName] === text_string.field) {\n            outTextField = text_string.field\n            break\n          } // Endif.\n        } // End of for loop.\n\n        if (outTextField === null) {\n          outTextField = 'datetime'\n        } // Endif.\n      } // Endif.\n\n      outData =\n        '<a:fld id=\"{' +\n        gen_private.plugs.type.msoffice.makeUniqueID('5C7A2A3D') +\n        '}\" type=\"' +\n        outTextField +\n        '\">' +\n        startInfo\n      outData += createFieldText(outTextField, slide_num)\n    } else {\n      // Automatic support for newline - split it into multi-p:\n      parsedText = text_string.split('\\n')\n      if (parsedText.length > 1) {\n        var outTextData = ''\n        for (\n          var i = 0, total_size_i = parsedText.length;\n          i < total_size_i;\n          i++\n        ) {\n          outTextData += outData + encodeHTML(parsedText[i])\n\n          if (i + 1 < total_size_i) {\n            outTextData += '</a:t></a:r></a:p><a:p>'\n            if (out_styles) outTextData += out_styles\n          } // Endif.\n        } // End of for loop.\n\n        outData = outTextData\n      } else {\n        outData += encodeHTML(text_string)\n      } // Endif.\n    } // Endif.\n\n    var outBreakP = ''\n    if (text_info.breakLine) {\n      outBreakP += '</a:p><a:p>'\n    } // Endif.\n\n    return outData + '</a:t>' + endTag + outBreakP\n  }\n\n  /**\n   * Create all the objects inside a single paragraph.\n   * @param {string} outString The string to add the output xml to it.\n   * @param {Array} pData Array with all the parts of this paragraph.\n   * @param {object} pOptions Paragraph options.\n   * @param {object} slideObj The object of this slider.\n   */\n  function cMakePptxOutTextP(outString, pData, pOptions, slideObj) {\n    var outStyles = ''\n    var moreStylesAttr\n    var moreStyles\n\n    // Work on all the parts of this paragraph:\n    for (var j = 0, total_size_j = pData.length; j < total_size_j; j++) {\n      if (pData[j]) {\n        moreStylesAttr = ''\n        moreStyles = ''\n\n        if (pData[j].options) {\n          if (pData[j].options.align) {\n            switch (pData[j].options.align) {\n              case 'right':\n                moreStylesAttr += ' algn=\"r\"'\n                break\n\n              case 'center':\n                moreStylesAttr += ' algn=\"ctr\"'\n                break\n\n              case 'justify':\n                moreStylesAttr += ' algn=\"just\"'\n                break\n            } // End of switch.\n          } // Endif.\n\n          if (pData[j].options.indentLevel > 0) {\n            moreStylesAttr += ' lvl=\"' + pData[j].options.indentLevel + '\"'\n          } // Endif.\n\n          if (pData[j].options.listType === 'number') {\n            moreStyles +=\n              '<a:buFont typeface=\"+mj-lt\"/><a:buAutoNum type=\"arabicPeriod\"/>'\n          } else if (pData[j].options.listType === 'dot') {\n            moreStyles += '<a:buChar char=\"•\"/>'\n          } // Endif.\n        } // Endif.\n\n        if (moreStyles !== '') {\n          outStyles = '<a:pPr' + moreStylesAttr + '>' + moreStyles + '</a:pPr>'\n        } else if (moreStylesAttr !== '') {\n          outStyles = '<a:pPr' + moreStylesAttr + '/>'\n        } // Endif.\n\n        if (outStyles || !j) {\n          if (j) {\n            outString += '</a:p>'\n          } // Endif.\n\n          outString += '<a:p>' + outStyles\n        } // Endif.\n\n        outString += cMakePptxOutTextCommand(\n          pData[j].options,\n          pData[j].text,\n          slideObj,\n          slideObj.getPageNumber(),\n          outStyles\n        )\n      } // Endif.\n    } // End of for loop - adding all the objects inside the paragraph.\n\n    var font_size = ''\n    if (pOptions && pOptions.font_size) {\n      font_size = ' sz=\"' + pOptions.font_size + '00\"'\n    } // Endif.\n\n    outString += '<a:endParaRPr lang=\"en-US\"' + font_size + ' dirty=\"0\"/></a:p>'\n    return outString\n  }\n\n  /**\n   * ???.\n   *\n   * @param {object} in_data_val Input value as passed by the user.\n   * @param {number} max_value Maximum value allowed.\n   * @param {number} def_value Default value.\n   * @param {number} auto_val ???.\n   * @param {number} mul_val ???.\n   * @return ???.\n   */\n  function parseSmartNumber(\n    in_data_val,\n    max_value,\n    def_value,\n    auto_val,\n    mul_val\n  ) {\n    if (typeof in_data_val === 'undefined') {\n      return typeof def_value === 'number' ? def_value : 0\n    } // Endif.\n\n    if (in_data_val === '') {\n      in_data_val = 0\n    } // Endif.\n\n    if (typeof in_data_val === 'string' && !isNaN(in_data_val)) {\n      in_data_val = parseInt(in_data_val, 10)\n    } // Endif.\n\n    var realNum = Math.round(mul_val ? in_data_val * mul_val : in_data_val)\n\n    var realVal\n    var realMax\n\n    if (typeof in_data_val === 'string') {\n      if (in_data_val.indexOf('%') !== -1) {\n        realMax = typeof max_value === 'number' ? max_value : 0\n        if (realMax <= 0) {\n          return 0\n        } // Endif.\n\n        realVal = parseInt(in_data_val, 10)\n        return Math.round((realMax / 100) * realVal)\n      } // Endif.\n\n      if (in_data_val.indexOf('#') !== -1) {\n        realVal = parseInt(in_data_val, 10)\n        return realMax\n      } // Endif.\n\n      var realAuto = typeof auto_val === 'number' ? auto_val : 0\n\n      if (in_data_val === '*') {\n        return realAuto\n      } // Endif.\n\n      if (in_data_val === 'c') {\n        return Math.round(realAuto / 2)\n      } // Endif.\n    } // Endif.\n\n    if (typeof in_data_val === 'number') {\n      return realNum\n    } // Endif.\n\n    return typeof def_value === 'number' ? def_value : 0\n  }\n\n  /**\n   * Create the XML code of a single effect.\n   *\n   * This method creating the effect XML code for a single object.\n   *\n   * @param {object} effectData Effect data.\n   * @param {string} effectName The name of the effect.\n   */\n  function cbGenerateEffects(effectData, effectName) {\n    var outData = '<a:' + effectName + ' '\n    var color = effectData.color || 'black'\n    var alphaPer = 60\n    var algnData = ''\n    var blurRad = 50800\n    var dist = 38100\n    var dir = 13500000\n\n    if (typeof effectData.transparency === 'number') {\n      alphaPer = effectData.transparency\n    } // Endif.\n\n    if (alphaPer > 100 || alphaPer < 0) {\n      alphaPer = 60\n    }\n\n    alphaPer = (100 - alphaPer) * 1000\n\n    if (effectData.align) {\n      if (effectData.align.top) {\n        algnData += 't'\n      }\n\n      if (effectData.align.bottom) {\n        algnData += 'b'\n      }\n\n      if (effectData.align.left) {\n        algnData += 'l'\n      }\n\n      if (effectData.align.right) {\n        algnData += 'r'\n      }\n    } // Endif.\n\n    if (algnData === '') {\n      algnData = 'br'\n    } // Endif.\n\n    // Size\n    // Blur\n    // Angle\n    // Distance\n    // BMK_TODO:\n\n    outData +=\n      ' blurRad=\"' +\n      blurRad +\n      '\" dist=\"' +\n      dist +\n      '\" dir=\"' +\n      dir +\n      '\" algn=\"' +\n      algnData +\n      '\" rotWithShape=\"0\"'\n\n    // sx=\"24000\" sy=\"24000\"\n    // BMK_TODO:\n\n    outData +=\n      '><a:prstClr val=\"' +\n      color +\n      '\"><a:alpha val=\"' +\n      alphaPer +\n      '\"/></a:prstClr>'\n    return outData + '</a:' + effectName + '>'\n  }\n\n  /**\n   * Create the body properties code for text.\n   *\n   * This method creating the XML code of the body properties of a text.\n   *\n   * @return The body properties XML code.\n   */\n  function createBodyProperties(objOptions) {\n    var bodyProperties = '<a:bodyPr'\n\n    if (objOptions && objOptions.bodyProp) {\n      // Set anchorPoints bottom, center or top:\n      if (objOptions.bodyProp.anchor) {\n        bodyProperties += ' anchor=\"' + objOptions.bodyProp.anchor + '\"'\n      } // Endif.\n\n      if (objOptions.bodyProp.anchorCtr) {\n        bodyProperties += ' anchorCtr=\"' + objOptions.bodyProp.anchorCtr + '\"'\n      } // Endif.\n\n      // Enable or disable textwrapping none or square:\n      if (objOptions.bodyProp.wrap) {\n        bodyProperties += ' wrap=\"' + objOptions.bodyProp.wrap + '\"'\n      } else {\n        bodyProperties += ' wrap=\"square\"'\n      } // Endif.\n\n      // Box margins(padding):\n      // BMK_TODO: I should pass a better value as the auto_val parameter of parseSmartNumber().\n      if (objOptions.bodyProp.bIns) {\n        bodyProperties +=\n          ' bIns=\"' +\n          parseSmartNumber(\n            objOptions.bodyProp.bIns,\n            gen_private.type.pptx.pptHeight,\n            369332,\n            gen_private.type.pptx.pptHeight,\n            10000\n          ) +\n          '\"'\n      } // Endif.\n\n      if (objOptions.bodyProp.lIns) {\n        bodyProperties +=\n          ' lIns=\"' +\n          parseSmartNumber(\n            objOptions.bodyProp.lIns,\n            gen_private.type.pptx.pptWidth,\n            2819400,\n            gen_private.type.pptx.pptWidth,\n            10000\n          ) +\n          '\"'\n      } // Endif.\n\n      if (objOptions.bodyProp.rIns) {\n        bodyProperties +=\n          ' rIns=\"' +\n          parseSmartNumber(\n            objOptions.bodyProp.rIns,\n            gen_private.type.pptx.pptWidth,\n            2819400,\n            gen_private.type.pptx.pptWidth,\n            10000\n          ) +\n          '\"'\n      } // Endif.\n\n      if (objOptions.bodyProp.tIns) {\n        bodyProperties +=\n          ' tIns=\"' +\n          parseSmartNumber(\n            objOptions.bodyProp.tIns,\n            gen_private.type.pptx.pptHeight,\n            369332,\n            gen_private.type.pptx.pptHeight,\n            10000\n          ) +\n          '\"'\n      } // Endif.\n\n      bodyProperties += ' rtlCol=\"0\">'\n\n      if (objOptions.bodyProp.autoFit !== false) {\n        bodyProperties += '<a:spAutoFit/>'\n      } // Endif.\n\n      bodyProperties += '</a:bodyPr>'\n\n      // Default:\n    } else {\n      bodyProperties += ' wrap=\"square\" rtlCol=\"0\"></a:bodyPr>'\n    } // Endif.\n\n    return bodyProperties\n  }\n\n  /**\n   * Generate a slider resource.\n   *\n   * This function generating a slider XML resource.\n   *\n   * @param {object} data The main slide object.\n   * @param {boolean} makeOnlyObjects is true to turn this method to make only the objects in data.data.\n   * @return Text string.\n   */\n  function cbMakePptxSlide(data, makeOnlyObjects) {\n    var outString = ''\n    var objs_list = data.data\n    var timingData = ''\n\n    // Slide with layout support:\n    if (\n      data.slide.useLayout &&\n      typeof data.slide.useLayout === 'object' &&\n      data.slide.useLayout.mkResCb\n    ) {\n      data.slide.useLayout.slide = data.slide\n      return data.slide.useLayout.mkResCb(data.slide.useLayout)\n    } // Endif.\n\n    // Allow you to turn this method into layout generator:\n    var slideElement = data.slide.layoutName ? 'Layout' : ''\n    var slideElementA = data.slide.layoutName\n      ? ' type=\"' + data.slide.layoutName + '\" preserve=\"1\"'\n      : ''\n\n    // Create the header of the slide (only if we need that):\n    if (!makeOnlyObjects) {\n      outString =\n        gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) +\n        '<p:sld' +\n        slideElement +\n        ' xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"'\n\n      if (!data.slide.show && !data.slide.layoutName) {\n        outString += ' show=\"0\"'\n      } // Endif.\n\n      outString +=\n        slideElementA +\n        '><p:cSld' +\n        (data.slide.name ? ' name=\"' + data.slide.name + '\"' : '') +\n        '>'\n\n      if (data.slide.back) {\n        outString += cMakePptxColorSelection(false, data.slide.back)\n      } // Endif.\n\n      outString +=\n        '<p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr>'\n    } // Endif.\n\n    // Loop on all the objects inside the slide to add it into the slide:\n    for (var i = 0, total_size = objs_list.length; i < total_size; i++) {\n      var x = 0\n      var y = 0\n      var cx = 2819400\n      var cy = 369332\n\n      var moreStyles = ''\n      var moreStylesAttr = ''\n      var outStyles = ''\n      var styleData = ''\n      var shapeType = null\n      var locationAttr = ''\n\n      if (objs_list[i].options) {\n        if (typeof objs_list[i].options.cx !== 'undefined') {\n          if (objs_list[i].options.cx) {\n            cx = parseSmartNumber(\n              objs_list[i].options.cx,\n              gen_private.type.pptx.pptWidth,\n              cx,\n              gen_private.type.pptx.pptWidth,\n              10000\n            )\n          } else {\n            cx = 1\n          } // Endif.\n        } // Endif.\n\n        if (typeof objs_list[i].options.cy !== 'undefined') {\n          if (objs_list[i].options.cy) {\n            cy = parseSmartNumber(\n              objs_list[i].options.cy,\n              gen_private.type.pptx.pptHeight,\n              cy,\n              gen_private.type.pptx.pptHeight,\n              10000\n            )\n          } else {\n            cy = 1\n          } // Endif.\n        } // Endif.\n\n        if (objs_list[i].options.x) {\n          x = parseSmartNumber(\n            objs_list[i].options.x,\n            gen_private.type.pptx.pptWidth,\n            0,\n            gen_private.type.pptx.pptWidth - cx,\n            10000\n          )\n        } // Endif.\n\n        if (objs_list[i].options.y) {\n          y = parseSmartNumber(\n            objs_list[i].options.y,\n            gen_private.type.pptx.pptHeight,\n            0,\n            gen_private.type.pptx.pptHeight - cy,\n            10000\n          )\n        } // Endif.\n\n        if (objs_list[i].options.shape) {\n          shapeType = getShapeInfo(objs_list[i].options.shape)\n        } // Endif.\n\n        if (objs_list[i].options.flip_vertical) {\n          locationAttr += ' flipV=\"1\"'\n        } // Endif.\n\n        if (objs_list[i].options.flip_horizontal) {\n          locationAttr += ' flipH=\"1\"'\n        } // Endif.\n\n        if (objs_list[i].options.rotate) {\n          var rotateVal =\n            objs_list[i].options.rotate > 360\n              ? objs_list[i].options.rotate - 360\n              : objs_list[i].options.rotate\n          rotateVal *= 60000\n          locationAttr += ' rot=\"' + rotateVal + '\"'\n        } // Endif.\n      } // Endif.\n\n      switch (objs_list[i].type) {\n        // TODO: remove hard code here:\n        case 'table':\n          var table_obj = officeTable.getTable(\n            objs_list[i].data,\n            objs_list[i].options\n          )\n          // console.log(JSON.stringify(table_obj, null, 2))\n          var table_xml = xmlBuilder\n            .create(table_obj, {\n              version: '1.0',\n              encoding: 'UTF-8',\n              standalone: true\n            })\n            .toString({ pretty: true, indent: '  ', newline: '\\n' })\n\n          outString += table_xml\n          break\n\n        case 'chart':\n          // loop through the charts\n          //\n\n          if (objs_list[i].renderType === 'pie') {\n            outString +=\n              '<p:graphicFrame><p:nvGraphicFramePr><p:cNvPr id=\"20\" name=\"OfficeChart 19\"/><p:cNvGraphicFramePr/><p:nvPr><p:extLst><p:ext uri=\"{D42A27DB-BD31-4B8C-83A1-F6EECF244321}\"><p14:modId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"4198609065\"/></p:ext></p:extLst></p:nvPr></p:nvGraphicFramePr><p:xfrm><a:off x=\"' +\n              (objs_list[i].options.x || 1524000) +\n              '\" y=\"' +\n              (objs_list[i].options.y || 1397000) +\n              '\"/><a:ext cx=\"' +\n              (objs_list[i].options.cx || 6096000) +\n              '\" cy=\"' +\n              (objs_list[i].options.cy || 4064000) +\n              '\"/></p:xfrm><a:graphic><a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/chart\"><c:chart xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" r:id=\"rId2\"/></a:graphicData></a:graphic></p:graphicFrame>'\n          } else if (objs_list[i].renderType === 'column') {\n            outString +=\n              '<p:graphicFrame><p:nvGraphicFramePr><p:cNvPr id=\"4\" name=\"OfficeChart 3\"/><p:cNvGraphicFramePr/><p:nvPr><p:extLst><p:ext uri=\"{D42A27DB-BD31-4B8C-83A1-F6EECF244321}\"><p14:modId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1256887135\"/></p:ext></p:extLst></p:nvPr></p:nvGraphicFramePr><p:xfrm><a:off x=\"' +\n              (objs_list[i].options.x || 1524000) +\n              '\" y=\"' +\n              (objs_list[i].options.y || 1397000) +\n              '\"/><a:ext cx=\"' +\n              (objs_list[i].options.cx || 6096000) +\n              '\" cy=\"' +\n              (objs_list[i].options.cy || 4064000) +\n              '\"/></p:xfrm><a:graphic><a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/chart\"><c:chart xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" r:id=\"rId2\"/></a:graphicData></a:graphic></p:graphicFrame>'\n          } // Endif.\n          break\n        case 'text':\n        case 'cxn':\n          var effectsList = ''\n\n          if (shapeType == null) shapeType = getShapeInfo(null)\n\n          // if ( objs_list[i].type == 'text' ) {\n          //   if ( !objs_list[i].options || (!objs_list[i].options.cx && !objs_list[i].options.cx) ) {\n          //     objs_list[i].options = objs_list[i].options ? objs_list[i].options : {}\n          //     objs_list[i].options.bodyProp = objs_list[i].options.bodyProp ? objs_list[i].options.bodyProp : {}\n          //     objs_list[i].options.bodyProp.autoFit = true\n          //     cx = gen_private.type.pptx.pptWidth - x\n          //     cy = gen_private.type.pptx.pptHeight - y\n          //   } // Endif.\n          // } // Endif.\n\n          if (objs_list[i].type === 'cxn') {\n            outString += '<p:cxnSp><p:nvCxnSpPr>'\n            outString +=\n              '<p:cNvPr id=\"' +\n              (i + 2) +\n              '\" name=\"Object ' +\n              (i + 1) +\n              '\"/><p:nvPr/></p:nvCxnSpPr>'\n          } else {\n            outString += '<p:sp><p:nvSpPr>'\n            outString +=\n              '<p:cNvPr id=\"' +\n              (i + 2) +\n              '\" name=\"Object ' +\n              (i + 1) +\n              '\"/><p:cNvSpPr txBox=\"1\"/><p:nvPr/></p:nvSpPr>'\n          } // Endif.\n\n          outString += '<p:spPr>'\n\n          outString += '<a:xfrm' + locationAttr + '>'\n\n          outString +=\n            '<a:off x=\"' +\n            x +\n            '\" y=\"' +\n            y +\n            '\"/><a:ext cx=\"' +\n            cx +\n            '\" cy=\"' +\n            cy +\n            '\"/></a:xfrm><a:prstGeom prst=\"' +\n            shapeType.name +\n            '\">'\n\n          // string changed to take into account change of shape that you do by moving the little yellow dot\n\n          if (shapeType.avLst !== {}) {\n            outString += '<a:avLst>'\n            for (var adj in shapeType.avLst) {\n              outString +=\n                '<a:gd name=\"' +\n                adj +\n                '\" fmla=\"val ' +\n                shapeType.avLst[adj] +\n                '\"/>'\n            }\n          }\n\n          outString += '</a:avLst></a:prstGeom>'\n\n          if (objs_list[i].options) {\n            if (objs_list[i].options.fill) {\n              outString += cMakePptxColorSelection(objs_list[i].options.fill)\n            } else {\n              outString += '<a:noFill/>'\n            } // Endif.\n\n            if (objs_list[i].options.line) {\n              var lineAttr = ''\n\n              if (objs_list[i].options.line_size) {\n                lineAttr +=\n                  ' w=\"' + objs_list[i].options.line_size * 12700 + '\"'\n              } // Endif.\n\n              // cmpd=\"dbl\"\n\n              outString += '<a:ln' + lineAttr + '>'\n              outString += cMakePptxColorSelection(objs_list[i].options.line)\n\n              if (objs_list[i].options.line_head) {\n                outString +=\n                  '<a:headEnd type=\"' + objs_list[i].options.line_head + '\"/>'\n              } // Endif.\n\n              if (objs_list[i].options.line_tail) {\n                outString +=\n                  '<a:tailEnd type=\"' + objs_list[i].options.line_tail + '\"/>'\n              } // Endif.\n\n              outString += '</a:ln>'\n            } // Endif.\n          } else {\n            outString += '<a:noFill/>'\n          } // Endif.\n\n          if (objs_list[i].options.effects) {\n            for (\n              var ii = 0, total_size_ii = objs_list[i].options.effects.length;\n              ii < total_size_ii;\n              ii++\n            ) {\n              switch (objs_list[i].options.effects[ii].type) {\n                case 'outerShadow':\n                  effectsList += cbGenerateEffects(\n                    objs_list[i].options.effects[ii],\n                    'outerShdw'\n                  )\n                  break\n\n                case 'innerShadow':\n                  effectsList += cbGenerateEffects(\n                    objs_list[i].options.effects[ii],\n                    'innerShdw'\n                  )\n                  break\n              } // End of switch.\n            } // End of for loop.\n          } // Endif.\n\n          if (effectsList !== '') {\n            outString += '<a:effectLst>' + effectsList + '</a:effectLst>'\n          } // Endif.\n\n          outString += '</p:spPr>'\n\n          if (objs_list[i].options) {\n            if (objs_list[i].options.align) {\n              switch (objs_list[i].options.align) {\n                case 'right':\n                  moreStylesAttr += ' algn=\"r\"'\n                  break\n\n                case 'center':\n                  moreStylesAttr += ' algn=\"ctr\"'\n                  break\n\n                case 'justify':\n                  moreStylesAttr += ' algn=\"just\"'\n                  break\n              } // End of switch.\n            } // Endif.\n\n            if (objs_list[i].options.indentLevel > 0) {\n              moreStylesAttr +=\n                ' lvl=\"' + objs_list[i].options.indentLevel + '\"'\n            } // Endif.\n          } // Endif.\n\n          if (moreStyles !== '') {\n            outStyles =\n              '<a:pPr' + moreStylesAttr + '>' + moreStyles + '</a:pPr>'\n          } else if (moreStylesAttr !== '') {\n            outStyles = '<a:pPr' + moreStylesAttr + '/>'\n          } // Endif.\n\n          if (styleData !== '') {\n            outString += '<p:style>' + styleData + '</p:style>'\n          } // Endif.\n\n          if (typeof objs_list[i].text === 'string') {\n            outString +=\n              '<p:txBody>' +\n              createBodyProperties(objs_list[i].options) +\n              '<a:lstStyle/><a:p>' +\n              outStyles\n            outString += cMakePptxOutTextCommand(\n              objs_list[i].options,\n              objs_list[i].text,\n              data.slide,\n              data.slide.getPageNumber(),\n              outStyles\n            )\n          } else if (typeof objs_list[i].text === 'number') {\n            outString +=\n              '<p:txBody>' +\n              createBodyProperties(objs_list[i].options) +\n              '<a:lstStyle/><a:p>' +\n              outStyles\n            outString += cMakePptxOutTextCommand(\n              objs_list[i].options,\n              objs_list[i].text + '',\n              data.slide,\n              data.slide.getPageNumber(),\n              outStyles\n            )\n          } else if (objs_list[i].text && objs_list[i].text.length) {\n            var outBodyOpt = createBodyProperties(objs_list[i].options)\n            outString +=\n              '<p:txBody>' + outBodyOpt + '<a:lstStyle/><a:p>' + outStyles\n\n            for (\n              var j = 0, total_size_j = objs_list[i].text.length;\n              j < total_size_j;\n              j++\n            ) {\n              if (\n                typeof objs_list[i].text[j] === 'object' &&\n                objs_list[i].text[j].text\n              ) {\n                outString += cMakePptxOutTextCommand(\n                  objs_list[i].text[j].options || objs_list[i].options,\n                  objs_list[i].text[j].text,\n                  data.slide,\n                  outBodyOpt,\n                  outStyles,\n                  data.slide.getPageNumber()\n                )\n              } else if (typeof objs_list[i].text[j] === 'string') {\n                outString += cMakePptxOutTextCommand(\n                  objs_list[i].options,\n                  objs_list[i].text[j],\n                  data.slide,\n                  outBodyOpt,\n                  outStyles,\n                  data.slide.getPageNumber()\n                )\n              } else if (typeof objs_list[i].text[j] === 'number') {\n                outString += cMakePptxOutTextCommand(\n                  objs_list[i].options,\n                  objs_list[i].text[j] + '',\n                  data.slide,\n                  outBodyOpt,\n                  outStyles,\n                  data.slide.getPageNumber()\n                )\n              } else if (\n                typeof objs_list[i].text[j] === 'object' &&\n                objs_list[i].text[j].field\n              ) {\n                outString += cMakePptxOutTextCommand(\n                  objs_list[i].options,\n                  objs_list[i].text[j],\n                  data.slide,\n                  outBodyOpt,\n                  outStyles,\n                  data.slide.getPageNumber()\n                )\n              } // Endif.\n            } // Endif.\n          } else if (typeof objs_list[i].text === 'object') {\n            if (!objs_list[i].text) {\n              objs_list[i].text = {}\n            } // Endif.\n\n            if (!objs_list[i].text.field) {\n              objs_list[i].text.field = ''\n            } // Endif.\n\n            outString +=\n              '<p:txBody>' +\n              createBodyProperties(objs_list[i].options) +\n              '<a:lstStyle/><a:p>' +\n              outStyles\n            outString += cMakePptxOutTextCommand(\n              objs_list[i].options,\n              objs_list[i].text,\n              data.slide,\n              data.slide.getPageNumber(),\n              outStyles\n            )\n          } // Endif.\n\n          // We must add that at the end of every paragraph with text:\n          if (typeof objs_list[i].text !== 'undefined') {\n            var font_size = ''\n            if (objs_list[i].options && objs_list[i].options.font_size) {\n              font_size = ' sz=\"' + objs_list[i].options.font_size + '00\"'\n            } // Endif.\n\n            outString +=\n              '<a:endParaRPr lang=\"en-US\"' +\n              font_size +\n              ' dirty=\"0\"/></a:p></p:txBody>'\n          } // Endif.\n\n          outString += objs_list[i].type === 'cxn' ? '</p:cxnSp>' : '</p:sp>'\n          /* eslint-disable indent */\n          break\n\n        // Table:\n        /*\n        case 'table':\n          outString += '<p:graphicFrame><p:nvGraphicFramePr><p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvGraphicFramePr><a:graphicFrameLocks noGrp=\"1\"/></p:cNvGraphicFramePr><p:nvPr/></p:nvGraphicFramePr>'\n          outString += '<p:xfrm><a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></p:xfrm>'\n          outString += '<a:graphic><a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/table\"><a:tbl><a:tblPr firstRow=\"1\" bandRow=\"1\"><a:tableStyleId>'\n\n          if ( objs_list[i].options && objs_list[i].options.tableStyleId ) {\n            outString += objs_list[i].options.tableStyleId\n\n          } else {\n            outString += '{073A0DAA-6AF3-43AB-8588-CEC1D06C72B9}'\n          } // Endif.\n\n          outString += '</a:tableStyleId></a:tblPr><a:tblGrid>'\n          // <a:gridCol w=\"3276600\"/>\n          outString += '</a:tblGrid>'\n          // objs_list[i].options\n          // objs_list[i].rows[][].text\n          // BMK_TODO:\n          break\n        */\n        /* eslint-enable indent */\n\n        // Image:\n        case 'image':\n          // psv 2015-01-21 Manually copied this section from https://github.com/Ziv-Barber/officegen/pull/39/files?w=1\n          // outString += '<p:pic><p:nvPicPr><p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr><p:nvPr/></p:nvPicPr><p:blipFill><a:blip r:embed=\"rId' + objs_list[i].rel_id + '\" cstate=\"print\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill><p:spPr><a:xfrm' + locationAttr + '><a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr></p:pic>'\n          var parts = []\n\n          parts.push(\n            '<p:pic><p:nvPicPr><p:cNvPr id=\"' +\n              (i + 2) +\n              '\" name=\"Object ' +\n              (i + 1) +\n              '\"'\n          )\n\n          if (objs_list[i].link_rel_id) {\n            parts.push(\n              '><a:hlinkClick r:id=\"rId' +\n                objs_list[i].link_rel_id +\n                '\"/></p:cNvPr>'\n            )\n          } else {\n            parts.push('/>')\n          } // Endif.\n\n          parts.push(\n            '<p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr><p:nvPr/></p:nvPicPr><p:blipFill><a:blip r:embed=\"rId' +\n              objs_list[i].rel_id +\n              '\" cstate=\"print\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill><p:spPr><a:xfrm' +\n              locationAttr +\n              '><a:off x=\"' +\n              x +\n              '\" y=\"' +\n              y +\n              '\"/><a:ext cx=\"' +\n              cx +\n              '\" cy=\"' +\n              cy +\n              '\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr></p:pic>'\n          )\n          outString += parts.join('')\n          // -- psv 2015-01-21 end merge\n          break\n\n        // Paragraph:\n        case 'p':\n          if (shapeType == null) {\n            shapeType = getShapeInfo(null)\n          } // Endif.\n\n          outString += '<p:sp><p:nvSpPr>'\n          outString +=\n            '<p:cNvPr id=\"' +\n            (i + 2) +\n            '\" name=\"Object ' +\n            (i + 1) +\n            '\"/><p:cNvSpPr txBox=\"1\"/><p:nvPr/></p:nvSpPr>'\n          outString += '<p:spPr>'\n\n          outString += '<a:xfrm' + locationAttr + '>'\n\n          outString +=\n            '<a:off x=\"' +\n            x +\n            '\" y=\"' +\n            y +\n            '\"/><a:ext cx=\"' +\n            cx +\n            '\" cy=\"' +\n            cy +\n            '\"/></a:xfrm><a:prstGeom prst=\"' +\n            shapeType.name +\n            '\"><a:avLst/></a:prstGeom>'\n\n          if (objs_list[i].options) {\n            if (objs_list[i].options.fill) {\n              outString += cMakePptxColorSelection(objs_list[i].options.fill)\n            } else {\n              outString += '<a:noFill/>'\n            } // Endif.\n\n            if (objs_list[i].options.line) {\n              outString += '<a:ln>'\n              outString += cMakePptxColorSelection(objs_list[i].options.line)\n\n              if (objs_list[i].options.line_head) {\n                outString +=\n                  '<a:headEnd type=\"' + objs_list[i].options.line_head + '\"/>'\n              } // Endif.\n\n              if (objs_list[i].options.line_tail) {\n                outString +=\n                  '<a:tailEnd type=\"' + objs_list[i].options.line_tail + '\"/>'\n              } // Endif.\n\n              outString += '</a:ln>'\n            } // Endif.\n          } else {\n            outString += '<a:noFill/>'\n          } // Endif.\n\n          outString += '</p:spPr>'\n\n          if (styleData !== '') {\n            outString += '<p:style>' + styleData + '</p:style>'\n          } // Endif.\n\n          outString +=\n            '<p:txBody><a:bodyPr wrap=\"square\" rtlCol=\"0\"><a:spAutoFit/></a:bodyPr><a:lstStyle/>'\n\n          // Add all the paragraph objects:\n          outString = cMakePptxOutTextP(\n            outString,\n            objs_list[i].data,\n            objs_list[i].options,\n            data.slide\n          )\n\n          outString += '</p:txBody>'\n\n          outString += '</p:sp>'\n          break\n      } // End of switch.\n    } // End of for loop.\n\n    if (!makeOnlyObjects) {\n      outString +=\n        '</p:spTree></p:cSld><p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr>'\n\n      if (timingData !== '') {\n        outString += '<p:timing>' + timingData + '</p:timing>'\n      } // Endif.\n\n      outString += '</p:sld' + slideElement + '>'\n    } // Endif.\n\n    return outString\n  }\n\n  /**\n   * Generate the extended attributes file (app) for PPTX/PPSX documents.\n   *\n   * @param {object} data Ignored by this callback function.\n   * @return Text string.\n   */\n  function cbMakePptxApp(data) {\n    var slidesCount = gen_private.pages.length\n    var userName =\n      genobj.options.author || genobj.options.creator || 'officegen'\n    var outString =\n      gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml(data) +\n      '<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\"><TotalTime>0</TotalTime><Words>0</Words><Application>Microsoft Office PowerPoint</Application><PresentationFormat>On-screen Show (4:3)</PresentationFormat><Paragraphs>0</Paragraphs><Slides>' +\n      slidesCount +\n      '</Slides><Notes>0</Notes><HiddenSlides>0</HiddenSlides><MMClips>0</MMClips><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size=\"4\" baseType=\"variant\"><vt:variant><vt:lpstr>Theme</vt:lpstr></vt:variant><vt:variant><vt:i4>1</vt:i4></vt:variant><vt:variant><vt:lpstr>Slide Titles</vt:lpstr></vt:variant><vt:variant><vt:i4>' +\n      slidesCount +\n      '</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size=\"' +\n      (slidesCount + 1) +\n      '\" baseType=\"lpstr\"><vt:lpstr>Office Theme</vt:lpstr>'\n\n    for (\n      var i = 0, total_size = gen_private.pages.length;\n      i < total_size;\n      i++\n    ) {\n      outString +=\n        '<vt:lpstr>' +\n        encodeHTML(gen_private.pages[i].slide.name) +\n        '</vt:lpstr>'\n    } // End of for loop.\n\n    outString +=\n      '</vt:vector></TitlesOfParts><Company>' +\n      userName +\n      '</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>12.0000</AppVersion></Properties>'\n    return outString\n  }\n\n  /**\n   * Create XML string for a chart description\n   *\n   * @param {object} chartInfo\n   * @return Text Xml string.\n   */\n  function cbMakeCharts(chartInfo) {\n    var chart = new OfficeChart(chartInfo)\n    return chart.toXML()\n  }\n\n  function cbMakeChartDataExcel(data) {\n    // PSV not sure why this method is here.  Presumably vestigial from earlier code.\n  }\n\n  // Prepare genobj for MS-Office:\n  msdoc.makemsdoc(genobj, new_type, options, gen_private, type_info)\n  gen_private.plugs.type.msoffice.makeOfficeGenerator('ppt', 'presentation', {})\n\n  gen_private.features.page_name = 'slides' // This document type must have pages.\n\n  gen_private.plugs.type.msoffice.addInfoType(\n    'dc:title',\n    '',\n    'title',\n    'setDocTitle'\n  )\n\n  genobj.on('beforeGen', cbPreparePptxToGenerate)\n\n  var type_of_main_doc = 'slideshow'\n  if (new_type !== 'ppsx') {\n    type_of_main_doc = 'presentation'\n  } // Endif.\n\n  // Create the plugins manager:\n  var plugsmanObj = new docplugman(\n    genobj,\n    gen_private,\n    'pptx',\n    setDefaultDocValues\n  )\n\n  // We'll register now any specific PowerPoint based plugin that we want to use:\n  plugsmanObj.plugsList.push(new plugWidescreen(plugsmanObj))\n  plugsmanObj.plugsList.push(new plugSpeakernotes(plugsmanObj))\n  plugsmanObj.plugsList.push(new plugLayouts(plugsmanObj))\n  // BMK_PPTX_PLUG:\n\n  // Dynamic loading of additional plugins requested by the user:\n  if (\n    options.extraPlugs &&\n    typeof options.extraPlugs === 'object' &&\n    options.extraPlugs.forEach\n  ) {\n    options.extraPlugs.forEach(function(value) {\n      var newPlug\n\n      if (value) {\n        if (typeof value === 'function') {\n          // You already loaded the plugin:\n          newPlug = value\n        } else if (typeof value === 'string') {\n          // We need to load the plugin:\n          newPlug = require('./' + value)\n        } // Endif.\n      } // Endif.\n\n      plugsmanObj.plugsList.push(new newPlug(plugsmanObj))\n    })\n  } // Endif.\n\n  // Save some methods for the plugins:\n  genobj.cbMakePptxLayout1 = cbMakePptxLayout1\n  genobj.cbMakePptxSlide = cbMakePptxSlide\n  genobj.createFieldText = createFieldText\n  genobj.cMakePptxOutTextP = cMakePptxOutTextP\n\n  gen_private.type.msoffice.files_list.push(\n    {\n      name: '/ppt/slideMasters/slideMaster1.xml',\n      type:\n        'application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml',\n      clear: 'type'\n    },\n    {\n      name: '/ppt/presProps.xml',\n      type:\n        'application/vnd.openxmlformats-officedocument.presentationml.presProps+xml',\n      clear: 'type'\n    },\n    {\n      name: '/ppt/presentation.xml',\n      type:\n        'application/vnd.openxmlformats-officedocument.presentationml.' +\n        type_of_main_doc +\n        '.main+xml',\n      clear: 'type'\n    },\n    {\n      name: '/ppt/slideLayouts/slideLayout1.xml',\n      type:\n        'application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml',\n      clear: 'type'\n    },\n    {\n      name: '/ppt/tableStyles.xml',\n      type:\n        'application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml',\n      clear: 'type'\n    },\n    {\n      name: '/ppt/viewProps.xml',\n      type:\n        'application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml',\n      clear: 'type'\n    }\n  )\n\n  genobj.slideMasterRels = [\n    {\n      type:\n        'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout',\n      target: '../slideLayouts/slideLayout1.xml'\n    },\n    {\n      type:\n        'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\n      target: '../theme/theme1.xml'\n    }\n  ]\n\n  gen_private.plugs.intAddAnyResourceToParse(\n    'ppt\\\\presProps.xml',\n    'buffer',\n    null,\n    cbMakePptxPresProps,\n    true\n  )\n  gen_private.plugs.intAddAnyResourceToParse(\n    'ppt\\\\tableStyles.xml',\n    'buffer',\n    null,\n    cbMakePptxStyles,\n    true\n  )\n  gen_private.plugs.intAddAnyResourceToParse(\n    'ppt\\\\viewProps.xml',\n    'buffer',\n    null,\n    cbMakePptxViewProps,\n    true\n  )\n  gen_private.plugs.intAddAnyResourceToParse(\n    'ppt\\\\presentation.xml',\n    'buffer',\n    null,\n    cbMakePptxPresentation,\n    true\n  )\n\n  gen_private.plugs.intAddAnyResourceToParse(\n    'ppt\\\\slideLayouts\\\\slideLayout1.xml',\n    'buffer',\n    null,\n    cbMakePptxLayout1,\n    true\n  )\n  gen_private.plugs.intAddAnyResourceToParse(\n    'ppt\\\\slideLayouts\\\\_rels\\\\slideLayout1.xml.rels',\n    'buffer',\n    [\n      {\n        type:\n          'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster',\n        target: '../slideMasters/slideMaster1.xml'\n      }\n    ],\n    gen_private.plugs.type.msoffice.cbMakeRels,\n    true\n  )\n\n  // Slides master:\n  gen_private.plugs.intAddAnyResourceToParse(\n    'ppt\\\\slideMasters\\\\slideMaster1.xml',\n    'buffer',\n    null,\n    cbMakePptxSlideMasters,\n    true\n  )\n  gen_private.plugs.intAddAnyResourceToParse(\n    'ppt\\\\slideMasters\\\\_rels\\\\slideMaster1.xml.rels',\n    'buffer',\n    genobj.slideMasterRels,\n    gen_private.plugs.type.msoffice.cbMakeRels,\n    true\n  )\n\n  gen_private.plugs.intAddAnyResourceToParse(\n    'docProps\\\\app.xml',\n    'buffer',\n    null,\n    cbMakePptxApp,\n    true\n  )\n\n  gen_private.type.msoffice.rels_app.push({\n    type:\n      'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster',\n    target: 'slideMasters/slideMaster1.xml',\n    clear: 'type'\n  })\n\n  gen_private.plugs.intAddAnyResourceToParse(\n    'ppt\\\\_rels\\\\presentation.xml.rels',\n    'buffer',\n    gen_private.type.msoffice.rels_app,\n    gen_private.plugs.type.msoffice.cbMakeRels,\n    true\n  )\n\n  // ----- API for PowerPoint documents: -----\n\n  /**\n   * Create a new slide.\n   *\n   * This method creating a new slide inside the presentation.\n   *\n   * @param {object} slideOptions Extra options how to create the new slide.\n   * @return The new slide object.\n   */\n  genobj.makeNewSlide = function(slideOptions) {\n    var pageNumber = gen_private.pages.length\n    var slideObj = { show: true } // The slide object that the user will use.\n\n    if (!slideOptions || typeof slideOptions !== 'object') {\n      slideOptions = {}\n    } // Endif.\n\n    if (!slideOptions.basedLayout) {\n      slideOptions.basedLayout = 1\n    } // Endif.\n\n    gen_private.pages[pageNumber] = {}\n    gen_private.pages[pageNumber].slide = slideObj\n    gen_private.pages[pageNumber].data = []\n    gen_private.pages[pageNumber].rels = [\n      {\n        type:\n          'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout',\n        target:\n          '../slideLayouts/slideLayout' + slideOptions.basedLayout + '.xml',\n        clear: 'data'\n      }\n    ]\n\n    gen_private.type.msoffice.files_list.push({\n      name: '/ppt/slides/slide' + (pageNumber + 1) + '.xml',\n      type:\n        'application/vnd.openxmlformats-officedocument.presentationml.slide+xml',\n      clear: 'data'\n    })\n\n    gen_private.type.msoffice.rels_app.push({\n      type:\n        'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide',\n      target: 'slides/slide' + (pageNumber + 1) + '.xml',\n      clear: 'data'\n    })\n\n    slideObj.getPageNumber = function() {\n      return pageNumber\n    }\n    slideObj.getRelFile = function() {\n      return gen_private.pages[pageNumber].rels\n    }\n\n    slideObj.name = 'Slide ' + (pageNumber + 1)\n\n    /**\n     * ???.\n     *\n     * @param {object} prgObj Paragraph object.\n     */\n    function addParagraphApiForBasicOpt(prgObj) {\n      if (!prgObj.api) {\n        prgObj.api = {}\n      } // Endif.\n\n      prgObj.api.options = prgObj.options\n    }\n\n    /**\n     * ???.\n     *\n     * @param {object} prgObj Paragraph object.\n     */\n    function addParagraphApiForEffects(prgObj) {\n      if (!prgObj.api) {\n        prgObj.api = {}\n      } // Endif.\n\n      /**\n       * ???.\n       *\n       * @param {object} inType ???.\n       * @param {object} inAlign ???.\n       * @param {object} inColor ???.\n       * @param {object} inTransparency ???.\n       * @param {object} inSize ???.\n       * @param {object} inBlur ???.\n       * @param {object} inAngle ???.\n       * @param {object} inDistance ???.\n       */\n      prgObj.api.setShadowEffect = function(\n        inType,\n        inAlign,\n        inColor,\n        inTransparency,\n        inSize,\n        inBlur,\n        inAngle,\n        inDistance\n      ) {\n        if (!prgObj.options.effects) {\n          prgObj.options.effects = []\n        }\n\n        var newEffect = {\n          type: inType,\n          align: inAlign,\n          color: inColor,\n          transparency: inTransparency,\n          size: inSize,\n          blur: inBlur,\n          angle: inAngle,\n          distance: inDistance\n        }\n\n        prgObj.options.effects.push(newEffect)\n      }\n    }\n\n    // Added 2015-01-02 PSV as a way for user to modify chart properties before generating the XML string:\n    slideObj.createChart = function(chartInfo) {\n      return new OfficeChart(chartInfo)\n    }\n\n    // Added 2015-01-08 PSV following model of addChart:\n    slideObj.addTable = function(data, options) {\n      var objNumber = gen_private.pages[pageNumber].data.length\n\n      gen_private.pages[pageNumber].data[objNumber] = {\n        type: 'table',\n        data: data,\n        options: options || {} // right now this isn't yet used\n      }\n\n      addParagraphApiForBasicOpt(gen_private.pages[pageNumber].data[objNumber])\n      addParagraphApiForEffects(gen_private.pages[pageNumber].data[objNumber])\n      return gen_private.pages[pageNumber].data[objNumber].api\n    }\n\n    /**\n     * Generate the chart based on input data.\n     *\n     * @param {object} renderType should belong to: 'column', 'pie'\n     * @param {object} data a JSON object with follow the following format\n     *     {\n     *      title: 'eSurvey chart',\n     *      data:  [\n     *        {\n     *          name: 'Income',\n     *          labels: ['2005', '2006', '2007', '2008', '2009'],\n     *          values: [23.5, 26.2, 30.1, 29.5, 24.6]\n     *        },\n     *        {\n     *          name: 'Expense',\n     *          labels: ['2005', '2006', '2007', '2008', '2009'],\n     *          values: [18.1, 22.8, 23.9, 25.1, 25]\n     *        }\n     *      ]\n     *   }\n     * @author vtloc\n     * @date 2014Jan09\n     */\n    slideObj.addChart = function(data, callback, errorCallback) {\n      var objNumber = gen_private.pages[pageNumber].data.length\n      GLOBAL_CHART_COUNT += 1\n\n      gen_private.pages[pageNumber].data[objNumber] = {}\n      gen_private.pages[pageNumber].data[objNumber].type = 'chart'\n      gen_private.pages[pageNumber].data[objNumber].renderType = 'column'\n      gen_private.pages[pageNumber].data[objNumber].title = data['title']\n      gen_private.pages[pageNumber].data[objNumber].data = data['data']\n      gen_private.pages[pageNumber].data[objNumber].options = data // include generic options like x,y,cx,cy, etc.\n      // data['renderType'] = renderType\n\n      // First, generate a temporatory excel file for storing the chart's data\n      var workbook = excelbuilder.createWorkbook(\n        genobj.options.tempDir,\n        'sample' + GLOBAL_CHART_COUNT + '.xlsx'\n      )\n\n      // Create a new worksheet with 10 columns and 12 rows\n      // number of columns: data['data'].length+1 -> equaly number of series\n      // number of rows: data['data'][0].values.length+1\n      var sheet1 = workbook.createSheet(\n        'Sheet1',\n        data['data'].length + 1,\n        data['data'][0].values.length + 1\n      )\n      var headerrow = 1\n\n      // Write header using serie name:\n      for (var j = 0; j < data['data'].length; j++) {\n        sheet1.set(j + 2, headerrow, data['data'][j].name)\n      } // End of for loop.\n\n      // Write category column in the first column:\n      for (j = 0; j < data['data'][0].labels.length; j++) {\n        sheet1.set(1, j + 2, data['data'][0].labels[j])\n      } // End of for loop.\n\n      // For each serie, write out values in its row:\n      for (var i = 0; i < data['data'].length; i++) {\n        for (j = 0; j < data['data'][i].values.length; j++) {\n          // col i+2\n          // row j+1\n          sheet1.set(i + 2, j + 2, data['data'][i].values[j])\n        } // End of for loop.\n      } // End of for loop.\n\n      // Fill some data\n      // Save it\n      var localEmbeddingExcelFile =\n        'ppt\\\\embeddings\\\\Microsoft_Excel_Worksheet' +\n        GLOBAL_CHART_COUNT +\n        '.xlsx'\n      var tmpExcelFile =\n        genobj.options.tempDir + 'sample' + GLOBAL_CHART_COUNT + '.xlsx'\n      // will copy the tmpExcelFile into localEmbeddingExcelFile\n      gen_private.plugs.intAddAnyResourceToParse(\n        localEmbeddingExcelFile,\n        'file',\n        tmpExcelFile,\n        cbMakeChartDataExcel,\n        false,\n        true\n      )\n      gen_private.plugs.intAddAnyResourceToParse(\n        'ppt\\\\charts\\\\chart' + GLOBAL_CHART_COUNT + '.xml',\n        'buffer',\n        data,\n        cbMakeCharts,\n        true\n      )\n      gen_private.plugs.intAddAnyResourceToParse(\n        'ppt\\\\charts\\\\_rels\\\\chart' + GLOBAL_CHART_COUNT + '.xml.rels',\n        'buffer',\n        [\n          {\n            type:\n              'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package',\n            target:\n              '../embeddings/Microsoft_Excel_Worksheet' +\n              GLOBAL_CHART_COUNT +\n              '.xlsx'\n          }\n        ],\n        gen_private.plugs.type.msoffice.cbMakeRels,\n        true\n      )\n      gen_private.type.msoffice.files_list.push(\n        {\n          name: '/ppt/charts/chart' + GLOBAL_CHART_COUNT + '.xml',\n          type:\n            'application/vnd.openxmlformats-officedocument.drawingml.chart+xml',\n          clear: 'type'\n        },\n        {\n          name:\n            '/ppt/embeddings/Microsoft_Excel_Worksheet' +\n            GLOBAL_CHART_COUNT +\n            '.xlsx',\n          type:\n            'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n          ext: 'xlsx',\n          clear: 'type'\n        }\n      )\n\n      gen_private.pages[pageNumber].rels.push({\n        type:\n          'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart',\n        target: '../charts/chart' + GLOBAL_CHART_COUNT + '.xml',\n        clear: 'data'\n      })\n\n      workbook.save(function(err) {\n        if (err) {\n          workbook.cancel()\n        } else {\n          callback()\n        }\n      })\n    }\n\n    /**\n     * ???.\n     *\n     * @param {object} text ???.\n     * @param {object} opt ???.\n     * @param {object} y_pos ???.\n     * @param {object} x_size ???.\n     * @param {object} y_size ???.\n     * @param {object} opt_b ???.\n     */\n    slideObj.addText = function(text, opt, y_pos, x_size, y_size, opt_b) {\n      var objNumber = gen_private.pages[pageNumber].data.length\n\n      gen_private.pages[pageNumber].data[objNumber] = {}\n      gen_private.pages[pageNumber].data[objNumber].type = 'text'\n      gen_private.pages[pageNumber].data[objNumber].text = text || ''\n      gen_private.pages[pageNumber].data[objNumber].options =\n        typeof opt === 'object' ? opt : {}\n\n      if (typeof opt === 'string') {\n        gen_private.pages[pageNumber].data[objNumber].options.color = opt\n      } else if (typeof opt !== 'object' && typeof y_pos !== 'undefined') {\n        gen_private.pages[pageNumber].data[objNumber].options.x = opt\n        gen_private.pages[pageNumber].data[objNumber].options.y = y_pos\n\n        if (typeof x_size !== 'undefined' && typeof y_size !== 'undefined') {\n          gen_private.pages[pageNumber].data[objNumber].options.cx = x_size\n          gen_private.pages[pageNumber].data[objNumber].options.cy = y_size\n        } // Endif.\n      } // Endif.\n\n      var attrname\n\n      if (typeof opt_b === 'object') {\n        for (attrname in opt_b) {\n          gen_private.pages[pageNumber].data[objNumber].options[attrname] =\n            opt_b[attrname]\n        }\n      } else if (typeof x_size === 'object' && typeof y_size === 'undefined') {\n        for (attrname in x_size) {\n          gen_private.pages[pageNumber].data[objNumber].options[attrname] =\n            x_size[attrname]\n        }\n      } // Endif.\n\n      addParagraphApiForBasicOpt(gen_private.pages[pageNumber].data[objNumber])\n      addParagraphApiForEffects(gen_private.pages[pageNumber].data[objNumber])\n      return gen_private.pages[pageNumber].data[objNumber].api\n    }\n\n    /**\n     * ???\n     *\n     * @param {string} shape ???.\n     * @param {object} opt ???.\n     * @param {number} y_pos ???.\n     * @param {number} x_size ???.\n     * @param {number} y_size ???.\n     * @param {object} opt_b ???.\n     */\n    slideObj.addShape = function(shape, opt, y_pos, x_size, y_size, opt_b) {\n      var objNumber = gen_private.pages[pageNumber].data.length\n\n      gen_private.pages[pageNumber].data[objNumber] = {}\n      gen_private.pages[pageNumber].data[objNumber].type = 'text'\n      gen_private.pages[pageNumber].data[objNumber].options =\n        typeof opt === 'object' ? opt : {}\n      gen_private.pages[pageNumber].data[objNumber].options.shape = shape\n\n      if (typeof opt === 'string') {\n        gen_private.pages[pageNumber].data[objNumber].options.color = opt\n      } else if (typeof opt !== 'object' && typeof y_pos !== 'undefined') {\n        gen_private.pages[pageNumber].data[objNumber].options.x = opt\n        gen_private.pages[pageNumber].data[objNumber].options.y = y_pos\n\n        if (typeof x_size !== 'undefined' && typeof y_size !== 'undefined') {\n          gen_private.pages[pageNumber].data[objNumber].options.cx = x_size\n          gen_private.pages[pageNumber].data[objNumber].options.cy = y_size\n        } // Endif.\n      } // Endif.\n\n      var attrname\n\n      if (typeof opt_b === 'object') {\n        for (attrname in opt_b) {\n          gen_private.pages[pageNumber].data[objNumber].options[attrname] =\n            opt_b[attrname]\n        }\n      } else if (typeof x_size === 'object' && typeof y_size === 'undefined') {\n        for (attrname in x_size) {\n          gen_private.pages[pageNumber].data[objNumber].options[attrname] =\n            x_size[attrname]\n        }\n      } // Endif.\n\n      addParagraphApiForBasicOpt(gen_private.pages[pageNumber].data[objNumber])\n      addParagraphApiForEffects(gen_private.pages[pageNumber].data[objNumber])\n      return gen_private.pages[pageNumber].data[objNumber].api\n    }\n\n    /**\n     * ???.\n     *\n     * @param {object} image_path ???.\n     * @param {object} opt ???.\n     * @param {object} y_pos ???.\n     * @param {object} x_size ???.\n     * @param {object} y_size ???.\n     * @param {object} image_format_type ???.\n     */\n    slideObj.addImage = function(\n      image_path,\n      opt,\n      y_pos,\n      x_size,\n      y_size,\n      image_format_type\n    ) {\n      var objNumber = gen_private.pages[pageNumber].data.length\n      var image_type =\n        typeof image_format_type === 'string' ? image_format_type : 'png'\n      var defWidth\n      var defHeight = 0\n\n      if (typeof image_path === 'string') {\n        var ret_data = fast_image_size(image_path)\n        if (ret_data.type === 'unknown') {\n          var image_ext = path.extname(image_path)\n\n          switch (image_ext) {\n            case '.bmp':\n              image_type = 'bmp'\n              break\n\n            case '.gif':\n              image_type = 'gif'\n              break\n\n            case '.jpg':\n            case '.jpeg':\n              image_type = 'jpeg'\n              break\n\n            case '.emf':\n              image_type = 'emf'\n              break\n\n            case '.tiff':\n              image_type = 'tiff'\n              break\n          } // End of switch.\n        } else {\n          if (ret_data.width) {\n            defWidth = ret_data.width\n          } // Endif.\n\n          if (ret_data.height) {\n            defHeight = ret_data.height\n          } // Endif.\n\n          image_type = ret_data.type\n          if (image_type === 'jpg') {\n            image_type = 'jpeg'\n          } // Endif.\n        } // Endif.\n      } // Endif.\n\n      gen_private.pages[pageNumber].data[objNumber] = {}\n      gen_private.pages[pageNumber].data[objNumber].type = 'image'\n      gen_private.pages[pageNumber].data[objNumber].image = image_path\n      gen_private.pages[pageNumber].data[objNumber].options =\n        typeof opt === 'object' ? opt : {}\n\n      if (\n        !gen_private.pages[pageNumber].data[objNumber].options.cx &&\n        defWidth\n      ) {\n        gen_private.pages[pageNumber].data[objNumber].options.cx = defWidth\n      } // Endif.\n\n      if (\n        !gen_private.pages[pageNumber].data[objNumber].options.cy &&\n        defHeight\n      ) {\n        gen_private.pages[pageNumber].data[objNumber].options.cy = defHeight\n      } // Endif.\n\n      var image_id = gen_private.type.msoffice.src_files_list.indexOf(\n        image_path\n      )\n      var image_rel_id = -1\n\n      if (image_id >= 0) {\n        for (\n          var j = 0, total_size_j = gen_private.pages[pageNumber].rels.length;\n          j < total_size_j;\n          j++\n        ) {\n          if (\n            gen_private.pages[pageNumber].rels[j].target ===\n            '../media/image' + (image_id + 1) + '.' + image_type\n          ) {\n            image_rel_id = j + 1\n          } // Endif.\n        } // Endif.\n      } else {\n        image_id = gen_private.type.msoffice.src_files_list.length\n        gen_private.type.msoffice.src_files_list[image_id] = image_path\n        gen_private.plugs.intAddAnyResourceToParse(\n          'ppt\\\\media\\\\image' + (image_id + 1) + '.' + image_type,\n          typeof image_path === 'string' ? 'file' : 'stream',\n          image_path,\n          null,\n          false\n        )\n      } // Endif.\n\n      if (image_rel_id === -1) {\n        image_rel_id = gen_private.pages[pageNumber].rels.length + 1\n\n        gen_private.pages[pageNumber].rels.push({\n          type:\n            'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image',\n          target: '../media/image' + (image_id + 1) + '.' + image_type,\n          clear: 'data'\n        })\n      } // Endif.\n\n      // -- psv 2015-01-21 Manually copied change below from https://github.com/Ziv-Barber/officegen/pull/39/files?w=1\n      if ((opt || {}).link) {\n        var link_rel_id = gen_private.pages[pageNumber].rels.length + 1\n\n        gen_private.pages[pageNumber].rels.push({\n          type:\n            'http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink',\n          target: opt.link,\n          targetMode: 'External'\n        })\n\n        gen_private.pages[pageNumber].data[objNumber].link_rel_id = link_rel_id\n      } // Endif.\n      // -- psv 2015-01-21 end edits\n\n      gen_private.pages[pageNumber].data[objNumber].image_id = image_id\n      gen_private.pages[pageNumber].data[objNumber].rel_id = image_rel_id\n\n      if (typeof opt === 'string') {\n        gen_private.pages[pageNumber].data[objNumber].options.color = opt\n      } else if (typeof opt !== 'object' && typeof y_pos !== 'undefined') {\n        gen_private.pages[pageNumber].data[objNumber].options.x = opt\n        gen_private.pages[pageNumber].data[objNumber].options.y = y_pos\n\n        if (typeof x_size !== 'undefined' && typeof y_size !== 'undefined') {\n          gen_private.pages[pageNumber].data[objNumber].options.cx = x_size\n          gen_private.pages[pageNumber].data[objNumber].options.cy = y_size\n        } // Endif.\n      } // Endif.\n\n      addParagraphApiForBasicOpt(gen_private.pages[pageNumber].data[objNumber])\n      addParagraphApiForEffects(gen_private.pages[pageNumber].data[objNumber])\n      return gen_private.pages[pageNumber].data[objNumber].api\n    }\n\n    /**\n     * ???.\n     *\n     * @param {object} text ???.\n     * @param {object} opt ???.\n     * @param {object} y_pos ???.\n     * @param {object} x_size ???.\n     * @param {object} y_size ???.\n     * @param {object} opt_b ???.\n     */\n    slideObj.addP = function(text, opt, y_pos, x_size, y_size, opt_b) {\n      var objNumber = gen_private.pages[pageNumber].data.length\n\n      gen_private.pages[pageNumber].data[objNumber] = {}\n      gen_private.pages[pageNumber].data[objNumber].type = 'p'\n      gen_private.pages[pageNumber].data[objNumber].data = []\n      gen_private.pages[pageNumber].data[objNumber].options =\n        typeof opt === 'object' ? opt : {}\n\n      if (typeof opt === 'string') {\n        gen_private.pages[pageNumber].data[objNumber].options.color = opt\n      } else if (typeof opt !== 'object' && typeof y_pos !== 'undefined') {\n        gen_private.pages[pageNumber].data[objNumber].options.x = opt\n        gen_private.pages[pageNumber].data[objNumber].options.y = y_pos\n\n        if (typeof x_size !== 'undefined' && typeof y_size !== 'undefined') {\n          gen_private.pages[pageNumber].data[objNumber].options.cx = x_size\n          gen_private.pages[pageNumber].data[objNumber].options.cy = y_size\n        } // Endif.\n      } // Endif.\n\n      var attrname\n\n      if (typeof opt_b === 'object') {\n        for (attrname in opt_b) {\n          gen_private.pages[pageNumber].data[objNumber].options[attrname] =\n            opt_b[attrname]\n        }\n      } else if (typeof x_size === 'object' && typeof y_size === 'undefined') {\n        for (attrname in x_size) {\n          gen_private.pages[pageNumber].data[objNumber].options[attrname] =\n            x_size[attrname]\n        }\n      } // Endif.\n\n      // BMK_TODO:\n\n      return gen_private.pages[pageNumber].data[objNumber].data\n    }\n\n    slideObj.addDateToHeader = function() {\n      if (!gen_private.pages[pageNumber].header) {\n        gen_private.pages[pageNumber].header = {}\n      } // Endif.\n\n      // gen_private.pages[pageNumber]\n      // <a:fld id=\"{5C7A2A3D-B97F-4EB0-B937-FE8C3AFCAC1A}\" type=\"datetime1\">\n      // BMK_TODO:\n    }\n\n    gen_private.plugs.intAddAnyResourceToParse(\n      'ppt\\\\slides\\\\slide' + (pageNumber + 1) + '.xml',\n      'buffer',\n      gen_private.pages[pageNumber],\n      cbMakePptxSlide,\n      false\n    )\n    gen_private.plugs.intAddAnyResourceToParse(\n      'ppt\\\\slides\\\\_rels\\\\slide' + (pageNumber + 1) + '.xml.rels',\n      'buffer',\n      gen_private.pages[pageNumber].rels,\n      gen_private.plugs.type.msoffice.cbMakeRels,\n      false\n    )\n\n    // Signal to the plugins about a new slide:\n    gen_private.features.type.pptx.emitEvent('newPage', {\n      genobj: genobj,\n      page: slideObj,\n      pageData: gen_private.pages[pageNumber],\n      pageNumber: pageNumber,\n      slideOptions: slideOptions\n    })\n    return slideObj\n  }\n\n  // Tell all the features (plugins) to add extra API:\n  gen_private.features.type.pptx.emitEvent('makeDocApi', genobj)\n\n  return this\n}\n\nbaseobj.plugins.registerDocType(\n  'pptx',\n  makePptx,\n  {},\n  baseobj.docType.PRESENTATION,\n  'Microsoft PowerPoint Document'\n)\nbaseobj.plugins.registerDocType(\n  'ppsx',\n  makePptx,\n  {},\n  baseobj.docType.PRESENTATION,\n  'Microsoft PowerPoint Slideshow Document'\n)\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}